!function(){"use strict";var e={5593:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.CubismDefaultParameterId=void 0,t.CubismDefaultParameterId=Object.freeze({HitAreaPrefix:"HitArea",HitAreaHead:"Head",HitAreaBody:"Body",PartsIdCore:"Parts01Core",PartsArmPrefix:"Parts01Arm_",PartsArmLPrefix:"Parts01ArmL_",PartsArmRPrefix:"Parts01ArmR_",ParamAngleX:"ParamAngleX",ParamAngleY:"ParamAngleY",ParamAngleZ:"ParamAngleZ",ParamEyeLOpen:"ParamEyeLOpen",ParamEyeLSmile:"ParamEyeLSmile",ParamEyeROpen:"ParamEyeROpen",ParamEyeRSmile:"ParamEyeRSmile",ParamEyeBallX:"ParamEyeBallX",ParamEyeBallY:"ParamEyeBallY",ParamEyeBallForm:"ParamEyeBallForm",ParamBrowLY:"ParamBrowLY",ParamBrowRY:"ParamBrowRY",ParamBrowLX:"ParamBrowLX",ParamBrowRX:"ParamBrowRX",ParamBrowLAngle:"ParamBrowLAngle",ParamBrowRAngle:"ParamBrowRAngle",ParamBrowLForm:"ParamBrowLForm",ParamBrowRForm:"ParamBrowRForm",ParamMouthForm:"ParamMouthForm",ParamMouthOpenY:"ParamMouthOpenY",ParamCheek:"ParamCheek",ParamBodyAngleX:"ParamBodyAngleX",ParamBodyAngleY:"ParamBodyAngleY",ParamBodyAngleZ:"ParamBodyAngleZ",ParamBreath:"ParamBreath",ParamArmLA:"ParamArmLA",ParamArmRA:"ParamArmRA",ParamArmLB:"ParamArmLB",ParamArmRB:"ParamArmRB",ParamHandL:"ParamHandL",ParamHandR:"ParamHandR",ParamHairFront:"ParamHairFront",ParamHairSide:"ParamHairSide",ParamHairBack:"ParamHairBack",ParamHairFluffy:"ParamHairFluffy",ParamShoulderY:"ParamShoulderY",ParamBustX:"ParamBustX",ParamBustY:"ParamBustY",ParamBaseX:"ParamBaseX",ParamBaseY:"ParamBaseY",ParamNONE:"NONE:"});const n=a(i(5593));var o;(o=t.Live2DCubismFramework||(t.Live2DCubismFramework={})).HitAreaBody=n.CubismDefaultParameterId.HitAreaBody,o.HitAreaHead=n.CubismDefaultParameterId.HitAreaHead,o.HitAreaPrefix=n.CubismDefaultParameterId.HitAreaPrefix,o.ParamAngleX=n.CubismDefaultParameterId.ParamAngleX,o.ParamAngleY=n.CubismDefaultParameterId.ParamAngleY,o.ParamAngleZ=n.CubismDefaultParameterId.ParamAngleZ,o.ParamArmLA=n.CubismDefaultParameterId.ParamArmLA,o.ParamArmLB=n.CubismDefaultParameterId.ParamArmLB,o.ParamArmRA=n.CubismDefaultParameterId.ParamArmRA,o.ParamArmRB=n.CubismDefaultParameterId.ParamArmRB,o.ParamBaseX=n.CubismDefaultParameterId.ParamBaseX,o.ParamBaseY=n.CubismDefaultParameterId.ParamBaseY,o.ParamBodyAngleX=n.CubismDefaultParameterId.ParamBodyAngleX,o.ParamBodyAngleY=n.CubismDefaultParameterId.ParamBodyAngleY,o.ParamBodyAngleZ=n.CubismDefaultParameterId.ParamBodyAngleZ,o.ParamBreath=n.CubismDefaultParameterId.ParamBreath,o.ParamBrowLAngle=n.CubismDefaultParameterId.ParamBrowLAngle,o.ParamBrowLForm=n.CubismDefaultParameterId.ParamBrowLForm,o.ParamBrowLX=n.CubismDefaultParameterId.ParamBrowLX,o.ParamBrowLY=n.CubismDefaultParameterId.ParamBrowLY,o.ParamBrowRAngle=n.CubismDefaultParameterId.ParamBrowRAngle,o.ParamBrowRForm=n.CubismDefaultParameterId.ParamBrowRForm,o.ParamBrowRX=n.CubismDefaultParameterId.ParamBrowRX,o.ParamBrowRY=n.CubismDefaultParameterId.ParamBrowRY,o.ParamBustX=n.CubismDefaultParameterId.ParamBustX,o.ParamBustY=n.CubismDefaultParameterId.ParamBustY,o.ParamCheek=n.CubismDefaultParameterId.ParamCheek,o.ParamEyeBallForm=n.CubismDefaultParameterId.ParamEyeBallForm,o.ParamEyeBallX=n.CubismDefaultParameterId.ParamEyeBallX,o.ParamEyeBallY=n.CubismDefaultParameterId.ParamEyeBallY,o.ParamEyeLOpen=n.CubismDefaultParameterId.ParamEyeLOpen,o.ParamEyeLSmile=n.CubismDefaultParameterId.ParamEyeLSmile,o.ParamEyeROpen=n.CubismDefaultParameterId.ParamEyeROpen,o.ParamEyeRSmile=n.CubismDefaultParameterId.ParamEyeRSmile,o.ParamHairBack=n.CubismDefaultParameterId.ParamHairBack,o.ParamHairFluffy=n.CubismDefaultParameterId.ParamHairFluffy,o.ParamHairFront=n.CubismDefaultParameterId.ParamHairFront,o.ParamHairSide=n.CubismDefaultParameterId.ParamHairSide,o.ParamHandL=n.CubismDefaultParameterId.ParamHandL,o.ParamHandR=n.CubismDefaultParameterId.ParamHandR,o.ParamMouthForm=n.CubismDefaultParameterId.ParamMouthForm,o.ParamMouthOpenY=n.CubismDefaultParameterId.ParamMouthOpenY,o.ParamNONE=n.CubismDefaultParameterId.ParamNONE,o.ParamShoulderY=n.CubismDefaultParameterId.ParamShoulderY,o.PartsArmLPrefix=n.CubismDefaultParameterId.PartsArmLPrefix,o.PartsArmPrefix=n.CubismDefaultParameterId.PartsArmPrefix,o.PartsArmRPrefix=n.CubismDefaultParameterId.PartsArmRPrefix,o.PartsIdCore=n.CubismDefaultParameterId.PartsIdCore},7425:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CSM_LOG_LEVEL=t.CSM_LOG_LEVEL_OFF=t.CSM_LOG_LEVEL_ERROR=t.CSM_LOG_LEVEL_WARNING=t.CSM_LOG_LEVEL_INFO=t.CSM_LOG_LEVEL_DEBUG=t.CSM_LOG_LEVEL_VERBOSE=void 0,t.CSM_LOG_LEVEL_VERBOSE=0,t.CSM_LOG_LEVEL_DEBUG=1,t.CSM_LOG_LEVEL_INFO=2,t.CSM_LOG_LEVEL_WARNING=3,t.CSM_LOG_LEVEL_ERROR=4,t.CSM_LOG_LEVEL_OFF=5,t.CSM_LOG_LEVEL=t.CSM_LOG_LEVEL_VERBOSE},7938:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.CubismModelSettingJson=void 0;const n=i(8910),o=i(8871),u=i(6486),l=i(4462),h="FileReferences",d="UserData",c="Name",g="File",m="Ids",_="Sound",p="FadeInTime",f="FadeOutTime",y="LipSync",b="EyeBlink";var S;!function(e){e[e.FrequestNode_Groups=0]="FrequestNode_Groups",e[e.FrequestNode_Moc=1]="FrequestNode_Moc",e[e.FrequestNode_Motions=2]="FrequestNode_Motions",e[e.FrequestNode_Expressions=3]="FrequestNode_Expressions",e[e.FrequestNode_Textures=4]="FrequestNode_Textures",e[e.FrequestNode_Physics=5]="FrequestNode_Physics",e[e.FrequestNode_Pose=6]="FrequestNode_Pose",e[e.FrequestNode_HitAreas=7]="FrequestNode_HitAreas"}(S||(S={}));class C extends n.ICubismModelSetting{constructor(e,t){super(),this._json=l.CubismJson.create(e,t),this._json&&(this._jsonValue=new u.csmVector,this._jsonValue.pushBack(this._json.getRoot().getValueByString("Groups")),this._jsonValue.pushBack(this._json.getRoot().getValueByString(h).getValueByString("Moc")),this._jsonValue.pushBack(this._json.getRoot().getValueByString(h).getValueByString("Motions")),this._jsonValue.pushBack(this._json.getRoot().getValueByString(h).getValueByString("Expressions")),this._jsonValue.pushBack(this._json.getRoot().getValueByString(h).getValueByString("Textures")),this._jsonValue.pushBack(this._json.getRoot().getValueByString(h).getValueByString("Physics")),this._jsonValue.pushBack(this._json.getRoot().getValueByString(h).getValueByString("Pose")),this._jsonValue.pushBack(this._json.getRoot().getValueByString("HitAreas")))}release(){l.CubismJson.delete(this._json),this._jsonValue=null}GetJson(){return this._json}getModelFileName(){return this.isExistModelFile()?this._jsonValue.at(S.FrequestNode_Moc).getRawString():""}getTextureCount(){return this.isExistTextureFiles()?this._jsonValue.at(S.FrequestNode_Textures).getSize():0}getTextureDirectory(){return this._jsonValue.at(S.FrequestNode_Textures).getRawString()}getTextureFileName(e){return this._jsonValue.at(S.FrequestNode_Textures).getValueByIndex(e).getRawString()}getHitAreasCount(){return this.isExistHitAreas()?this._jsonValue.at(S.FrequestNode_HitAreas).getSize():0}getHitAreaId(e){return o.CubismFramework.getIdManager().getId(this._jsonValue.at(S.FrequestNode_HitAreas).getValueByIndex(e).getValueByString("Id").getRawString())}getHitAreaName(e){return this._jsonValue.at(S.FrequestNode_HitAreas).getValueByIndex(e).getValueByString(c).getRawString()}getPhysicsFileName(){return this.isExistPhysicsFile()?this._jsonValue.at(S.FrequestNode_Physics).getRawString():""}getPoseFileName(){return this.isExistPoseFile()?this._jsonValue.at(S.FrequestNode_Pose).getRawString():""}getExpressionCount(){return this.isExistExpressionFile()?this._jsonValue.at(S.FrequestNode_Expressions).getSize():0}getExpressionName(e){return this._jsonValue.at(S.FrequestNode_Expressions).getValueByIndex(e).getValueByString(c).getRawString()}getExpressionFileName(e){return this._jsonValue.at(S.FrequestNode_Expressions).getValueByIndex(e).getValueByString(g).getRawString()}getMotionGroupCount(){return this.isExistMotionGroups()?this._jsonValue.at(S.FrequestNode_Motions).getKeys().getSize():0}getMotionGroupName(e){return this.isExistMotionGroups()?this._jsonValue.at(S.FrequestNode_Motions).getKeys().at(e):null}getMotionCount(e){return this.isExistMotionGroupName(e)?this._jsonValue.at(S.FrequestNode_Motions).getValueByString(e).getSize():0}getMotionFileName(e,t){return this.isExistMotionGroupName(e)?this._jsonValue.at(S.FrequestNode_Motions).getValueByString(e).getValueByIndex(t).getValueByString(g).getRawString():""}getMotionSoundFileName(e,t){return this.isExistMotionSoundFile(e,t)?this._jsonValue.at(S.FrequestNode_Motions).getValueByString(e).getValueByIndex(t).getValueByString(_).getRawString():""}getMotionFadeInTimeValue(e,t){return this.isExistMotionFadeIn(e,t)?this._jsonValue.at(S.FrequestNode_Motions).getValueByString(e).getValueByIndex(t).getValueByString(p).toFloat():-1}getMotionFadeOutTimeValue(e,t){return this.isExistMotionFadeOut(e,t)?this._jsonValue.at(S.FrequestNode_Motions).getValueByString(e).getValueByIndex(t).getValueByString(f).toFloat():-1}getUserDataFile(){return this.isExistUserDataFile()?this._json.getRoot().getValueByString(h).getValueByString(d).getRawString():""}getLayoutMap(e){const t=this._json.getRoot().getValueByString("Layout").getMap();if(null==t)return!1;let i=!1;for(const r=t.begin();r.notEqual(t.end());r.preIncrement())e.setValue(r.ptr().first,r.ptr().second.toFloat()),i=!0;return i}getEyeBlinkParameterCount(){if(!this.isExistEyeBlinkParameters())return 0;let e=0;for(let t=0;t<this._jsonValue.at(S.FrequestNode_Groups).getSize();t++){const i=this._jsonValue.at(S.FrequestNode_Groups).getValueByIndex(t);if(!i.isNull()&&!i.isError()&&i.getValueByString(c).getRawString()==b){e=i.getValueByString(m).getVector().getSize();break}}return e}getEyeBlinkParameterId(e){if(!this.isExistEyeBlinkParameters())return null;for(let t=0;t<this._jsonValue.at(S.FrequestNode_Groups).getSize();t++){const i=this._jsonValue.at(S.FrequestNode_Groups).getValueByIndex(t);if(!i.isNull()&&!i.isError()&&i.getValueByString(c).getRawString()==b)return o.CubismFramework.getIdManager().getId(i.getValueByString(m).getValueByIndex(e).getRawString())}return null}getLipSyncParameterCount(){if(!this.isExistLipSyncParameters())return 0;let e=0;for(let t=0;t<this._jsonValue.at(S.FrequestNode_Groups).getSize();t++){const i=this._jsonValue.at(S.FrequestNode_Groups).getValueByIndex(t);if(!i.isNull()&&!i.isError()&&i.getValueByString(c).getRawString()==y){e=i.getValueByString(m).getVector().getSize();break}}return e}getLipSyncParameterId(e){if(!this.isExistLipSyncParameters())return null;for(let t=0;t<this._jsonValue.at(S.FrequestNode_Groups).getSize();t++){const i=this._jsonValue.at(S.FrequestNode_Groups).getValueByIndex(t);if(!i.isNull()&&!i.isError()&&i.getValueByString(c).getRawString()==y)return o.CubismFramework.getIdManager().getId(i.getValueByString(m).getValueByIndex(e).getRawString())}return null}isExistModelFile(){const e=this._jsonValue.at(S.FrequestNode_Moc);return!e.isNull()&&!e.isError()}isExistTextureFiles(){const e=this._jsonValue.at(S.FrequestNode_Textures);return!e.isNull()&&!e.isError()}isExistHitAreas(){const e=this._jsonValue.at(S.FrequestNode_HitAreas);return!e.isNull()&&!e.isError()}isExistPhysicsFile(){const e=this._jsonValue.at(S.FrequestNode_Physics);return!e.isNull()&&!e.isError()}isExistPoseFile(){const e=this._jsonValue.at(S.FrequestNode_Pose);return!e.isNull()&&!e.isError()}isExistExpressionFile(){const e=this._jsonValue.at(S.FrequestNode_Expressions);return!e.isNull()&&!e.isError()}isExistMotionGroups(){const e=this._jsonValue.at(S.FrequestNode_Motions);return!e.isNull()&&!e.isError()}isExistMotionGroupName(e){const t=this._jsonValue.at(S.FrequestNode_Motions).getValueByString(e);return!t.isNull()&&!t.isError()}isExistMotionSoundFile(e,t){const i=this._jsonValue.at(S.FrequestNode_Motions).getValueByString(e).getValueByIndex(t).getValueByString(_);return!i.isNull()&&!i.isError()}isExistMotionFadeIn(e,t){const i=this._jsonValue.at(S.FrequestNode_Motions).getValueByString(e).getValueByIndex(t).getValueByString(p);return!i.isNull()&&!i.isError()}isExistMotionFadeOut(e,t){const i=this._jsonValue.at(S.FrequestNode_Motions).getValueByString(e).getValueByIndex(t).getValueByString(f);return!i.isNull()&&!i.isError()}isExistUserDataFile(){const e=this._json.getRoot().getValueByString(h).getValueByString(d);return!e.isNull()&&!e.isError()}isExistEyeBlinkParameters(){if(this._jsonValue.at(S.FrequestNode_Groups).isNull()||this._jsonValue.at(S.FrequestNode_Groups).isError())return!1;for(let e=0;e<this._jsonValue.at(S.FrequestNode_Groups).getSize();++e)if(this._jsonValue.at(S.FrequestNode_Groups).getValueByIndex(e).getValueByString(c).getRawString()==b)return!0;return!1}isExistLipSyncParameters(){if(this._jsonValue.at(S.FrequestNode_Groups).isNull()||this._jsonValue.at(S.FrequestNode_Groups).isError())return!1;for(let e=0;e<this._jsonValue.at(S.FrequestNode_Groups).getSize();++e)if(this._jsonValue.at(S.FrequestNode_Groups).getValueByIndex(e).getValueByString(c).getRawString()==y)return!0;return!1}}t.CubismModelSettingJson=C;const v=a(i(7938));(t.Live2DCubismFramework||(t.Live2DCubismFramework={})).CubismModelSettingJson=v.CubismModelSettingJson},4218:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.BreathParameterData=t.CubismBreath=void 0;class n{constructor(){this._currentTime=0}static create(){return new n}static delete(e){null!=e&&(e=null)}setParameters(e){this._breathParameters=e}getParameters(){return this._breathParameters}updateParameters(e,t){this._currentTime+=t;const i=2*this._currentTime*3.14159;for(let t=0;t<this._breathParameters.getSize();++t){const r=this._breathParameters.at(t);e.addParameterValueById(r.parameterId,r.offset+r.peak*Math.sin(i/r.cycle),r.weight)}}}t.CubismBreath=n,t.BreathParameterData=class{constructor(e,t,i,r,s){this.parameterId=null==e?null:e,this.offset=null==t?0:t,this.peak=null==i?0:i,this.cycle=null==r?0:r,this.weight=null==s?0:s}};const o=a(i(4218));var u;(u=t.Live2DCubismFramework||(t.Live2DCubismFramework={})).BreathParameterData=o.BreathParameterData,u.CubismBreath=o.CubismBreath},8349:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.EyeState=t.CubismEyeBlink=void 0;const n=i(6486);class o{constructor(e){if(this._blinkingState=u.EyeState_First,this._nextBlinkingTime=0,this._stateStartTimeSeconds=0,this._blinkingIntervalSeconds=4,this._closingSeconds=.1,this._closedSeconds=.05,this._openingSeconds=.15,this._userTimeSeconds=0,this._parameterIds=new n.csmVector,null!=e)for(let t=0;t<e.getEyeBlinkParameterCount();++t)this._parameterIds.pushBack(e.getEyeBlinkParameterId(t))}static create(e=null){return new o(e)}static delete(e){null!=e&&(e=null)}setBlinkingInterval(e){this._blinkingIntervalSeconds=e}setBlinkingSetting(e,t,i){this._closingSeconds=e,this._closedSeconds=t,this._openingSeconds=i}setParameterIds(e){this._parameterIds=e}getParameterIds(){return this._parameterIds}updateParameters(e,t){let i;this._userTimeSeconds+=t;let r=0;switch(this._blinkingState){case u.EyeState_Closing:r=(this._userTimeSeconds-this._stateStartTimeSeconds)/this._closingSeconds,r>=1&&(r=1,this._blinkingState=u.EyeState_Closed,this._stateStartTimeSeconds=this._userTimeSeconds),i=1-r;break;case u.EyeState_Closed:r=(this._userTimeSeconds-this._stateStartTimeSeconds)/this._closedSeconds,r>=1&&(this._blinkingState=u.EyeState_Opening,this._stateStartTimeSeconds=this._userTimeSeconds),i=0;break;case u.EyeState_Opening:r=(this._userTimeSeconds-this._stateStartTimeSeconds)/this._openingSeconds,r>=1&&(r=1,this._blinkingState=u.EyeState_Interval,this._nextBlinkingTime=this.determinNextBlinkingTiming()),i=r;break;case u.EyeState_Interval:this._nextBlinkingTime<this._userTimeSeconds&&(this._blinkingState=u.EyeState_Closing,this._stateStartTimeSeconds=this._userTimeSeconds),i=1;break;case u.EyeState_First:default:this._blinkingState=u.EyeState_Interval,this._nextBlinkingTime=this.determinNextBlinkingTiming(),i=1}o.CloseIfZero||(i=-i);for(let t=0;t<this._parameterIds.getSize();++t)e.setParameterValueById(this._parameterIds.at(t),i)}determinNextBlinkingTiming(){const e=Math.random();return this._userTimeSeconds+e*(2*this._blinkingIntervalSeconds-1)}}var u;t.CubismEyeBlink=o,o.CloseIfZero=!0,function(e){e[e.EyeState_First=0]="EyeState_First",e[e.EyeState_Interval=1]="EyeState_Interval",e[e.EyeState_Closing=2]="EyeState_Closing",e[e.EyeState_Closed=3]="EyeState_Closed",e[e.EyeState_Opening=4]="EyeState_Opening"}(u=t.EyeState||(t.EyeState={}));const l=a(i(8349));var h;(h=t.Live2DCubismFramework||(t.Live2DCubismFramework={})).CubismEyeBlink=l.CubismEyeBlink,h.EyeState=l.EyeState},459:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.PartData=t.CubismPose=void 0;const n=i(8871),o=i(6486),u=i(4462),l="FadeInTime",h="Link";class d{constructor(){this._fadeTimeSeconds=.5,this._lastModel=null,this._partGroups=new o.csmVector,this._partGroupCounts=new o.csmVector}static create(e,t){const i=new d,r=u.CubismJson.create(e,t),s=r.getRoot();s.getValueByString(l).isNull()||(i._fadeTimeSeconds=s.getValueByString(l).toFloat(.5),i._fadeTimeSeconds<=0&&(i._fadeTimeSeconds=.5));const a=s.getValueByString("Groups"),o=a.getSize();for(let e=0;e<o;++e){const t=a.getValueByIndex(e),r=t.getSize();let s=0;for(let e=0;e<r;++e){const r=t.getValueByIndex(e),a=new c,o=n.CubismFramework.getIdManager().getId(r.getValueByString("Id").getRawString());if(a.partId=o,!r.getValueByString(h).isNull()){const e=r.getValueByString(h),t=e.getSize();for(let i=0;i<t;++i){const t=new c,r=n.CubismFramework.getIdManager().getId(e.getValueByIndex(i).getString());t.partId=r,a.link.pushBack(t)}}i._partGroups.pushBack(a.clone()),++s}i._partGroupCounts.pushBack(s)}return u.CubismJson.delete(r),i}static delete(e){null!=e&&(e=null)}updateParameters(e,t){e!=this._lastModel&&this.reset(e),this._lastModel=e,t<0&&(t=0);let i=0;for(let r=0;r<this._partGroupCounts.getSize();r++){const s=this._partGroupCounts.at(r);this.doFade(e,t,i,s),i+=s}this.copyPartOpacities(e)}reset(e){let t=0;for(let i=0;i<this._partGroupCounts.getSize();++i){const r=this._partGroupCounts.at(i);for(let i=t;i<t+r;++i){this._partGroups.at(i).initialize(e);const r=this._partGroups.at(i).partIndex,s=this._partGroups.at(i).parameterIndex;if(!(r<0)){e.setPartOpacityByIndex(r,i==t?1:0),e.setParameterValueByIndex(s,i==t?1:0);for(let t=0;t<this._partGroups.at(i).link.getSize();++t)this._partGroups.at(i).link.at(t).initialize(e)}}t+=r}}copyPartOpacities(e){for(let t=0;t<this._partGroups.getSize();++t){const i=this._partGroups.at(t);if(0==i.link.getSize())continue;const r=this._partGroups.at(t).partIndex,s=e.getPartOpacityByIndex(r);for(let t=0;t<i.link.getSize();++t){const r=i.link.at(t).partIndex;r<0||e.setPartOpacityByIndex(r,s)}}}doFade(e,t,i,r){let s=-1,a=1;for(let n=i;n<i+r;++n){const i=this._partGroups.at(n).partIndex,r=this._partGroups.at(n).parameterIndex;if(e.getParameterValueByIndex(r)>.001){if(s>=0)break;s=n,a=e.getPartOpacityByIndex(i),a+=t/this._fadeTimeSeconds,a>1&&(a=1)}}s<0&&(s=0,a=1);for(let t=i;t<i+r;++t){const i=this._partGroups.at(t).partIndex;if(s==t)e.setPartOpacityByIndex(i,a);else{let t,r=e.getPartOpacityByIndex(i);t=a<.5?-.5*a/.5+1:.5*(1-a)/.5,(1-t)*(1-a)>.15&&(t=1-.15/(1-a)),r>t&&(r=t),e.setPartOpacityByIndex(i,r)}}}}t.CubismPose=d;class c{constructor(e){if(this.parameterIndex=0,this.partIndex=0,this.link=new o.csmVector,null!=e){this.partId=e.partId;for(const t=e.link.begin();t.notEqual(e.link.end());t.preIncrement())this.link.pushBack(t.ptr().clone())}}assignment(e){this.partId=e.partId;for(const t=e.link.begin();t.notEqual(e.link.end());t.preIncrement())this.link.pushBack(t.ptr().clone());return this}initialize(e){this.parameterIndex=e.getParameterIndex(this.partId),this.partIndex=e.getPartIndex(this.partId),e.setParameterValueByIndex(this.parameterIndex,1)}clone(){const e=new c;e.partId=this.partId,e.parameterIndex=this.parameterIndex,e.partIndex=this.partIndex,e.link=new o.csmVector;for(let t=this.link.begin();t.notEqual(this.link.end());t.increment())e.link.pushBack(t.ptr().clone());return e}}t.PartData=c;const g=a(i(459));var m;(m=t.Live2DCubismFramework||(t.Live2DCubismFramework={})).CubismPose=g.CubismPose,m.PartData=g.PartData},8910:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.ICubismModelSetting=void 0,t.ICubismModelSetting=class{};const n=a(i(8910));(t.Live2DCubismFramework||(t.Live2DCubismFramework={})).ICubismModelSetting=n.ICubismModelSetting},9076:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.CubismId=void 0;const n=i(4020);class o{constructor(e){this._id="string"!=typeof e?e:new n.csmString(e)}getString(){return this._id}isEqual(e){return"string"==typeof e?this._id.isEqual(e):e instanceof n.csmString?this._id.isEqual(e.s):e instanceof o&&this._id.isEqual(e._id.s)}isNotEqual(e){return"string"==typeof e?!this._id.isEqual(e):e instanceof n.csmString?!this._id.isEqual(e.s):e instanceof o&&!this._id.isEqual(e._id.s)}}t.CubismId=o;const u=a(i(9076));(t.Live2DCubismFramework||(t.Live2DCubismFramework={})).CubismId=u.CubismId},641:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.CubismIdManager=void 0;const n=i(6486),o=i(9076);t.CubismIdManager=class{constructor(){this._ids=new n.csmVector}release(){for(let e=0;e<this._ids.getSize();++e)this._ids.set(e,void 0);this._ids=null}registerIds(e){for(let t=0;t<e.length;t++)this.registerId(e[t])}registerId(e){let t=null;return"string"!=typeof e?this.registerId(e.s):(null!=(t=this.findId(e))||(t=new o.CubismId(e),this._ids.pushBack(t)),t)}getId(e){return this.registerId(e)}isExist(e){return"string"==typeof e?null!=this.findId(e):this.isExist(e.s)}findId(e){for(let t=0;t<this._ids.getSize();++t)if(this._ids.at(t).getString().isEqual(e))return this._ids.at(t);return null}};const u=a(i(641));(t.Live2DCubismFramework||(t.Live2DCubismFramework={})).CubismIdManager=u.CubismIdManager},8871:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.LogLevel=t.Option=t.CubismFramework=t.csmDelete=t.Constant=t.strtod=void 0;const n=i(641),o=i(3006),u=i(1201),l=i(4462);t.strtod=function(e,t){let i=0;for(let t=1;;t++){const r=e.slice(t-1,t);if("e"==r||"-"==r||"E"==r)continue;const s=e.substring(0,t),a=Number(s);if(isNaN(a))break;i=t}let r=parseFloat(e);return isNaN(r)&&(r=NaN),t[0]=e.slice(i),r};let h=!1,d=!1,c=null,g=null;var m;t.Constant=Object.freeze({vertexOffset:0,vertexStep:2}),t.csmDelete=function(e){e&&(e=void 0)},t.CubismFramework=class{static startUp(e=null){if(h)return u.CubismLogInfo("CubismFramework.startUp() is already done."),h;if(c=e,null!=c&&Live2DCubismCore.Logging.csmSetLogFunction(c.logFunction),h=!0,h){const e=Live2DCubismCore.Version.csmGetVersion(),t=(4278190080&e)>>24,i=(16711680&e)>>16,r=65535&e,s=e;u.CubismLogInfo("Live2D Cubism Core version: {0}.{1}.{2} ({3})",("00"+t).slice(-2),("00"+i).slice(-2),("0000"+r).slice(-4),s)}return u.CubismLogInfo("CubismFramework.startUp() is complete."),h}static cleanUp(){h=!1,d=!1,c=null,g=null}static initialize(){u.CSM_ASSERT(h),h?d?u.CubismLogWarning("CubismFramework.initialize() skipped, already initialized."):(l.Value.staticInitializeNotForClientCall(),g=new n.CubismIdManager,d=!0,u.CubismLogInfo("CubismFramework.initialize() is complete.")):u.CubismLogWarning("CubismFramework is not started.")}static dispose(){u.CSM_ASSERT(h),h?d?(l.Value.staticReleaseNotForClientCall(),g.release(),g=null,o.CubismRenderer.staticRelease(),d=!1,u.CubismLogInfo("CubismFramework.dispose() is complete.")):u.CubismLogWarning("CubismFramework.dispose() skipped, not initialized."):u.CubismLogWarning("CubismFramework is not started.")}static isStarted(){return h}static isInitialized(){return d}static coreLogFunction(e){Live2DCubismCore.Logging.csmGetLogFunction()&&Live2DCubismCore.Logging.csmGetLogFunction()(e)}static getLoggingLevel(){return null!=c?c.loggingLevel:m.LogLevel_Off}static getIdManager(){return g}constructor(){}},t.Option=class{},function(e){e[e.LogLevel_Verbose=0]="LogLevel_Verbose",e[e.LogLevel_Debug=1]="LogLevel_Debug",e[e.LogLevel_Info=2]="LogLevel_Info",e[e.LogLevel_Warning=3]="LogLevel_Warning",e[e.LogLevel_Error=4]="LogLevel_Error",e[e.LogLevel_Off=5]="LogLevel_Off"}(m=t.LogLevel||(t.LogLevel={}));const _=a(i(8871));var p;(p=t.Live2DCubismFramework||(t.Live2DCubismFramework={})).Constant=_.Constant,p.csmDelete=_.csmDelete,p.CubismFramework=_.CubismFramework},9657:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.CubismMath=void 0;const n=i(9616);t.CubismMath=class{static range(e,t,i){return e<t?e=t:e>i&&(e=i),e}static sin(e){return Math.sin(e)}static cos(e){return Math.cos(e)}static abs(e){return Math.abs(e)}static sqrt(e){return Math.sqrt(e)}static getEasingSine(e){return e<0?0:e>1?1:.5-.5*this.cos(e*Math.PI)}static max(e,t){return e>t?e:t}static min(e,t){return e>t?t:e}static degreesToRadian(e){return e/180*Math.PI}static radianToDegrees(e){return 180*e/Math.PI}static directionToRadian(e,t){let i=Math.atan2(t.y,t.x)-Math.atan2(e.y,e.x);for(;i<-Math.PI;)i+=2*Math.PI;for(;i>Math.PI;)i-=2*Math.PI;return i}static directionToDegrees(e,t){const i=this.directionToRadian(e,t);let r=this.radianToDegrees(i);return t.x-e.x>0&&(r=-r),r}static radianToDirection(e){const t=new n.CubismVector2;return t.x=this.sin(e),t.y=this.cos(e),t}constructor(){}};const o=a(i(9657));(t.Live2DCubismFramework||(t.Live2DCubismFramework={})).CubismMath=o.CubismMath},8904:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.CubismMatrix44=void 0;class n{constructor(){this._tr=new Float32Array(16),this.loadIdentity()}static multiply(e,t,i){const r=new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);for(let i=0;i<4;++i)for(let s=0;s<4;++s)for(let a=0;a<4;++a)r[s+4*i]+=e[a+4*i]*t[s+4*a];for(let e=0;e<16;++e)i[e]=r[e]}loadIdentity(){const e=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);this.setMatrix(e)}setMatrix(e){for(let t=0;t<16;++t)this._tr[t]=e[t]}getArray(){return this._tr}getScaleX(){return this._tr[0]}getScaleY(){return this._tr[5]}getTranslateX(){return this._tr[12]}getTranslateY(){return this._tr[13]}transformX(e){return this._tr[0]*e+this._tr[12]}transformY(e){return this._tr[5]*e+this._tr[13]}invertTransformX(e){return(e-this._tr[12])/this._tr[0]}invertTransformY(e){return(e-this._tr[13])/this._tr[5]}translateRelative(e,t){const i=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,e,t,0,1]);n.multiply(i,this._tr,this._tr)}translate(e,t){this._tr[12]=e,this._tr[13]=t}translateX(e){this._tr[12]=e}translateY(e){this._tr[13]=e}scaleRelative(e,t){const i=new Float32Array([e,0,0,0,0,t,0,0,0,0,1,0,0,0,0,1]);n.multiply(i,this._tr,this._tr)}scale(e,t){this._tr[0]=e,this._tr[5]=t}multiplyByMatrix(e){n.multiply(e.getArray(),this._tr,this._tr)}clone(){const e=new n;for(let t=0;t<this._tr.length;t++)e._tr[t]=this._tr[t];return e}}t.CubismMatrix44=n;const o=a(i(8904));(t.Live2DCubismFramework||(t.Live2DCubismFramework={})).CubismMatrix44=o.CubismMatrix44},7144:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.CubismModelMatrix=void 0;const n=i(8904);class o extends n.CubismMatrix44{constructor(e,t){super(),this._width=void 0!==e?e:0,this._height=void 0!==t?t:0,this.setHeight(2)}setWidth(e){const t=e/this._width,i=t;this.scale(t,i)}setHeight(e){const t=e/this._height,i=t;this.scale(t,i)}setPosition(e,t){this.translate(e,t)}setCenterPosition(e,t){this.centerX(e),this.centerY(t)}top(e){this.setY(e)}bottom(e){const t=this._height*this.getScaleY();this.translateY(e-t)}left(e){this.setX(e)}right(e){const t=this._width*this.getScaleX();this.translateX(e-t)}centerX(e){const t=this._width*this.getScaleX();this.translateX(e-t/2)}setX(e){this.translateX(e)}centerY(e){const t=this._height*this.getScaleY();this.translateY(e-t/2)}setY(e){this.translateY(e)}setupFromLayout(e){for(const t=e.begin();t.notEqual(e.end());t.preIncrement()){const e=t.ptr().first,i=t.ptr().second;"width"==e?this.setWidth(i):"height"==e&&this.setHeight(i)}for(const t=e.begin();t.notEqual(e.end());t.preIncrement()){const e=t.ptr().first,i=t.ptr().second;"x"==e?this.setX(i):"y"==e?this.setY(i):"center_x"==e?this.centerX(i):"center_y"==e?this.centerY(i):"top"==e?this.top(i):"bottom"==e?this.bottom(i):"left"==e?this.left(i):"right"==e&&this.right(i)}}}t.CubismModelMatrix=o;const u=a(i(7144));(t.Live2DCubismFramework||(t.Live2DCubismFramework={})).CubismModelMatrix=u.CubismModelMatrix},4583:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.CubismTargetPoint=void 0;const n=i(9657);t.CubismTargetPoint=class{constructor(){this._faceTargetX=0,this._faceTargetY=0,this._faceX=0,this._faceY=0,this._faceVX=0,this._faceVY=0,this._lastTimeSeconds=0,this._userTimeSeconds=0}update(e){this._userTimeSeconds+=e;const t=4/30;if(0==this._lastTimeSeconds)return void(this._lastTimeSeconds=this._userTimeSeconds);const i=30*(this._userTimeSeconds-this._lastTimeSeconds);this._lastTimeSeconds=this._userTimeSeconds;const r=i*t/4.5,s=this._faceTargetX-this._faceX,a=this._faceTargetY-this._faceY;if(n.CubismMath.abs(s)<=.01&&n.CubismMath.abs(a)<=.01)return;const o=n.CubismMath.sqrt(s*s+a*a),u=t*a/o;let l=t*s/o-this._faceVX,h=u-this._faceVY;const d=n.CubismMath.sqrt(l*l+h*h);(d<-r||d>r)&&(l*=r/d,h*=r/d),this._faceVX+=l,this._faceVY+=h;{const e=.5*(n.CubismMath.sqrt(r*r+16*r*o-8*r*o)-r),t=n.CubismMath.sqrt(this._faceVX*this._faceVX+this._faceVY*this._faceVY);t>e&&(this._faceVX*=e/t,this._faceVY*=e/t)}this._faceX+=this._faceVX,this._faceY+=this._faceVY}getX(){return this._faceX}getY(){return this._faceY}set(e,t){this._faceTargetX=e,this._faceTargetY=t}};const o=a(i(4583));(t.Live2DCubismFramework||(t.Live2DCubismFramework={})).CubismTargetPoint=o.CubismTargetPoint},9616:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.CubismVector2=void 0;class n{constructor(e,t){this.x=e,this.y=t,this.x=null==e?0:e,this.y=null==t?0:t}add(e){const t=new n(0,0);return t.x=this.x+e.x,t.y=this.y+e.y,t}substract(e){const t=new n(0,0);return t.x=this.x-e.x,t.y=this.y-e.y,t}multiply(e){const t=new n(0,0);return t.x=this.x*e.x,t.y=this.y*e.y,t}multiplyByScaler(e){return this.multiply(new n(e,e))}division(e){const t=new n(0,0);return t.x=this.x/e.x,t.y=this.y/e.y,t}divisionByScalar(e){return this.division(new n(e,e))}getLength(){return Math.sqrt(this.x*this.x+this.y*this.y)}getDistanceWith(e){return Math.sqrt((this.x-e.x)*(this.x-e.x)+(this.y-e.y)*(this.y-e.y))}dot(e){return this.x*e.x+this.y*e.y}normalize(){const e=Math.pow(this.x*this.x+this.y*this.y,.5);this.x=this.x/e,this.y=this.y/e}isEqual(e){return this.x==e.x&&this.y==e.y}isNotEqual(e){return!this.isEqual(e)}}t.CubismVector2=n;const o=a(i(9616));(t.Live2DCubismFramework||(t.Live2DCubismFramework={})).CubismVector2=o.CubismVector2},1357:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.CubismViewMatrix=void 0;const n=i(8904);class o extends n.CubismMatrix44{constructor(){super(),this._screenLeft=0,this._screenRight=0,this._screenTop=0,this._screenBottom=0,this._maxLeft=0,this._maxRight=0,this._maxTop=0,this._maxBottom=0,this._maxScale=0,this._minScale=0}adjustTranslate(e,t){this._tr[0]*this._maxLeft+(this._tr[12]+e)>this._screenLeft&&(e=this._screenLeft-this._tr[0]*this._maxLeft-this._tr[12]),this._tr[0]*this._maxRight+(this._tr[12]+e)<this._screenRight&&(e=this._screenRight-this._tr[0]*this._maxRight-this._tr[12]),this._tr[5]*this._maxTop+(this._tr[13]+t)<this._screenTop&&(t=this._screenTop-this._tr[5]*this._maxTop-this._tr[13]),this._tr[5]*this._maxBottom+(this._tr[13]+t)>this._screenBottom&&(t=this._screenBottom-this._tr[5]*this._maxBottom-this._tr[13]);const i=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,e,t,0,1]);n.CubismMatrix44.multiply(i,this._tr,this._tr)}adjustScale(e,t,i){const r=this.getMaxScale(),s=this.getMinScale(),a=i*this._tr[0];a<s?this._tr[0]>0&&(i=s/this._tr[0]):a>r&&this._tr[0]>0&&(i=r/this._tr[0]);const o=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,e,t,0,1]),u=new Float32Array([i,0,0,0,0,i,0,0,0,0,1,0,0,0,0,1]),l=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,-e,-t,0,1]);n.CubismMatrix44.multiply(l,this._tr,this._tr),n.CubismMatrix44.multiply(u,this._tr,this._tr),n.CubismMatrix44.multiply(o,this._tr,this._tr)}setScreenRect(e,t,i,r){this._screenLeft=e,this._screenRight=t,this._screenBottom=i,this._screenTop=r}setMaxScreenRect(e,t,i,r){this._maxLeft=e,this._maxRight=t,this._maxTop=r,this._maxBottom=i}setMaxScale(e){this._maxScale=e}setMinScale(e){this._minScale=e}getMaxScale(){return this._maxScale}getMinScale(){return this._minScale}isMaxScale(){return this.getScaleX()>=this._maxScale}isMinScale(){return this.getScaleX()<=this._minScale}getScreenLeft(){return this._screenLeft}getScreenRight(){return this._screenRight}getScreenBottom(){return this._screenBottom}getScreenTop(){return this._screenTop}getMaxLeft(){return this._maxLeft}getMaxRight(){return this._maxRight}getMaxBottom(){return this._maxBottom}getMaxTop(){return this._maxTop}}t.CubismViewMatrix=o;const u=a(i(1357));(t.Live2DCubismFramework||(t.Live2DCubismFramework={})).CubismViewMatrix=u.CubismViewMatrix},1349:function(e,t){var i;Object.defineProperty(t,"__esModule",{value:!0}),t.ExShaderParam=t.ExUniforms=t.ExShaderLoadInfo=t.ShaderType=t.ExShaderInfo=void 0,t.ExShaderInfo=class{constructor(e,t){this.artMeshID=e,this.exShaderIndex=t,this.exUniform=new r}},function(e){e[e.ShaderType_SetupMask=0]="ShaderType_SetupMask",e[e.ShaderType_NormalPremultipliedAlpha=1]="ShaderType_NormalPremultipliedAlpha",e[e.ShaderType_NormalMaskedPremultipliedAlpha=2]="ShaderType_NormalMaskedPremultipliedAlpha",e[e.ShaderType_NomralMaskedInvertedPremultipliedAlpha=3]="ShaderType_NomralMaskedInvertedPremultipliedAlpha",e[e.ShaderType_AddPremultipliedAlpha=4]="ShaderType_AddPremultipliedAlpha",e[e.ShaderType_AddMaskedPremultipliedAlpha=5]="ShaderType_AddMaskedPremultipliedAlpha",e[e.ShaderType_AddMaskedPremultipliedAlphaInverted=6]="ShaderType_AddMaskedPremultipliedAlphaInverted",e[e.ShaderType_MultPremultipliedAlpha=7]="ShaderType_MultPremultipliedAlpha",e[e.ShaderType_MultMaskedPremultipliedAlpha=8]="ShaderType_MultMaskedPremultipliedAlpha",e[e.ShaderType_MultMaskedPremultipliedAlphaInverted=9]="ShaderType_MultMaskedPremultipliedAlphaInverted"}(i=t.ShaderType||(t.ShaderType={})),t.ExShaderLoadInfo=class{constructor(e,t){this.exShaderSrc=e,this.shaderType=t||i.ShaderType_NormalPremultipliedAlpha}};class r{constructor(){this.time=0,this.resolution_x=0,this.resolution_y=0,this.mousePos_x=0,this.mousePos_y=0}}t.ExUniforms=r,t.ExShaderParam=class{}},3644:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.CubismMoc=void 0;const n=i(1201),o=i(3289),u=i(1349);class l{constructor(e){this._moc=e,this._modelCount=0}static create(e){let t=null;const i=Live2DCubismCore.Moc.fromArrayBuffer(e);return i&&(t=new l(i)),t}static delete(e){e._moc._release(),e._moc=null,e=null}createModel(e){let t=null;const i=Live2DCubismCore.Model.fromMoc(this._moc);var r=new u.ExShaderParam;const s=i.drawables.count;r.exShaderIndicies=new Array(s),r.exuniforms=new Map;for(var a=0;a<s;a++)r.exShaderIndicies[a]=-1;var n=e.length;for(a=0;a<i.drawables.ids.length;a++)for(var l=0;l<n;l++)e[l].artMeshID==i.drawables.ids[a]&&(r.exShaderIndicies[a]=e[l].exShaderIndex,r.exuniforms.set(a,e[l].exUniform));return i&&(t=new o.CubismModel(i,r),t.initialize(),++this._modelCount),t}deleteModel(e){null!=e&&(e.release(),e=null,--this._modelCount)}release(){n.CSM_ASSERT(0==this._modelCount),this._moc._release(),this._moc=null}}t.CubismMoc=l;const h=a(i(3644));(t.Live2DCubismFramework||(t.Live2DCubismFramework={})).CubismMoc=h.CubismMoc},3289:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.CubismModel=void 0;const n=i(8871),o=i(3006),u=i(9045),l=i(6486),h=i(1201);t.CubismModel=class{constructor(e,t){this._model=e,this.exShaderParam=t,this._parameterValues=null,this._parameterMaximumValues=null,this._parameterMinimumValues=null,this._partOpacities=null,this._savedParameters=new l.csmVector,this._parameterIds=new l.csmVector,this._drawableIds=new l.csmVector,this._partIds=new l.csmVector,this._notExistPartId=new u.csmMap,this._notExistParameterId=new u.csmMap,this._notExistParameterValues=new u.csmMap,this._notExistPartOpacities=new u.csmMap}update(){this._model.update(),this._model.drawables.resetDynamicFlags()}getCanvasWidth(){return null==this._model?0:this._model.canvasinfo.CanvasWidth/this._model.canvasinfo.PixelsPerUnit}getCanvasHeight(){return null==this._model?0:this._model.canvasinfo.CanvasHeight/this._model.canvasinfo.PixelsPerUnit}saveParameters(){const e=this._model.parameters.count,t=this._savedParameters.getSize();for(let i=0;i<e;++i)i<t?this._savedParameters.set(i,this._parameterValues[i]):this._savedParameters.pushBack(this._parameterValues[i])}getModel(){return this._model}getPartIndex(e){let t;const i=this._model.parts.count;for(t=0;t<i;++t)if(e==this._partIds.at(t))return t;return this._notExistPartId.isExist(e)?this._notExistPartId.getValue(e):(t=i+this._notExistPartId.getSize(),this._notExistPartId.setValue(e,t),this._notExistPartOpacities.appendKey(t),t)}getPartCount(){return this._model.parts.count}setPartOpacityByIndex(e,t){this._notExistPartOpacities.isExist(e)?this._notExistPartOpacities.setValue(e,t):(h.CSM_ASSERT(0<=e&&e<this.getPartCount()),this._partOpacities[e]=t)}setPartOpacityById(e,t){const i=this.getPartIndex(e);i<0||this.setPartOpacityByIndex(i,t)}getPartOpacityByIndex(e){return this._notExistPartOpacities.isExist(e)?this._notExistPartOpacities.getValue(e):(h.CSM_ASSERT(0<=e&&e<this.getPartCount()),this._partOpacities[e])}getPartOpacityById(e){const t=this.getPartIndex(e);return t<0?0:this.getPartOpacityByIndex(t)}getParameterIndex(e){let t;const i=this._model.parameters.count;for(t=0;t<i;++t)if(e==this._parameterIds.at(t))return t;return this._notExistParameterId.isExist(e)?this._notExistParameterId.getValue(e):(t=this._model.parameters.count+this._notExistParameterId.getSize(),this._notExistParameterId.setValue(e,t),this._notExistParameterValues.appendKey(t),t)}getParameterCount(){return this._model.parameters.count}getParameterMaximumValue(e){return this._model.parameters.maximumValues[e]}getParameterMinimumValue(e){return this._model.parameters.minimumValues[e]}getParameterDefaultValue(e){return this._model.parameters.defaultValues[e]}getParameterValueByIndex(e){return this._notExistParameterValues.isExist(e)?this._notExistParameterValues.getValue(e):(h.CSM_ASSERT(0<=e&&e<this.getParameterCount()),this._parameterValues[e])}getParameterValueById(e){const t=this.getParameterIndex(e);return this.getParameterValueByIndex(t)}setParameterValueByIndex(e,t,i=1){this._notExistParameterValues.isExist(e)?this._notExistParameterValues.setValue(e,1==i?t:this._notExistParameterValues.getValue(e)*(1-i)+t*i):(h.CSM_ASSERT(0<=e&&e<this.getParameterCount()),this._model.parameters.maximumValues[e]<t&&(t=this._model.parameters.maximumValues[e]),this._model.parameters.minimumValues[e]>t&&(t=this._model.parameters.minimumValues[e]),this._parameterValues[e]=1==i?t:this._parameterValues[e]=this._parameterValues[e]*(1-i)+t*i)}setParameterValueById(e,t,i=1){const r=this.getParameterIndex(e);this.setParameterValueByIndex(r,t,i)}addParameterValueByIndex(e,t,i=1){this.setParameterValueByIndex(e,this.getParameterValueByIndex(e)+t*i)}addParameterValueById(e,t,i=1){const r=this.getParameterIndex(e);this.addParameterValueByIndex(r,t,i)}multiplyParameterValueById(e,t,i=1){const r=this.getParameterIndex(e);this.multiplyParameterValueByIndex(r,t,i)}multiplyParameterValueByIndex(e,t,i=1){this.setParameterValueByIndex(e,this.getParameterValueByIndex(e)*(1+(t-1)*i))}getDrawableIndex(e){const t=this._model.drawables.count;for(let i=0;i<t;++i)if(this._drawableIds.at(i)==e)return i;return-1}getDrawableCount(){return this._model.drawables.count}getDrawableId(e){const t=this._model.drawables.ids;return n.CubismFramework.getIdManager().getId(t[e])}getDrawableRenderOrders(){return this._model.drawables.renderOrders}getDrawableTextureIndices(e){return this._model.drawables.textureIndices[e]}GetExShaderNum(e){return this.exShaderParam.exShaderIndicies[e]}GetExShaderUni(e){return this.exShaderParam.exShaderIndicies[e]<0?null:this.exShaderParam.exuniforms.get(e)}getDrawableDynamicFlagVertexPositionsDidChange(e){const t=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasVertexPositionsDidChangeBit(t[e])}getDrawableVertexIndexCount(e){return this._model.drawables.indexCounts[e]}getDrawableVertexCount(e){return this._model.drawables.vertexCounts[e]}getDrawableVertices(e){return this.getDrawableVertexPositions(e)}getDrawableVertexIndices(e){return this._model.drawables.indices[e]}getDrawableVertexPositions(e){return this._model.drawables.vertexPositions[e]}getDrawableVertexUvs(e){return this._model.drawables.vertexUvs[e]}getDrawableOpacity(e){return this._model.drawables.opacities[e]}getDrawableCulling(e){const t=this._model.drawables.constantFlags;return!Live2DCubismCore.Utils.hasIsDoubleSidedBit(t[e])}getDrawableBlendMode(e){const t=this._model.drawables.constantFlags;return Live2DCubismCore.Utils.hasBlendAdditiveBit(t[e])?o.CubismBlendMode.CubismBlendMode_Additive:Live2DCubismCore.Utils.hasBlendMultiplicativeBit(t[e])?o.CubismBlendMode.CubismBlendMode_Multiplicative:o.CubismBlendMode.CubismBlendMode_Normal}getDrawableInvertedMaskBit(e){const t=this._model.drawables.constantFlags;return Live2DCubismCore.Utils.hasIsInvertedMaskBit(t[e])}getDrawableMasks(){return this._model.drawables.masks}getDrawableMaskCounts(){return this._model.drawables.maskCounts}isUsingMasking(){for(let e=0;e<this._model.drawables.count;++e)if(!(this._model.drawables.maskCounts[e]<=0))return!0;return!1}getDrawableDynamicFlagIsVisible(e){const t=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasIsVisibleBit(t[e])}getDrawableDynamicFlagVisibilityDidChange(e){const t=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasVisibilityDidChangeBit(t[e])}getDrawableDynamicFlagOpacityDidChange(e){const t=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasOpacityDidChangeBit(t[e])}getDrawableDynamicFlagRenderOrderDidChange(e){const t=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasRenderOrderDidChangeBit(t[e])}loadParameters(){let e=this._model.parameters.count;const t=this._savedParameters.getSize();e>t&&(e=t);for(let t=0;t<e;++t)this._parameterValues[t]=this._savedParameters.at(t)}initialize(){h.CSM_ASSERT(this._model),this._parameterValues=this._model.parameters.values,this._partOpacities=this._model.parts.opacities,this._parameterMaximumValues=this._model.parameters.maximumValues,this._parameterMinimumValues=this._model.parameters.minimumValues;{const e=this._model.parameters.ids,t=this._model.parameters.count;this._parameterIds.prepareCapacity(t);for(let i=0;i<t;++i)this._parameterIds.pushBack(n.CubismFramework.getIdManager().getId(e[i]))}{const e=this._model.parts.ids,t=this._model.parts.count;this._partIds.prepareCapacity(t);for(let i=0;i<t;++i)this._partIds.pushBack(n.CubismFramework.getIdManager().getId(e[i]))}{const e=this._model.drawables.ids,t=this._model.drawables.count;this._drawableIds.prepareCapacity(t);for(let i=0;i<t;++i)this._drawableIds.pushBack(n.CubismFramework.getIdManager().getId(e[i]))}}release(){this._model.release(),this._model=null}};const d=a(i(3289));(t.Live2DCubismFramework||(t.Live2DCubismFramework={})).CubismModel=d.CubismModel},712:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.CubismModelUserData=t.CubismModelUserDataNode=void 0;const n=i(8871),o=i(4020),u=i(6486),l=i(2440);class h{}t.CubismModelUserDataNode=h;class d{constructor(){this._userDataNodes=new u.csmVector,this._artMeshUserDataNode=new u.csmVector}static create(e,t){const i=new d;return i.parseUserData(e,t),i}static delete(e){null!=e&&(e.release(),e=null)}getArtMeshUserDatas(){return this._artMeshUserDataNode}parseUserData(e,t){let i=new l.CubismModelUserDataJson(e,t);const r=n.CubismFramework.getIdManager().getId("ArtMesh"),s=i.getUserDataCount();for(let e=0;e<s;e++){const t=new h;t.targetId=i.getUserDataId(e),t.targetType=n.CubismFramework.getIdManager().getId(i.getUserDataTargetType(e)),t.value=new o.csmString(i.getUserDataValue(e)),this._userDataNodes.pushBack(t),t.targetType==r&&this._artMeshUserDataNode.pushBack(t)}i.release(),i=void 0}release(){for(let e=0;e<this._userDataNodes.getSize();++e)this._userDataNodes.set(e,null);this._userDataNodes=null}}t.CubismModelUserData=d;const c=a(i(712));var g;(g=t.Live2DCubismFramework||(t.Live2DCubismFramework={})).CubismModelUserData=c.CubismModelUserData,g.CubismModelUserDataNode=c.CubismModelUserDataNode},2440:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.CubismModelUserDataJson=void 0;const n=i(8871),o=i(4462),u="Meta",l="UserData";t.CubismModelUserDataJson=class{constructor(e,t){this._json=o.CubismJson.create(e,t)}release(){o.CubismJson.delete(this._json)}getUserDataCount(){return this._json.getRoot().getValueByString(u).getValueByString("UserDataCount").toInt()}getTotalUserDataSize(){return this._json.getRoot().getValueByString(u).getValueByString("TotalUserDataSize").toInt()}getUserDataTargetType(e){return this._json.getRoot().getValueByString(l).getValueByIndex(e).getValueByString("Target").getRawString()}getUserDataId(e){return n.CubismFramework.getIdManager().getId(this._json.getRoot().getValueByString(l).getValueByIndex(e).getValueByString("Id").getRawString())}getUserDataValue(e){return this._json.getRoot().getValueByString(l).getValueByIndex(e).getValueByString("Value").getRawString()}};const h=a(i(2440));(t.Live2DCubismFramework||(t.Live2DCubismFramework={})).CubismModelUserDataJson=h.CubismModelUserDataJson},9460:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.CubismUserModel=void 0;const n=i(4218),o=i(8349),u=i(459),l=i(8871),h=i(7144),d=i(4583),c=i(6623),g=i(398),m=i(1443),_=i(3137),p=i(5137),f=i(1201),y=i(3644),b=i(712);class S{constructor(){this.loadMotion=(e,t,i,r)=>g.CubismMotion.create(e,t,r),this._moc=null,this._model=null,this._motionManager=null,this._expressionManager=null,this._eyeBlink=null,this._breath=null,this._modelMatrix=null,this._pose=null,this._dragManager=null,this._physics=null,this._modelUserData=null,this._initialized=!1,this._updating=!1,this._opacity=1,this._lipsync=!0,this._lastLipSyncValue=0,this._dragX=0,this._dragY=0,this._accelerationX=0,this._accelerationY=0,this._accelerationZ=0,this._debugMode=!1,this._renderer=null,this._motionManager=new m.CubismMotionManager,this._motionManager.setEventCallback(S.cubismDefaultMotionEventCallback,this),this._expressionManager=new m.CubismMotionManager,this._dragManager=new d.CubismTargetPoint}isInitialized(){return this._initialized}setInitialized(e){this._initialized=e}isUpdating(){return this._updating}setUpdating(e){this._updating=e}setDragging(e,t){this._dragManager.set(e,t)}setAcceleration(e,t,i){this._accelerationX=e,this._accelerationY=t,this._accelerationZ=i}getModelMatrix(){return this._modelMatrix}setOpacity(e){this._opacity=e}getOpacity(){return this._opacity}loadModel(e,t){this._moc=y.CubismMoc.create(e),this._model=this._moc.createModel(t),this._model.saveParameters(),null!=this._moc&&null!=this._model?this._modelMatrix=new h.CubismModelMatrix(this._model.getCanvasWidth(),this._model.getCanvasHeight()):f.CubismLogError("Failed to CreateModel().")}loadExpression(e,t,i){return c.CubismExpressionMotion.create(e,t)}loadPose(e,t){this._pose=u.CubismPose.create(e,t)}loadUserData(e,t){this._modelUserData=b.CubismModelUserData.create(e,t)}loadPhysics(e,t){this._physics=_.CubismPhysics.create(e,t)}isHit(e,t,i){const r=this._model.getDrawableIndex(e);if(r<0)return!1;const s=this._model.getDrawableVertexCount(r),a=this._model.getDrawableVertices(r);let n=a[0],o=a[0],u=a[1],h=a[1];for(let e=1;e<s;++e){const t=a[l.Constant.vertexOffset+e*l.Constant.vertexStep],i=a[l.Constant.vertexOffset+e*l.Constant.vertexStep+1];t<n&&(n=t),t>o&&(o=t),i<u&&(u=i),i>h&&(h=i)}const d=this._modelMatrix.invertTransformX(t),c=this._modelMatrix.invertTransformY(i);return n<=d&&d<=o&&u<=c&&c<=h}getModel(){return this._model}getRenderer(){return this._renderer}createRenderer(){this._renderer&&this.deleteRenderer(),this._renderer=new p.CubismRenderer_WebGL,this._renderer.initialize(this._model)}deleteRenderer(){null!=this._renderer&&(this._renderer.release(),this._renderer=null)}motionEventFired(e){f.CubismLogInfo("{0}",e.s)}static cubismDefaultMotionEventCallback(e,t,i){null!=i&&i.motionEventFired(t)}release(){null!=this._motionManager&&(this._motionManager.release(),this._motionManager=null),null!=this._expressionManager&&(this._expressionManager.release(),this._expressionManager=null),null!=this._moc&&(this._moc.deleteModel(this._model),this._moc.release(),this._moc=null),this._modelMatrix=null,u.CubismPose.delete(this._pose),o.CubismEyeBlink.delete(this._eyeBlink),n.CubismBreath.delete(this._breath),this._dragManager=null,_.CubismPhysics.delete(this._physics),b.CubismModelUserData.delete(this._modelUserData),this.deleteRenderer()}}t.CubismUserModel=S;const C=a(i(9460));(t.Live2DCubismFramework||(t.Live2DCubismFramework={})).CubismUserModel=C.CubismUserModel},6875:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.ACubismMotion=void 0;const n=i(9657),o=i(6486),u=i(1201);t.ACubismMotion=class{constructor(){this.setFinishedMotionHandler=e=>this._onFinishedMotion=e,this.getFinishedMotionHandler=()=>this._onFinishedMotion,this._fadeInSeconds=-1,this._fadeOutSeconds=-1,this._weight=1,this._offsetSeconds=0,this._firedEventValues=new o.csmVector}static delete(e){e.release(),e=void 0,e=null}release(){this._weight=0}updateParameters(e,t,i){if(!t.isAvailable()||t.isFinished())return;if(!t.isStarted()){t.setIsStarted(!0),t.setStartTime(i-this._offsetSeconds),t.setFadeInStartTime(i);const e=this.getDuration();t.getEndTime()<0&&t.setEndTime(e<=0?-1:t.getStartTime()+e)}let r=this._weight;r=r*(0==this._fadeInSeconds?1:n.CubismMath.getEasingSine((i-t.getFadeInStartTime())/this._fadeInSeconds))*(0==this._fadeOutSeconds||t.getEndTime()<0?1:n.CubismMath.getEasingSine((t.getEndTime()-i)/this._fadeOutSeconds)),t.setState(i,r),u.CSM_ASSERT(0<=r&&r<=1),this.doUpdateParameters(e,i,r,t),t.getEndTime()>0&&t.getEndTime()<i&&t.setIsFinished(!0)}setFadeInTime(e){this._fadeInSeconds=e}setFadeOutTime(e){this._fadeOutSeconds=e}getFadeOutTime(){return this._fadeOutSeconds}getFadeInTime(){return this._fadeInSeconds}setWeight(e){this._weight=e}getWeight(){return this._weight}getDuration(){return-1}getLoopDuration(){return-1}setOffsetTime(e){this._offsetSeconds=e}getFiredEvent(e,t){return this._firedEventValues}};const l=a(i(6875));(t.Live2DCubismFramework||(t.Live2DCubismFramework={})).ACubismMotion=l.ACubismMotion},6623:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.ExpressionParameter=t.ExpressionBlendType=t.CubismExpressionMotion=void 0;const n=i(8871),o=i(6486),u=i(4462),l=i(6875),h="Parameters",d="Blend";class c extends l.ACubismMotion{constructor(){super(),this._parameters=new o.csmVector}static create(e,t){const i=new c,r=u.CubismJson.create(e,t),s=r.getRoot();i.setFadeInTime(s.getValueByString("FadeInTime").toFloat(1)),i.setFadeOutTime(s.getValueByString("FadeOutTime").toFloat(1));const a=s.getValueByString(h).getSize();i._parameters.prepareCapacity(a);for(let e=0;e<a;++e){const t=s.getValueByString(h).getValueByIndex(e),r=n.CubismFramework.getIdManager().getId(t.getValueByString("Id").getRawString()),a=t.getValueByString("Value").toFloat();let o;o=t.getValueByString(d).isNull()||"Add"==t.getValueByString(d).getString()?g.ExpressionBlendType_Add:"Multiply"==t.getValueByString(d).getString()?g.ExpressionBlendType_Multiply:"Overwrite"==t.getValueByString(d).getString()?g.ExpressionBlendType_Overwrite:g.ExpressionBlendType_Add;const u=new m;u.parameterId=r,u.blendType=o,u.value=a,i._parameters.pushBack(u)}return u.CubismJson.delete(r),i}doUpdateParameters(e,t,i,r){for(let t=0;t<this._parameters.getSize();++t){const r=this._parameters.at(t);switch(r.blendType){case g.ExpressionBlendType_Add:e.addParameterValueById(r.parameterId,r.value,i);break;case g.ExpressionBlendType_Multiply:e.multiplyParameterValueById(r.parameterId,r.value,i);break;case g.ExpressionBlendType_Overwrite:e.setParameterValueById(r.parameterId,r.value,i)}}}}var g;t.CubismExpressionMotion=c,function(e){e[e.ExpressionBlendType_Add=0]="ExpressionBlendType_Add",e[e.ExpressionBlendType_Multiply=1]="ExpressionBlendType_Multiply",e[e.ExpressionBlendType_Overwrite=2]="ExpressionBlendType_Overwrite"}(g=t.ExpressionBlendType||(t.ExpressionBlendType={}));class m{}t.ExpressionParameter=m;const _=a(i(6623));var p;(p=t.Live2DCubismFramework||(t.Live2DCubismFramework={})).CubismExpressionMotion=_.CubismExpressionMotion,p.ExpressionBlendType=_.ExpressionBlendType,p.ExpressionParameter=_.ExpressionParameter},398:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.CubismMotion=void 0;const n=i(8871),o=i(9657),u=i(4020),l=i(1201),h=i(6875),d=i(9993),c=i(2292);function g(e,t,i){const r=new d.CubismMotionPoint;return r.time=e.time+(t.time-e.time)*i,r.value=e.value+(t.value-e.value)*i,r}function m(e,t){let i=(t-e[0].time)/(e[1].time-e[0].time);return i<0&&(i=0),e[0].value+(e[1].value-e[0].value)*i}function _(e,t){let i=(t-e[0].time)/(e[3].time-e[0].time);i<0&&(i=0);const r=g(e[0],e[1],i),s=g(e[1],e[2],i),a=g(e[2],e[3],i),n=g(r,s,i),o=g(s,a,i);return g(n,o,i).value}function p(e,t){return e[0].value}function f(e,t){return e[1].value}function y(e,t,i){const r=e.curves.at(t);let s=-1;const a=r.baseSegmentIndex+r.segmentCount;let n=0;for(let t=r.baseSegmentIndex;t<a;++t)if(n=e.segments.at(t).basePointIndex+(e.segments.at(t).segmentType==d.CubismMotionSegmentType.CubismMotionSegmentType_Bezier?3:1),e.points.at(n).time>i){s=t;break}if(-1==s)return e.points.at(n).value;const o=e.segments.at(s);return o.evaluate(e.points.get(o.basePointIndex),i)}class b extends h.ACubismMotion{constructor(){super(),this._sourceFrameRate=30,this._loopDurationSeconds=-1,this._isLoop=!1,this._isLoopFadeIn=!0,this._lastWeight=0,this._motionData=null,this._modelCurveIdEyeBlink=null,this._modelCurveIdLipSync=null,this._eyeBlinkParameterIds=null,this._lipSyncParameterIds=null}static create(e,t,i){const r=new b;return r.parse(e,t),r._sourceFrameRate=r._motionData.fps,r._loopDurationSeconds=r._motionData.duration,r._onFinishedMotion=i,r}doUpdateParameters(e,t,i,r){null==this._modelCurveIdEyeBlink&&(this._modelCurveIdEyeBlink=n.CubismFramework.getIdManager().getId("EyeBlink")),null==this._modelCurveIdLipSync&&(this._modelCurveIdLipSync=n.CubismFramework.getIdManager().getId("LipSync"));let s=t-r.getStartTime();s<0&&(s=0);let a=Number.MAX_VALUE,u=Number.MAX_VALUE;const h=64;let c=0,g=0;this._eyeBlinkParameterIds.getSize()>h&&l.CubismLogDebug("too many eye blink targets : {0}",this._eyeBlinkParameterIds.getSize()),this._lipSyncParameterIds.getSize()>h&&l.CubismLogDebug("too many lip sync targets : {0}",this._lipSyncParameterIds.getSize());const m=this._fadeInSeconds<=0?1:o.CubismMath.getEasingSine((t-r.getFadeInStartTime())/this._fadeInSeconds),_=this._fadeOutSeconds<=0||r.getEndTime()<0?1:o.CubismMath.getEasingSine((r.getEndTime()-t)/this._fadeOutSeconds);let p,f,b,S=s;if(this._isLoop)for(;S>this._motionData.duration;)S-=this._motionData.duration;const C=this._motionData.curves;for(f=0;f<this._motionData.curveCount&&C.at(f).type==d.CubismMotionCurveTarget.CubismMotionCurveTarget_Model;++f)p=y(this._motionData,f,S),C.at(f).id==this._modelCurveIdEyeBlink?u=p:C.at(f).id==this._modelCurveIdLipSync&&(a=p);for(;f<this._motionData.curveCount&&C.at(f).type==d.CubismMotionCurveTarget.CubismMotionCurveTarget_Parameter;++f){if(b=e.getParameterIndex(C.at(f).id),-1==b)continue;const s=e.getParameterValueByIndex(b);if(p=y(this._motionData,f,S),u!=Number.MAX_VALUE)for(let e=0;e<this._eyeBlinkParameterIds.getSize()&&e<h;++e)if(this._eyeBlinkParameterIds.at(e)==C.at(f).id){p*=u,g|=1<<e;break}if(a!=Number.MAX_VALUE)for(let e=0;e<this._lipSyncParameterIds.getSize()&&e<h;++e)if(this._lipSyncParameterIds.at(e)==C.at(f).id){p+=a,c|=1<<e;break}let n;if(C.at(f).fadeInTime<0&&C.at(f).fadeOutTime<0)n=s+(p-s)*i;else{let e,i;e=C.at(f).fadeInTime<0?m:0==C.at(f).fadeInTime?1:o.CubismMath.getEasingSine((t-r.getFadeInStartTime())/C.at(f).fadeInTime),i=C.at(f).fadeOutTime<0?_:0==C.at(f).fadeOutTime||r.getEndTime()<0?1:o.CubismMath.getEasingSine((r.getEndTime()-t)/C.at(f).fadeOutTime),n=s+(p-s)*(this._weight*e*i)}e.setParameterValueByIndex(b,n,1)}if(u!=Number.MAX_VALUE)for(let t=0;t<this._eyeBlinkParameterIds.getSize()&&t<h;++t){const r=e.getParameterValueById(this._eyeBlinkParameterIds.at(t));if(g>>t&1)continue;const s=r+(u-r)*i;e.setParameterValueById(this._eyeBlinkParameterIds.at(t),s)}if(a!=Number.MAX_VALUE)for(let t=0;t<this._lipSyncParameterIds.getSize()&&t<h;++t){const r=e.getParameterValueById(this._lipSyncParameterIds.at(t));if(c>>t&1)continue;const s=r+(a-r)*i;e.setParameterValueById(this._lipSyncParameterIds.at(t),s)}for(;f<this._motionData.curveCount&&C.at(f).type==d.CubismMotionCurveTarget.CubismMotionCurveTarget_PartOpacity;++f)b=e.getParameterIndex(C.at(f).id),-1!=b&&(p=y(this._motionData,f,S),e.setParameterValueByIndex(b,p));s>=this._motionData.duration&&(this._isLoop?(r.setStartTime(t),this._isLoopFadeIn&&r.setFadeInStartTime(t)):(this._onFinishedMotion&&this._onFinishedMotion(this),r.setIsFinished(!0))),this._lastWeight=i}setIsLoop(e){this._isLoop=e}isLoop(){return this._isLoop}setIsLoopFadeIn(e){this._isLoopFadeIn=e}isLoopFadeIn(){return this._isLoopFadeIn}getDuration(){return this._isLoop?-1:this._loopDurationSeconds}getLoopDuration(){return this._loopDurationSeconds}setParameterFadeInTime(e,t){const i=this._motionData.curves;for(let r=0;r<this._motionData.curveCount;++r)if(e==i.at(r).id)return void(i.at(r).fadeInTime=t)}setParameterFadeOutTime(e,t){const i=this._motionData.curves;for(let r=0;r<this._motionData.curveCount;++r)if(e==i.at(r).id)return void(i.at(r).fadeOutTime=t)}getParameterFadeInTime(e){const t=this._motionData.curves;for(let i=0;i<this._motionData.curveCount;++i)if(e==t.at(i).id)return t.at(i).fadeInTime;return-1}getParameterFadeOutTime(e){const t=this._motionData.curves;for(let i=0;i<this._motionData.curveCount;++i)if(e==t.at(i).id)return t.at(i).fadeOutTime;return-1}setEffectIds(e,t){this._eyeBlinkParameterIds=e,this._lipSyncParameterIds=t}release(){this._motionData=void 0,this._motionData=null}parse(e,t){this._motionData=new d.CubismMotionData;let i=new c.CubismMotionJson(e,t);this._motionData.duration=i.getMotionDuration(),this._motionData.loop=i.isMotionLoop(),this._motionData.curveCount=i.getMotionCurveCount(),this._motionData.fps=i.getMotionFps(),this._motionData.eventCount=i.getEventCount(),i.isExistMotionFadeInTime()?this._fadeInSeconds=i.getMotionFadeInTime()<0?1:i.getMotionFadeInTime():this._fadeInSeconds=1,i.isExistMotionFadeOutTime()?this._fadeOutSeconds=i.getMotionFadeOutTime()<0?1:i.getMotionFadeOutTime():this._fadeOutSeconds=1,this._motionData.curves.updateSize(this._motionData.curveCount,d.CubismMotionCurve,!0),this._motionData.segments.updateSize(i.getMotionTotalSegmentCount(),d.CubismMotionSegment,!0),this._motionData.points.updateSize(i.getMotionTotalPointCount(),d.CubismMotionPoint,!0),this._motionData.events.updateSize(this._motionData.eventCount,d.CubismMotionEvent,!0);let r=0,s=0;for(let e=0;e<this._motionData.curveCount;++e){"Model"==i.getMotionCurveTarget(e)?this._motionData.curves.at(e).type=d.CubismMotionCurveTarget.CubismMotionCurveTarget_Model:"Parameter"==i.getMotionCurveTarget(e)?this._motionData.curves.at(e).type=d.CubismMotionCurveTarget.CubismMotionCurveTarget_Parameter:"PartOpacity"==i.getMotionCurveTarget(e)&&(this._motionData.curves.at(e).type=d.CubismMotionCurveTarget.CubismMotionCurveTarget_PartOpacity),this._motionData.curves.at(e).id=i.getMotionCurveId(e),this._motionData.curves.at(e).baseSegmentIndex=s,this._motionData.curves.at(e).fadeInTime=i.isExistMotionCurveFadeInTime(e)?i.getMotionCurveFadeInTime(e):-1,this._motionData.curves.at(e).fadeOutTime=i.isExistMotionCurveFadeOutTime(e)?i.getMotionCurveFadeOutTime(e):-1;for(let t=0;t<i.getMotionCurveSegmentCount(e);){switch(0==t?(this._motionData.segments.at(s).basePointIndex=r,this._motionData.points.at(r).time=i.getMotionCurveSegment(e,t),this._motionData.points.at(r).value=i.getMotionCurveSegment(e,t+1),r+=1,t+=2):this._motionData.segments.at(s).basePointIndex=r-1,i.getMotionCurveSegment(e,t)){case d.CubismMotionSegmentType.CubismMotionSegmentType_Linear:this._motionData.segments.at(s).segmentType=d.CubismMotionSegmentType.CubismMotionSegmentType_Linear,this._motionData.segments.at(s).evaluate=m,this._motionData.points.at(r).time=i.getMotionCurveSegment(e,t+1),this._motionData.points.at(r).value=i.getMotionCurveSegment(e,t+2),r+=1,t+=3;break;case d.CubismMotionSegmentType.CubismMotionSegmentType_Bezier:this._motionData.segments.at(s).segmentType=d.CubismMotionSegmentType.CubismMotionSegmentType_Bezier,this._motionData.segments.at(s).evaluate=_,this._motionData.points.at(r).time=i.getMotionCurveSegment(e,t+1),this._motionData.points.at(r).value=i.getMotionCurveSegment(e,t+2),this._motionData.points.at(r+1).time=i.getMotionCurveSegment(e,t+3),this._motionData.points.at(r+1).value=i.getMotionCurveSegment(e,t+4),this._motionData.points.at(r+2).time=i.getMotionCurveSegment(e,t+5),this._motionData.points.at(r+2).value=i.getMotionCurveSegment(e,t+6),r+=3,t+=7;break;case d.CubismMotionSegmentType.CubismMotionSegmentType_Stepped:this._motionData.segments.at(s).segmentType=d.CubismMotionSegmentType.CubismMotionSegmentType_Stepped,this._motionData.segments.at(s).evaluate=p,this._motionData.points.at(r).time=i.getMotionCurveSegment(e,t+1),this._motionData.points.at(r).value=i.getMotionCurveSegment(e,t+2),r+=1,t+=3;break;case d.CubismMotionSegmentType.CubismMotionSegmentType_InverseStepped:this._motionData.segments.at(s).segmentType=d.CubismMotionSegmentType.CubismMotionSegmentType_InverseStepped,this._motionData.segments.at(s).evaluate=f,this._motionData.points.at(r).time=i.getMotionCurveSegment(e,t+1),this._motionData.points.at(r).value=i.getMotionCurveSegment(e,t+2),r+=1,t+=3;break;default:l.CSM_ASSERT(0)}++this._motionData.curves.at(e).segmentCount,++s}}for(let e=0;e<i.getEventCount();++e)this._motionData.events.at(e).fireTime=i.getEventTime(e),this._motionData.events.at(e).value=i.getEventValue(e);i.release(),i=void 0,i=null}getFiredEvent(e,t){this._firedEventValues.updateSize(0);for(let i=0;i<this._motionData.eventCount;++i)this._motionData.events.at(i).fireTime>e&&this._motionData.events.at(i).fireTime<=t&&this._firedEventValues.pushBack(new u.csmString(this._motionData.events.at(i).value.s));return this._firedEventValues}}t.CubismMotion=b;const S=a(i(398));(t.Live2DCubismFramework||(t.Live2DCubismFramework={})).CubismMotion=S.CubismMotion},9993:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.CubismMotionData=t.CubismMotionEvent=t.CubismMotionCurve=t.CubismMotionSegment=t.CubismMotionPoint=t.CubismMotionSegmentType=t.CubismMotionCurveTarget=void 0;const n=i(6486);var o,u;!function(e){e[e.CubismMotionCurveTarget_Model=0]="CubismMotionCurveTarget_Model",e[e.CubismMotionCurveTarget_Parameter=1]="CubismMotionCurveTarget_Parameter",e[e.CubismMotionCurveTarget_PartOpacity=2]="CubismMotionCurveTarget_PartOpacity"}(o=t.CubismMotionCurveTarget||(t.CubismMotionCurveTarget={})),(u=t.CubismMotionSegmentType||(t.CubismMotionSegmentType={}))[u.CubismMotionSegmentType_Linear=0]="CubismMotionSegmentType_Linear",u[u.CubismMotionSegmentType_Bezier=1]="CubismMotionSegmentType_Bezier",u[u.CubismMotionSegmentType_Stepped=2]="CubismMotionSegmentType_Stepped",u[u.CubismMotionSegmentType_InverseStepped=3]="CubismMotionSegmentType_InverseStepped",t.CubismMotionPoint=class{constructor(){this.time=0,this.value=0}},t.CubismMotionSegment=class{constructor(){this.evaluate=null,this.basePointIndex=0,this.segmentType=0}},t.CubismMotionCurve=class{constructor(){this.type=o.CubismMotionCurveTarget_Model,this.segmentCount=0,this.baseSegmentIndex=0,this.fadeInTime=0,this.fadeOutTime=0}},t.CubismMotionEvent=class{constructor(){this.fireTime=0}},t.CubismMotionData=class{constructor(){this.duration=0,this.loop=!1,this.curveCount=0,this.eventCount=0,this.fps=0,this.curves=new n.csmVector,this.segments=new n.csmVector,this.points=new n.csmVector,this.events=new n.csmVector}};const l=a(i(9993));var h;(h=t.Live2DCubismFramework||(t.Live2DCubismFramework={})).CubismMotionCurve=l.CubismMotionCurve,h.CubismMotionCurveTarget=l.CubismMotionCurveTarget,h.CubismMotionData=l.CubismMotionData,h.CubismMotionEvent=l.CubismMotionEvent,h.CubismMotionPoint=l.CubismMotionPoint,h.CubismMotionSegment=l.CubismMotionSegment,h.CubismMotionSegmentType=l.CubismMotionSegmentType},2292:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.CubismMotionJson=void 0;const n=i(8871),o=i(4020),u=i(4462),l="Meta",h="Curves",d="FadeInTime",c="FadeOutTime",g="Segments",m="UserData";t.CubismMotionJson=class{constructor(e,t){this._json=u.CubismJson.create(e,t)}release(){u.CubismJson.delete(this._json)}getMotionDuration(){return this._json.getRoot().getValueByString(l).getValueByString("Duration").toFloat()}isMotionLoop(){return this._json.getRoot().getValueByString(l).getValueByString("Loop").toBoolean()}getMotionCurveCount(){return this._json.getRoot().getValueByString(l).getValueByString("CurveCount").toInt()}getMotionFps(){return this._json.getRoot().getValueByString(l).getValueByString("Fps").toFloat()}getMotionTotalSegmentCount(){return this._json.getRoot().getValueByString(l).getValueByString("TotalSegmentCount").toInt()}getMotionTotalPointCount(){return this._json.getRoot().getValueByString(l).getValueByString("TotalPointCount").toInt()}isExistMotionFadeInTime(){return!this._json.getRoot().getValueByString(l).getValueByString(d).isNull()}isExistMotionFadeOutTime(){return!this._json.getRoot().getValueByString(l).getValueByString(c).isNull()}getMotionFadeInTime(){return this._json.getRoot().getValueByString(l).getValueByString(d).toFloat()}getMotionFadeOutTime(){return this._json.getRoot().getValueByString(l).getValueByString(c).toFloat()}getMotionCurveTarget(e){return this._json.getRoot().getValueByString(h).getValueByIndex(e).getValueByString("Target").getRawString()}getMotionCurveId(e){return n.CubismFramework.getIdManager().getId(this._json.getRoot().getValueByString(h).getValueByIndex(e).getValueByString("Id").getRawString())}isExistMotionCurveFadeInTime(e){return!this._json.getRoot().getValueByString(h).getValueByIndex(e).getValueByString(d).isNull()}isExistMotionCurveFadeOutTime(e){return!this._json.getRoot().getValueByString(h).getValueByIndex(e).getValueByString(c).isNull()}getMotionCurveFadeInTime(e){return this._json.getRoot().getValueByString(h).getValueByIndex(e).getValueByString(d).toFloat()}getMotionCurveFadeOutTime(e){return this._json.getRoot().getValueByString(h).getValueByIndex(e).getValueByString(c).toFloat()}getMotionCurveSegmentCount(e){return this._json.getRoot().getValueByString(h).getValueByIndex(e).getValueByString(g).getVector().getSize()}getMotionCurveSegment(e,t){return this._json.getRoot().getValueByString(h).getValueByIndex(e).getValueByString(g).getValueByIndex(t).toFloat()}getEventCount(){return this._json.getRoot().getValueByString(l).getValueByString("UserDataCount").toInt()}getTotalEventValueSize(){return this._json.getRoot().getValueByString(l).getValueByString("TotalUserDataSize").toInt()}getEventTime(e){return this._json.getRoot().getValueByString(m).getValueByIndex(e).getValueByString("Time").toInt()}getEventValue(e){return new o.csmString(this._json.getRoot().getValueByString(m).getValueByIndex(e).getValueByString("Value").getRawString())}};const _=a(i(2292));(t.Live2DCubismFramework||(t.Live2DCubismFramework={})).CubismMotionJson=_.CubismMotionJson},1443:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.CubismMotionManager=void 0;const n=i(5942);class o extends n.CubismMotionQueueManager{constructor(){super(),this._currentPriority=0,this._reservePriority=0}getCurrentPriority(){return this._currentPriority}getReservePriority(){return this._reservePriority}setReservePriority(e){this._reservePriority=e}startMotionPriority(e,t,i){return i==this._reservePriority&&(this._reservePriority=0),this._currentPriority=i,super.startMotion(e,t,this._userTimeSeconds)}updateMotion(e,t){this._userTimeSeconds+=t;const i=super.doUpdateMotion(e,this._userTimeSeconds);return this.isFinished()&&(this._currentPriority=0),i}reserveMotion(e){return!(e<=this._reservePriority||e<=this._currentPriority||(this._reservePriority=e,0))}}t.CubismMotionManager=o;const u=a(i(1443));(t.Live2DCubismFramework||(t.Live2DCubismFramework={})).CubismMotionManager=u.CubismMotionManager},6525:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.CubismMotionQueueEntry=void 0;const n=i(6875);t.CubismMotionQueueEntry=class{constructor(){this._autoDelete=!1,this._motion=null,this._available=!0,this._finished=!1,this._started=!1,this._startTimeSeconds=-1,this._fadeInStartTimeSeconds=0,this._endTimeSeconds=-1,this._stateTimeSeconds=0,this._stateWeight=0,this._lastEventCheckSeconds=0,this._motionQueueEntryHandle=this,this._fadeOutSeconds=0,this._isTriggeredFadeOut=!1}release(){this._autoDelete&&this._motion&&n.ACubismMotion.delete(this._motion)}setFadeOut(e){this._fadeOutSeconds=e,this._isTriggeredFadeOut=!0}startFadeOut(e,t){const i=t+e;this._isTriggeredFadeOut=!0,(this._endTimeSeconds<0||i<this._endTimeSeconds)&&(this._endTimeSeconds=i)}isFinished(){return this._finished}isStarted(){return this._started}getStartTime(){return this._startTimeSeconds}getFadeInStartTime(){return this._fadeInStartTimeSeconds}getEndTime(){return this._endTimeSeconds}setStartTime(e){this._startTimeSeconds=e}setFadeInStartTime(e){this._fadeInStartTimeSeconds=e}setEndTime(e){this._endTimeSeconds=e}setIsFinished(e){this._finished=e}setIsStarted(e){this._started=e}isAvailable(){return this._available}setIsAvailable(e){this._available=e}setState(e,t){this._stateTimeSeconds=e,this._stateWeight=t}getStateTime(){return this._stateTimeSeconds}getStateWeight(){return this._stateWeight}getLastCheckEventSeconds(){return this._lastEventCheckSeconds}setLastCheckEventSeconds(e){this._lastEventCheckSeconds=e}isTriggeredFadeOut(){return this._isTriggeredFadeOut&&this._endTimeSeconds<0}getFadeOutSeconds(){return this._fadeOutSeconds}};const o=a(i(6525));(t.Live2DCubismFramework||(t.Live2DCubismFramework={})).CubismMotionQueueEntry=o.CubismMotionQueueEntry},5942:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.InvalidMotionQueueEntryHandleValue=t.CubismMotionQueueManager=void 0;const n=i(6525),o=i(6486);t.CubismMotionQueueManager=class{constructor(){this._userTimeSeconds=0,this._eventCallBack=null,this._eventCustomData=null,this._motions=new o.csmVector}release(){for(let e=0;e<this._motions.getSize();++e)this._motions.at(e)&&(this._motions.at(e).release(),this._motions.set(e,void 0),this._motions.set(e,null));this._motions=null}startMotion(e,i,r){if(null==e)return t.InvalidMotionQueueEntryHandleValue;let s=null;for(let e=0;e<this._motions.getSize();++e)s=this._motions.at(e),null!=s&&s.setFadeOut(s._motion.getFadeOutTime());return s=new n.CubismMotionQueueEntry,s._autoDelete=i,s._motion=e,this._motions.pushBack(s),s._motionQueueEntryHandle}isFinished(){for(let e=this._motions.begin();e.notEqual(this._motions.end());){let t=e.ptr();if(null!=t)if(null!=t._motion){if(!t.isFinished())return!1;e.preIncrement()}else t.release(),t=void 0,t=null,e=this._motions.erase(e);else e=this._motions.erase(e)}return!0}isFinishedByHandle(e){for(let t=this._motions.begin();t.notEqual(this._motions.end());t.increment()){const i=t.ptr();if(null!=i&&i._motionQueueEntryHandle==e&&!i.isFinished())return!1}return!0}stopAllMotions(){for(let e=this._motions.begin();e.notEqual(this._motions.end());){let t=e.ptr();null!=t?(t.release(),t=void 0,t=null,e=this._motions.erase(e)):e=this._motions.erase(e)}}getCubismMotionQueueEntry(e){for(let t=this._motions.begin();t.notEqual(this._motions.end());t.preIncrement()){const i=t.ptr();if(null!=i&&i._motionQueueEntryHandle==e)return i}return null}setEventCallback(e,t=null){this._eventCallBack=e,this._eventCustomData=t}doUpdateMotion(e,t){let i=!1;for(let r=this._motions.begin();r.notEqual(this._motions.end());){let s=r.ptr();if(null==s){r=this._motions.erase(r);continue}const a=s._motion;if(null==a){s.release(),s=void 0,s=null,r=this._motions.erase(r);continue}a.updateParameters(e,s,t),i=!0;const n=a.getFiredEvent(s.getLastCheckEventSeconds()-s.getStartTime(),t-s.getStartTime());for(let e=0;e<n.getSize();++e)this._eventCallBack(this,n.at(e),this._eventCustomData);s.setLastCheckEventSeconds(t),s.isFinished()?(s.release(),s=void 0,s=null,r=this._motions.erase(r)):(s.isTriggeredFadeOut()&&s.startFadeOut(s.getFadeOutSeconds(),t),r.preIncrement())}return i}},t.InvalidMotionQueueEntryHandleValue=-1;const u=a(i(5942));var l;(l=t.Live2DCubismFramework||(t.Live2DCubismFramework={})).CubismMotionQueueManager=u.CubismMotionQueueManager,l.InvalidMotionQueueEntryHandleValue=u.InvalidMotionQueueEntryHandleValue},3137:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.Options=t.CubismPhysics=void 0;const n=i(9657),o=i(9616),u=i(834),l=i(7194),h="Angle";class d{constructor(){this._physicsRig=null,this._options=new c,this._options.gravity.y=-1,this._options.gravity.x=0,this._options.wind.x=0,this._options.wind.y=0}static create(e,t){const i=new d;return i.parse(e,t),i._physicsRig.gravity.y=0,i}static delete(e){null!=e&&(e.release(),e=null)}evaluate(e,t){let i,r,s,a;const u=new o.CubismVector2;let l,h,d,c,g,m,_,p;g=e.getModel().parameters.values,m=e.getModel().parameters.maximumValues,_=e.getModel().parameters.minimumValues,p=e.getModel().parameters.defaultValues;for(let f=0;f<this._physicsRig.subRigCount;++f){i={angle:0},u.x=0,u.y=0,l=this._physicsRig.settings.at(f),h=this._physicsRig.inputs.get(l.baseInputIndex),d=this._physicsRig.outputs.get(l.baseOutputIndex),c=this._physicsRig.particles.get(l.baseParticleIndex);for(let t=0;t<l.inputCount;++t)r=h[t].weight/100,-1==h[t].sourceParameterIndex&&(h[t].sourceParameterIndex=e.getParameterIndex(h[t].source.id)),h[t].getNormalizedParameterValue(u,i,g[h[t].sourceParameterIndex],_[h[t].sourceParameterIndex],m[h[t].sourceParameterIndex],p[h[t].sourceParameterIndex],l.normalizationPosition,l.normalizationAngle,h[t].reflect,r);s=n.CubismMath.degreesToRadian(-i.angle),u.x=u.x*n.CubismMath.cos(s)-u.y*n.CubismMath.sin(s),u.y=u.x*n.CubismMath.sin(s)+u.y*n.CubismMath.cos(s),v(c,l.particleCount,u,i.angle,this._options.wind,.001*l.normalizationPosition.maximum,t,5);for(let t=0;t<l.outputCount;++t){const i=d[t].vertexIndex;if(i<1||i>=l.particleCount)break;-1==d[t].destinationParameterIndex&&(d[t].destinationParameterIndex=e.getParameterIndex(d[t].destination.id));const r=new o.CubismVector2;r.x=c[i].position.x-c[i-1].position.x,r.y=c[i].position.y-c[i-1].position.y,a=d[t].getValue(r,c,i,d[t].reflect,this._options.gravity);const s=d[t].destinationParameterIndex,n=!Float32Array.prototype.slice&&"subarray"in Float32Array.prototype?JSON.parse(JSON.stringify(g.subarray(s))):g.slice(s);P(n,_[s],m[s],a,d[t]);for(let e=s,t=0;e<g.length;e++,t++)g[e]=n[t]}}}setOptions(e){this._options=e}getOption(){return this._options}release(){this._physicsRig=void 0,this._physicsRig=null}parse(e,t){this._physicsRig=new u.CubismPhysicsRig;let i=new l.CubismPhysicsJson(e,t);this._physicsRig.gravity=i.getGravity(),this._physicsRig.wind=i.getWind(),this._physicsRig.subRigCount=i.getSubRigCount(),this._physicsRig.settings.updateSize(this._physicsRig.subRigCount,u.CubismPhysicsSubRig,!0),this._physicsRig.inputs.updateSize(i.getTotalInputCount(),u.CubismPhysicsInput,!0),this._physicsRig.outputs.updateSize(i.getTotalOutputCount(),u.CubismPhysicsOutput,!0),this._physicsRig.particles.updateSize(i.getVertexCount(),u.CubismPhysicsParticle,!0);let r=0,s=0,a=0;for(let e=0;e<this._physicsRig.settings.getSize();++e){this._physicsRig.settings.at(e).normalizationPosition.minimum=i.getNormalizationPositionMinimumValue(e),this._physicsRig.settings.at(e).normalizationPosition.maximum=i.getNormalizationPositionMaximumValue(e),this._physicsRig.settings.at(e).normalizationPosition.defalut=i.getNormalizationPositionDefaultValue(e),this._physicsRig.settings.at(e).normalizationAngle.minimum=i.getNormalizationAngleMinimumValue(e),this._physicsRig.settings.at(e).normalizationAngle.maximum=i.getNormalizationAngleMaximumValue(e),this._physicsRig.settings.at(e).normalizationAngle.defalut=i.getNormalizationAngleDefaultValue(e),this._physicsRig.settings.at(e).inputCount=i.getInputCount(e),this._physicsRig.settings.at(e).baseInputIndex=r;for(let t=0;t<this._physicsRig.settings.at(e).inputCount;++t)this._physicsRig.inputs.at(r+t).sourceParameterIndex=-1,this._physicsRig.inputs.at(r+t).weight=i.getInputWeight(e,t),this._physicsRig.inputs.at(r+t).reflect=i.getInputReflect(e,t),"X"==i.getInputType(e,t)?(this._physicsRig.inputs.at(r+t).type=u.CubismPhysicsSource.CubismPhysicsSource_X,this._physicsRig.inputs.at(r+t).getNormalizedParameterValue=g):"Y"==i.getInputType(e,t)?(this._physicsRig.inputs.at(r+t).type=u.CubismPhysicsSource.CubismPhysicsSource_Y,this._physicsRig.inputs.at(r+t).getNormalizedParameterValue=m):i.getInputType(e,t)==h&&(this._physicsRig.inputs.at(r+t).type=u.CubismPhysicsSource.CubismPhysicsSource_Angle,this._physicsRig.inputs.at(r+t).getNormalizedParameterValue=_),this._physicsRig.inputs.at(r+t).source.targetType=u.CubismPhysicsTargetType.CubismPhysicsTargetType_Parameter,this._physicsRig.inputs.at(r+t).source.id=i.getInputSourceId(e,t);r+=this._physicsRig.settings.at(e).inputCount,this._physicsRig.settings.at(e).outputCount=i.getOutputCount(e),this._physicsRig.settings.at(e).baseOutputIndex=s;for(let t=0;t<this._physicsRig.settings.at(e).outputCount;++t)this._physicsRig.outputs.at(s+t).destinationParameterIndex=-1,this._physicsRig.outputs.at(s+t).vertexIndex=i.getOutputVertexIndex(e,t),this._physicsRig.outputs.at(s+t).angleScale=i.getOutputAngleScale(e,t),this._physicsRig.outputs.at(s+t).weight=i.getOutputWeight(e,t),this._physicsRig.outputs.at(s+t).destination.targetType=u.CubismPhysicsTargetType.CubismPhysicsTargetType_Parameter,this._physicsRig.outputs.at(s+t).destination.id=i.getOutputDestinationId(e,t),"X"==i.getOutputType(e,t)?(this._physicsRig.outputs.at(s+t).type=u.CubismPhysicsSource.CubismPhysicsSource_X,this._physicsRig.outputs.at(s+t).getValue=p,this._physicsRig.outputs.at(s+t).getScale=b):"Y"==i.getOutputType(e,t)?(this._physicsRig.outputs.at(s+t).type=u.CubismPhysicsSource.CubismPhysicsSource_Y,this._physicsRig.outputs.at(s+t).getValue=f,this._physicsRig.outputs.at(s+t).getScale=S):i.getOutputType(e,t)==h&&(this._physicsRig.outputs.at(s+t).type=u.CubismPhysicsSource.CubismPhysicsSource_Angle,this._physicsRig.outputs.at(s+t).getValue=y,this._physicsRig.outputs.at(s+t).getScale=C),this._physicsRig.outputs.at(s+t).reflect=i.getOutputReflect(e,t);s+=this._physicsRig.settings.at(e).outputCount,this._physicsRig.settings.at(e).particleCount=i.getParticleCount(e),this._physicsRig.settings.at(e).baseParticleIndex=a;for(let t=0;t<this._physicsRig.settings.at(e).particleCount;++t)this._physicsRig.particles.at(a+t).mobility=i.getParticleMobility(e,t),this._physicsRig.particles.at(a+t).delay=i.getParticleDelay(e,t),this._physicsRig.particles.at(a+t).acceleration=i.getParticleAcceleration(e,t),this._physicsRig.particles.at(a+t).radius=i.getParticleRadius(e,t),this._physicsRig.particles.at(a+t).position=i.getParticlePosition(e,t);a+=this._physicsRig.settings.at(e).particleCount}this.initialize(),i.release(),i=void 0,i=null}initialize(){let e,t,i;for(let r=0;r<this._physicsRig.subRigCount;++r){t=this._physicsRig.settings.at(r),e=this._physicsRig.particles.get(t.baseParticleIndex),e[0].initialPosition=new o.CubismVector2(0,0),e[0].lastPosition=new o.CubismVector2(e[0].initialPosition.x,e[0].initialPosition.y),e[0].lastGravity=new o.CubismVector2(0,-1),e[0].lastGravity.y*=-1,e[0].velocity=new o.CubismVector2(0,0),e[0].force=new o.CubismVector2(0,0);for(let r=1;r<t.particleCount;++r)i=new o.CubismVector2(0,0),i.y=e[r].radius,e[r].initialPosition=new o.CubismVector2(e[r-1].initialPosition.x+i.x,e[r-1].initialPosition.y+i.y),e[r].position=new o.CubismVector2(e[r].initialPosition.x,e[r].initialPosition.y),e[r].lastPosition=new o.CubismVector2(e[r].initialPosition.x,e[r].initialPosition.y),e[r].lastGravity=new o.CubismVector2(0,-1),e[r].lastGravity.y*=-1,e[r].velocity=new o.CubismVector2(0,0),e[r].force=new o.CubismVector2(0,0)}}}t.CubismPhysics=d;class c{constructor(){this.gravity=new o.CubismVector2(0,0),this.wind=new o.CubismVector2(0,0)}}function g(e,t,i,r,s,a,n,o,u,l){e.x+=M(i,r,s,0,n.minimum,n.maximum,n.defalut,u)*l}function m(e,t,i,r,s,a,n,o,u,l){e.y+=M(i,r,s,0,n.minimum,n.maximum,n.defalut,u)*l}function _(e,t,i,r,s,a,n,o,u,l){t.angle+=M(i,r,s,0,o.minimum,o.maximum,o.defalut,u)*l}function p(e,t,i,r,s){let a=e.x;return r&&(a*=-1),a}function f(e,t,i,r,s){let a=e.y;return r&&(a*=-1),a}function y(e,t,i,r,s){let a;return s=i>=2?t[i-1].position.substract(t[i-2].position):s.multiplyByScaler(-1),a=n.CubismMath.directionToRadian(s,e),r&&(a*=-1),a}function b(e,t){return JSON.parse(JSON.stringify(e.x))}function S(e,t){return JSON.parse(JSON.stringify(e.y))}function C(e,t){return JSON.parse(JSON.stringify(t))}function v(e,t,i,r,s,a,u,l){let h,d,c,g,m=new o.CubismVector2(0,0),_=new o.CubismVector2(0,0),p=new o.CubismVector2(0,0),f=new o.CubismVector2(0,0);e[0].position=new o.CubismVector2(i.x,i.y),h=n.CubismMath.degreesToRadian(r),g=n.CubismMath.radianToDirection(h),g.normalize();for(let i=1;i<t;++i)e[i].force=g.multiplyByScaler(e[i].acceleration).add(s),e[i].lastPosition=new o.CubismVector2(e[i].position.x,e[i].position.y),d=e[i].delay*u*30,m=e[i].position.substract(e[i-1].position),c=n.CubismMath.directionToRadian(e[i].lastGravity,g)/l,m.x=n.CubismMath.cos(c)*m.x-m.y*n.CubismMath.sin(c),m.y=n.CubismMath.sin(c)*m.x+m.y*n.CubismMath.cos(c),e[i].position=e[i-1].position.add(m),_=e[i].velocity.multiplyByScaler(d),p=e[i].force.multiplyByScaler(d).multiplyByScaler(d),e[i].position=e[i].position.add(_).add(p),f=e[i].position.substract(e[i-1].position),f.normalize(),e[i].position=e[i-1].position.add(f.multiplyByScaler(e[i].radius)),n.CubismMath.abs(e[i].position.x)<a&&(e[i].position.x=0),0!=d&&(e[i].velocity=e[i].position.substract(e[i].lastPosition),e[i].velocity=e[i].velocity.divisionByScalar(d),e[i].velocity=e[i].velocity.multiplyByScaler(e[i].mobility)),e[i].force=new o.CubismVector2(0,0),e[i].lastGravity=new o.CubismVector2(g.x,g.y)}function P(e,t,i,r,s){let a,n,o;a=s.getScale(s.translationScale,s.angleScale),n=r*a,n<t?(n<s.valueBelowMinimum&&(s.valueBelowMinimum=n),n=t):n>i&&(n>s.valueExceededMaximum&&(s.valueExceededMaximum=n),n=i),o=s.weight/100,o>=1||(n=e[0]*(1-o)+n*o),e[0]=n}function M(e,t,i,r,s,a,o,u){let l=0;const h=n.CubismMath.max(i,t);h<e&&(e=h);const d=n.CubismMath.min(i,t);d>e&&(e=d);const c=n.CubismMath.min(s,a),g=n.CubismMath.max(s,a),m=o,_=(f=d,y=h,n.CubismMath.min(f,y)+function(e,t){const i=n.CubismMath.max(e,t),r=n.CubismMath.min(e,t);return n.CubismMath.abs(i-r)}(f,y)/2),p=e-_;var f,y;switch(function(e){let t=0;return e>0?t=1:e<0&&(t=-1),t}(p)){case 1:{const e=g-m,t=h-_;0!=t&&(l=p*(e/t),l+=m);break}case-1:{const e=c-m,t=d-_;0!=t&&(l=p*(e/t),l+=m);break}case 0:l=m}return u?l:-1*l}t.Options=c;const x=a(i(3137));var B;(B=t.Live2DCubismFramework||(t.Live2DCubismFramework={})).CubismPhysics=x.CubismPhysics,B.Options=x.Options},834:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.CubismPhysicsRig=t.CubismPhysicsOutput=t.CubismPhysicsInput=t.CubismPhysicsSubRig=t.CubismPhysicsParticle=t.CubismPhysicsNormalization=t.CubismPhysicsParameter=t.PhysicsJsonEffectiveForces=t.CubismPhysicsSource=t.CubismPhysicsTargetType=void 0;const n=i(9616),o=i(6486);var u,l;(l=t.CubismPhysicsTargetType||(t.CubismPhysicsTargetType={}))[l.CubismPhysicsTargetType_Parameter=0]="CubismPhysicsTargetType_Parameter",(u=t.CubismPhysicsSource||(t.CubismPhysicsSource={}))[u.CubismPhysicsSource_X=0]="CubismPhysicsSource_X",u[u.CubismPhysicsSource_Y=1]="CubismPhysicsSource_Y",u[u.CubismPhysicsSource_Angle=2]="CubismPhysicsSource_Angle",t.PhysicsJsonEffectiveForces=class{constructor(){this.gravity=new n.CubismVector2(0,0),this.wind=new n.CubismVector2(0,0)}};class h{}t.CubismPhysicsParameter=h;class d{}t.CubismPhysicsNormalization=d,t.CubismPhysicsParticle=class{constructor(){this.initialPosition=new n.CubismVector2(0,0),this.position=new n.CubismVector2(0,0),this.lastPosition=new n.CubismVector2(0,0),this.lastGravity=new n.CubismVector2(0,0),this.force=new n.CubismVector2(0,0),this.velocity=new n.CubismVector2(0,0)}},t.CubismPhysicsSubRig=class{constructor(){this.normalizationPosition=new d,this.normalizationAngle=new d}},t.CubismPhysicsInput=class{constructor(){this.source=new h}},t.CubismPhysicsOutput=class{constructor(){this.destination=new h,this.translationScale=new n.CubismVector2(0,0)}},t.CubismPhysicsRig=class{constructor(){this.settings=new o.csmVector,this.inputs=new o.csmVector,this.outputs=new o.csmVector,this.particles=new o.csmVector,this.gravity=new n.CubismVector2(0,0),this.wind=new n.CubismVector2(0,0)}};const c=a(i(834));var g;(g=t.Live2DCubismFramework||(t.Live2DCubismFramework={})).CubismPhysicsInput=c.CubismPhysicsInput,g.CubismPhysicsNormalization=c.CubismPhysicsNormalization,g.CubismPhysicsOutput=c.CubismPhysicsOutput,g.CubismPhysicsParameter=c.CubismPhysicsParameter,g.CubismPhysicsParticle=c.CubismPhysicsParticle,g.CubismPhysicsRig=c.CubismPhysicsRig,g.CubismPhysicsSource=c.CubismPhysicsSource,g.CubismPhysicsSubRig=c.CubismPhysicsSubRig,g.CubismPhysicsTargetType=c.CubismPhysicsTargetType,g.PhysicsJsonEffectiveForces=c.PhysicsJsonEffectiveForces},7194:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.CubismPhysicsJson=void 0;const n=i(8871),o=i(9616),u=i(4462),l="Position",h="Angle",d="Type",c="Meta",g="EffectiveForces",m="Gravity",_="Wind",p="PhysicsSettings",f="Normalization",y="Minimum",b="Maximum",S="Default",C="Reflect",v="Weight",P="Input",M="Output",x="Vertices";t.CubismPhysicsJson=class{constructor(e,t){this._json=u.CubismJson.create(e,t)}release(){u.CubismJson.delete(this._json)}getGravity(){const e=new o.CubismVector2(0,0);return e.x=this._json.getRoot().getValueByString(c).getValueByString(g).getValueByString(m).getValueByString("X").toFloat(),e.y=this._json.getRoot().getValueByString(c).getValueByString(g).getValueByString(m).getValueByString("Y").toFloat(),e}getWind(){const e=new o.CubismVector2(0,0);return e.x=this._json.getRoot().getValueByString(c).getValueByString(g).getValueByString(_).getValueByString("X").toFloat(),e.y=this._json.getRoot().getValueByString(c).getValueByString(g).getValueByString(_).getValueByString("Y").toFloat(),e}getSubRigCount(){return this._json.getRoot().getValueByString(c).getValueByString("PhysicsSettingCount").toInt()}getTotalInputCount(){return this._json.getRoot().getValueByString(c).getValueByString("TotalInputCount").toInt()}getTotalOutputCount(){return this._json.getRoot().getValueByString(c).getValueByString("TotalOutputCount").toInt()}getVertexCount(){return this._json.getRoot().getValueByString(c).getValueByString("VertexCount").toInt()}getNormalizationPositionMinimumValue(e){return this._json.getRoot().getValueByString(p).getValueByIndex(e).getValueByString(f).getValueByString(l).getValueByString(y).toFloat()}getNormalizationPositionMaximumValue(e){return this._json.getRoot().getValueByString(p).getValueByIndex(e).getValueByString(f).getValueByString(l).getValueByString(b).toFloat()}getNormalizationPositionDefaultValue(e){return this._json.getRoot().getValueByString(p).getValueByIndex(e).getValueByString(f).getValueByString(l).getValueByString(S).toFloat()}getNormalizationAngleMinimumValue(e){return this._json.getRoot().getValueByString(p).getValueByIndex(e).getValueByString(f).getValueByString(h).getValueByString(y).toFloat()}getNormalizationAngleMaximumValue(e){return this._json.getRoot().getValueByString(p).getValueByIndex(e).getValueByString(f).getValueByString(h).getValueByString(b).toFloat()}getNormalizationAngleDefaultValue(e){return this._json.getRoot().getValueByString(p).getValueByIndex(e).getValueByString(f).getValueByString(h).getValueByString(S).toFloat()}getInputCount(e){return this._json.getRoot().getValueByString(p).getValueByIndex(e).getValueByString(P).getVector().getSize()}getInputWeight(e,t){return this._json.getRoot().getValueByString(p).getValueByIndex(e).getValueByString(P).getValueByIndex(t).getValueByString(v).toFloat()}getInputReflect(e,t){return this._json.getRoot().getValueByString(p).getValueByIndex(e).getValueByString(P).getValueByIndex(t).getValueByString(C).toBoolean()}getInputType(e,t){return this._json.getRoot().getValueByString(p).getValueByIndex(e).getValueByString(P).getValueByIndex(t).getValueByString(d).getRawString()}getInputSourceId(e,t){return n.CubismFramework.getIdManager().getId(this._json.getRoot().getValueByString(p).getValueByIndex(e).getValueByString(P).getValueByIndex(t).getValueByString("Source").getValueByString("Id").getRawString())}getOutputCount(e){return this._json.getRoot().getValueByString(p).getValueByIndex(e).getValueByString(M).getVector().getSize()}getOutputVertexIndex(e,t){return this._json.getRoot().getValueByString(p).getValueByIndex(e).getValueByString(M).getValueByIndex(t).getValueByString("VertexIndex").toInt()}getOutputAngleScale(e,t){return this._json.getRoot().getValueByString(p).getValueByIndex(e).getValueByString(M).getValueByIndex(t).getValueByString("Scale").toFloat()}getOutputWeight(e,t){return this._json.getRoot().getValueByString(p).getValueByIndex(e).getValueByString(M).getValueByIndex(t).getValueByString(v).toFloat()}getOutputDestinationId(e,t){return n.CubismFramework.getIdManager().getId(this._json.getRoot().getValueByString(p).getValueByIndex(e).getValueByString(M).getValueByIndex(t).getValueByString("Destination").getValueByString("Id").getRawString())}getOutputType(e,t){return this._json.getRoot().getValueByString(p).getValueByIndex(e).getValueByString(M).getValueByIndex(t).getValueByString(d).getRawString()}getOutputReflect(e,t){return this._json.getRoot().getValueByString(p).getValueByIndex(e).getValueByString(M).getValueByIndex(t).getValueByString(C).toBoolean()}getParticleCount(e){return this._json.getRoot().getValueByString(p).getValueByIndex(e).getValueByString(x).getVector().getSize()}getParticleMobility(e,t){return this._json.getRoot().getValueByString(p).getValueByIndex(e).getValueByString(x).getValueByIndex(t).getValueByString("Mobility").toFloat()}getParticleDelay(e,t){return this._json.getRoot().getValueByString(p).getValueByIndex(e).getValueByString(x).getValueByIndex(t).getValueByString("Delay").toFloat()}getParticleAcceleration(e,t){return this._json.getRoot().getValueByString(p).getValueByIndex(e).getValueByString(x).getValueByIndex(t).getValueByString("Acceleration").toFloat()}getParticleRadius(e,t){return this._json.getRoot().getValueByString(p).getValueByIndex(e).getValueByString(x).getValueByIndex(t).getValueByString("Radius").toFloat()}getParticlePosition(e,t){const i=new o.CubismVector2(0,0);return i.x=this._json.getRoot().getValueByString(p).getValueByIndex(e).getValueByString(x).getValueByIndex(t).getValueByString(l).getValueByString("X").toFloat(),i.y=this._json.getRoot().getValueByString(p).getValueByIndex(e).getValueByString(x).getValueByIndex(t).getValueByString(l).getValueByString("Y").toFloat(),i}};const B=a(i(7194));(t.Live2DCubismFramework||(t.Live2DCubismFramework={})).CubismPhysicsJson=B.CubismPhysicsJson},3006:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.CubismTextureColor=t.CubismBlendMode=t.CubismRenderer=void 0;const n=i(8904);var o;t.CubismRenderer=class{constructor(){this._isCulling=!1,this._isPremultipliedAlpha=!1,this._anisortopy=0,this._model=null,this._modelColor=new u,this._mvpMatrix4x4=new n.CubismMatrix44,this._mvpMatrix4x4.loadIdentity()}static create(){return null}static delete(e){}initialize(e){this._model=e}drawModel(){null!=this.getModel()&&this.doDrawModel()}setMvpMatrix(e){this._mvpMatrix4x4.setMatrix(e.getArray())}getMvpMatrix(){return this._mvpMatrix4x4}setModelColor(e,t,i,r){e<0?e=0:e>1&&(e=1),t<0?t=0:t>1&&(t=1),i<0?i=0:i>1&&(i=1),r<0?r=0:r>1&&(r=1),this._modelColor.R=e,this._modelColor.G=t,this._modelColor.B=i,this._modelColor.A=r}getModelColor(){return JSON.parse(JSON.stringify(this._modelColor))}setIsPremultipliedAlpha(e){this._isPremultipliedAlpha=e}isPremultipliedAlpha(){return this._isPremultipliedAlpha}setIsCulling(e){this._isCulling=e}isCulling(){return this._isCulling}setAnisotropy(e){this._anisortopy=e}getAnisotropy(){return this._anisortopy}getModel(){return this._model}},(o=t.CubismBlendMode||(t.CubismBlendMode={}))[o.CubismBlendMode_Normal=0]="CubismBlendMode_Normal",o[o.CubismBlendMode_Additive=1]="CubismBlendMode_Additive",o[o.CubismBlendMode_Multiplicative=2]="CubismBlendMode_Multiplicative";class u{constructor(){this.R=1,this.G=1,this.B=1,this.A=1}}t.CubismTextureColor=u;const l=a(i(3006));var h;(h=t.Live2DCubismFramework||(t.Live2DCubismFramework={})).CubismBlendMode=l.CubismBlendMode,h.CubismRenderer=l.CubismRenderer,h.CubismTextureColor=l.CubismTextureColor},5137:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.CubismRenderer_WebGL=t.FS_ex=t.fragmentShaderSrcMaskInvertedPremultipliedAlpha=t.fragmentShaderSrcMaskPremultipliedAlpha=t.fragmentShaderSrcPremultipliedAlpha=t.vertexShaderSrcMasked=t.vertexShaderSrc=t.fragmentShaderSrcsetupMask=t.vertexShaderSrcSetupMask=t.ShaderNames=t.CubismShaderSet=t.CubismShader_WebGL=t.CubismClippingContext=t.CubismRenderTextureResource=t.CubismClippingManager_WebGL=void 0;const n=i(8871),o=i(8904),u=i(1349),l=i(9045),h=i(7686),d=i(6486),c=i(1201),g=i(3006);let m,_,p;class f{constructor(){this._maskRenderTexture=null,this._colorBuffer=null,this._currentFrameNo=0,this._clippingMaskBufferSize=256,this._clippingContextListForMask=new d.csmVector,this._clippingContextListForDraw=new d.csmVector,this._channelColors=new d.csmVector,this._tmpBoundsOnModel=new h.csmRect,this._tmpMatrix=new o.CubismMatrix44,this._tmpMatrixForMask=new o.CubismMatrix44,this._tmpMatrixForDraw=new o.CubismMatrix44,this._maskTexture=null;let e=new g.CubismTextureColor;e.R=1,e.G=0,e.B=0,e.A=0,this._channelColors.pushBack(e),e=new g.CubismTextureColor,e.R=0,e.G=1,e.B=0,e.A=0,this._channelColors.pushBack(e),e=new g.CubismTextureColor,e.R=0,e.G=0,e.B=1,e.A=0,this._channelColors.pushBack(e),e=new g.CubismTextureColor,e.R=0,e.G=0,e.B=0,e.A=1,this._channelColors.pushBack(e)}getChannelFlagAsColor(e){return this._channelColors.at(e)}getMaskRenderTexture(){let e=0;if(this._maskTexture&&0!=this._maskTexture.texture&&(this._maskTexture.frameNo=this._currentFrameNo,e=this._maskTexture.texture),0==e){const t=this._clippingMaskBufferSize;this._colorBuffer=this.gl.createTexture(),this.gl.bindTexture(this.gl.TEXTURE_2D,this._colorBuffer),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,t,t,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.bindTexture(this.gl.TEXTURE_2D,null),e=this.gl.createFramebuffer(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,e),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,this._colorBuffer,0),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,p),this._maskTexture=new y(this._currentFrameNo,e)}return e}setGL(e){this.gl=e}calcClippedDrawTotalBounds(e,t){let i=Number.MAX_VALUE,r=Number.MAX_VALUE,s=Number.MIN_VALUE,a=Number.MIN_VALUE;const o=t._clippedDrawableIndexList.length;for(let u=0;u<o;u++){const o=t._clippedDrawableIndexList[u],l=e.getDrawableVertexCount(o),h=e.getDrawableVertices(o);let d=Number.MAX_VALUE,c=Number.MAX_VALUE,g=Number.MIN_VALUE,m=Number.MIN_VALUE;const _=l*n.Constant.vertexStep;for(let e=n.Constant.vertexOffset;e<_;e+=n.Constant.vertexStep){const t=h[e],i=h[e+1];t<d&&(d=t),t>g&&(g=t),i<c&&(c=i),i>m&&(m=i)}if(d!=Number.MAX_VALUE)if(d<i&&(i=d),c<r&&(r=c),g>s&&(s=g),m>a&&(a=m),i==Number.MAX_VALUE)t._allClippedDrawRect.x=0,t._allClippedDrawRect.y=0,t._allClippedDrawRect.width=0,t._allClippedDrawRect.height=0,t._isUsing=!1;else{t._isUsing=!0;const e=s-i,n=a-r;t._allClippedDrawRect.x=i,t._allClippedDrawRect.y=r,t._allClippedDrawRect.width=e,t._allClippedDrawRect.height=n}}}release(){for(let e=0;e<this._clippingContextListForMask.getSize();e++)this._clippingContextListForMask.at(e)&&(this._clippingContextListForMask.at(e).release(),this._clippingContextListForMask.set(e,void 0)),this._clippingContextListForMask.set(e,null);this._clippingContextListForMask=null;for(let e=0;e<this._clippingContextListForDraw.getSize();e++)this._clippingContextListForDraw.set(e,null);this._clippingContextListForDraw=null,this._maskTexture&&(this.gl.deleteFramebuffer(this._maskTexture.texture),this._maskTexture=null);for(let e=0;e<this._channelColors.getSize();e++)this._channelColors.set(e,null);this._channelColors=null,this.gl.deleteTexture(this._colorBuffer),this._colorBuffer=null}initialize(e,t,i,r){for(let e=0;e<t;e++){if(r[e]<=0){this._clippingContextListForDraw.pushBack(null);continue}let t=this.findSameClip(i[e],r[e]);null==t&&(t=new b(this,i[e],r[e]),this._clippingContextListForMask.pushBack(t)),t.addClippedDrawable(e),this._clippingContextListForDraw.pushBack(t)}}setupClippingContext(e,t){this._currentFrameNo++;let i=0;for(let t=0;t<this._clippingContextListForMask.getSize();t++){const r=this._clippingContextListForMask.at(t);this.calcClippedDrawTotalBounds(e,r),r._isUsing&&i++}if(i>0){this.gl.viewport(0,0,this._clippingMaskBufferSize,this._clippingMaskBufferSize),this._maskRenderTexture=this.getMaskRenderTexture(),t.getMvpMatrix(),t.preDraw(),this.setupLayoutBounds(i),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this._maskRenderTexture),this.gl.clearColor(1,1,1,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT);for(let i=0;i<this._clippingContextListForMask.getSize();i++){const r=this._clippingContextListForMask.at(i),s=r._allClippedDrawRect,a=r._layoutBounds,n=.05;this._tmpBoundsOnModel.setRect(s),this._tmpBoundsOnModel.expand(s.width*n,s.height*n);const o=a.width/this._tmpBoundsOnModel.width,u=a.height/this._tmpBoundsOnModel.height;this._tmpMatrix.loadIdentity(),this._tmpMatrix.translateRelative(-1,-1),this._tmpMatrix.scaleRelative(2,2),this._tmpMatrix.translateRelative(a.x,a.y),this._tmpMatrix.scaleRelative(o,u),this._tmpMatrix.translateRelative(-this._tmpBoundsOnModel.x,-this._tmpBoundsOnModel.y),this._tmpMatrixForMask.setMatrix(this._tmpMatrix.getArray()),this._tmpMatrix.loadIdentity(),this._tmpMatrix.translateRelative(a.x,a.y),this._tmpMatrix.scaleRelative(o,u),this._tmpMatrix.translateRelative(-this._tmpBoundsOnModel.x,-this._tmpBoundsOnModel.y),this._tmpMatrixForDraw.setMatrix(this._tmpMatrix.getArray()),r._matrixForMask.setMatrix(this._tmpMatrixForMask.getArray()),r._matrixForDraw.setMatrix(this._tmpMatrixForDraw.getArray());const l=r._clippingIdCount;for(let i=0;i<l;i++){const s=r._clippingIdList[i];e.getDrawableDynamicFlagVertexPositionsDidChange(s)&&(t.setIsCulling(0!=e.getDrawableCulling(s)),t.setClippingContextBufferForMask(r),t.drawMesh(e.getDrawableTextureIndices(s),e.getDrawableVertexIndexCount(s),e.getDrawableVertexCount(s),e.getDrawableVertexIndices(s),e.getDrawableVertices(s),e.getDrawableVertexUvs(s),e.getDrawableOpacity(s),g.CubismBlendMode.CubismBlendMode_Normal,!1,-1,null))}}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,p),t.setClippingContextBufferForMask(null),this.gl.viewport(_[0],_[1],_[2],_[3])}}findSameClip(e,t){for(let i=0;i<this._clippingContextListForMask.getSize();i++){const r=this._clippingContextListForMask.at(i),s=r._clippingIdCount;if(s!=t)continue;let a=0;for(let t=0;t<s;t++){const i=r._clippingIdList[t];for(let t=0;t<s;t++)if(e[t]==i){a++;break}}if(a==s)return r}return null}setupLayoutBounds(e){let t=e/4,i=e%4;t=~~t,i=~~i;let r=0;for(let e=0;e<4;e++){const s=t+(e<i?1:0);if(0==s);else if(1==s){const t=this._clippingContextListForMask.at(r++);t._layoutChannelNo=e,t._layoutBounds.x=0,t._layoutBounds.y=0,t._layoutBounds.width=1,t._layoutBounds.height=1}else if(2==s)for(let t=0;t<s;t++){let i=t%2;i=~~i;const s=this._clippingContextListForMask.at(r++);s._layoutChannelNo=e,s._layoutBounds.x=.5*i,s._layoutBounds.y=0,s._layoutBounds.width=.5,s._layoutBounds.height=1}else if(s<=4)for(let t=0;t<s;t++){let i=t%2,s=t/2;i=~~i,s=~~s;const a=this._clippingContextListForMask.at(r++);a._layoutChannelNo=e,a._layoutBounds.x=.5*i,a._layoutBounds.y=.5*s,a._layoutBounds.width=.5,a._layoutBounds.height=.5}else if(s<=9)for(let t=0;t<s;t++){let i=t%3,s=t/3;i=~~i,s=~~s;const a=this._clippingContextListForMask.at(r++);a._layoutChannelNo=e,a._layoutBounds.x=i/3,a._layoutBounds.y=s/3,a._layoutBounds.width=1/3,a._layoutBounds.height=1/3}else c.CubismLogError("not supported mask count : {0}",s)}}getColorBuffer(){return this._colorBuffer}getClippingContextListForDraw(){return this._clippingContextListForDraw}setClippingMaskBufferSize(e){this._clippingMaskBufferSize=e}getClippingMaskBufferSize(){return this._clippingMaskBufferSize}}t.CubismClippingManager_WebGL=f;class y{constructor(e,t){this.frameNo=e,this.texture=t}}t.CubismRenderTextureResource=y;class b{constructor(e,t,i){this._owner=e,this._clippingIdList=t,this._clippingIdCount=i,this._allClippedDrawRect=new h.csmRect,this._layoutBounds=new h.csmRect,this._clippedDrawableIndexList=[],this._matrixForMask=new o.CubismMatrix44,this._matrixForDraw=new o.CubismMatrix44}release(){null!=this._layoutBounds&&(this._layoutBounds=null),null!=this._allClippedDrawRect&&(this._allClippedDrawRect=null),null!=this._clippedDrawableIndexList&&(this._clippedDrawableIndexList=null)}addClippedDrawable(e){this._clippedDrawableIndexList.push(e)}getClippingManager(){return this._owner}setGl(e){this._owner.setGL(e)}}t.CubismClippingContext=b;class S{constructor(){this._shaderSets=new d.csmVector,this.exShaderSets=new d.csmVector}static getInstance(){return null==m?(m=new S,m):m}static deleteInstance(){m&&(m.release(),m=null)}release(){this.releaseShaderProgram()}setupShaderProgram(e,i,r,s,a,n,o,l,h,d,m,_,p,f,y){if(m||c.CubismLogError("NoPremultipliedAlpha is not allowed"),0==this._shaderSets.getSize()&&this.generateShaders(),0==this.exShaderSets.getSize()){var b=new u.ExShaderLoadInfo(t.FS_ex);this.GenerateExShaders([b])}let S,P,M,x;if(null!=e.getClippingContextBufferForMask()){var B=this._shaderSets.at(v.ShaderNames_SetupMask);f>=0&&f<=this.exShaderSets._size-1?(B=this.exShaderSets.at(f),this.gl.useProgram(B.shaderProgram),this.gl.uniform1f(B.uniformTimeLocation,y.time),this.gl.uniform2f(B.uniformResoulutionLocation,y.resolution_x,y.resolution_y),this.gl.uniform2f(B.uniformMousePosLocation,y.mousePos_x,y.mousePos_y)):this.gl.useProgram(B.shaderProgram),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.uniform1i(B.samplerTexture0Location,0),null==o.vertex&&(o.vertex=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,o.vertex),this.gl.bufferData(this.gl.ARRAY_BUFFER,s,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(B.attributePositionLocation),this.gl.vertexAttribPointer(B.attributePositionLocation,2,this.gl.FLOAT,!1,0,0),null==o.uv&&(o.uv=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,o.uv),this.gl.bufferData(this.gl.ARRAY_BUFFER,n,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(B.attributeTexCoordLocation),this.gl.vertexAttribPointer(B.attributeTexCoordLocation,2,this.gl.FLOAT,!1,0,0);const t=e.getClippingContextBufferForMask()._layoutChannelNo,r=e.getClippingContextBufferForMask().getClippingManager().getChannelFlagAsColor(t);this.gl.uniform4f(B.uniformChannelFlagLocation,r.R,r.G,r.B,r.A),this.gl.uniformMatrix4fv(B.uniformClipMatrixLocation,!1,e.getClippingContextBufferForMask()._matrixForMask.getArray());const a=e.getClippingContextBufferForMask()._layoutBounds;this.gl.uniform4f(B.uniformBaseColorLocation,2*a.x-1,2*a.y-1,2*a.getRight()-1,2*a.getBottom()-1),S=this.gl.ZERO,P=this.gl.ONE_MINUS_SRC_COLOR,M=this.gl.ZERO,x=this.gl.ONE_MINUS_SRC_ALPHA}else{const t=null!=e.getClippingContextBufferForDraw(),r=t?p?2:1:0;let a=new C;switch(h){case g.CubismBlendMode.CubismBlendMode_Normal:default:a=this._shaderSets.at(v.ShaderNames_NormalPremultipliedAlpha+r),S=this.gl.ONE,P=this.gl.ONE_MINUS_SRC_ALPHA,M=this.gl.ONE,x=this.gl.ONE_MINUS_SRC_ALPHA;break;case g.CubismBlendMode.CubismBlendMode_Additive:a=this._shaderSets.at(v.ShaderNames_AddPremultipliedAlpha+r),S=this.gl.ONE,P=this.gl.ONE,M=this.gl.ZERO,x=this.gl.ONE;break;case g.CubismBlendMode.CubismBlendMode_Multiplicative:a=this._shaderSets.at(v.ShaderNames_MultPremultipliedAlpha+r),S=this.gl.DST_COLOR,P=this.gl.ONE_MINUS_SRC_ALPHA,M=this.gl.ZERO,x=this.gl.ONE}if(f>=0&&f<=this.exShaderSets._size-1?(a=this.exShaderSets.at(f),this.gl.useProgram(a.shaderProgram),this.gl.uniform1f(a.uniformTimeLocation,y.time),this.gl.uniform2f(a.uniformResoulutionLocation,y.resolution_x,y.resolution_y),this.gl.uniform2f(a.uniformMousePosLocation,y.mousePos_x,y.mousePos_y)):this.gl.useProgram(a.shaderProgram),null==o.vertex&&(o.vertex=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,o.vertex),this.gl.bufferData(this.gl.ARRAY_BUFFER,s,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(a.attributePositionLocation),this.gl.vertexAttribPointer(a.attributePositionLocation,2,this.gl.FLOAT,!1,0,0),null==o.uv&&(o.uv=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,o.uv),this.gl.bufferData(this.gl.ARRAY_BUFFER,n,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(a.attributeTexCoordLocation),this.gl.vertexAttribPointer(a.attributeTexCoordLocation,2,this.gl.FLOAT,!1,0,0),t){this.gl.activeTexture(this.gl.TEXTURE1);const t=e.getClippingContextBufferForDraw().getClippingManager().getColorBuffer();this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.uniform1i(a.samplerTexture1Location,1),this.gl.uniformMatrix4fv(a.uniformClipMatrixLocation,!1,e.getClippingContextBufferForDraw()._matrixForDraw.getArray());const i=e.getClippingContextBufferForDraw()._layoutChannelNo,r=e.getClippingContextBufferForDraw().getClippingManager().getChannelFlagAsColor(i);this.gl.uniform4f(a.uniformChannelFlagLocation,r.R,r.G,r.B,r.A)}this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.uniform1i(a.samplerTexture0Location,0),this.gl.uniformMatrix4fv(a.uniformMatrixLocation,!1,_.getArray()),this.gl.uniform4f(a.uniformBaseColorLocation,d.R,d.G,d.B,d.A)}null==o.index&&(o.index=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,o.index),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,a,this.gl.DYNAMIC_DRAW),this.gl.blendFuncSeparate(S,P,M,x)}releaseShaderProgram(){for(let e=0;e<this._shaderSets.getSize();e++)this.gl.deleteProgram(this._shaderSets.at(e).shaderProgram),this._shaderSets.at(e).shaderProgram=0,this._shaderSets.set(e,void 0),this._shaderSets.set(e,null)}generateShaders(){for(let e=0;e<10;e++)this._shaderSets.pushBack(new C);this._shaderSets.at(0).shaderProgram=this.loadShaderProgram(t.vertexShaderSrcSetupMask,t.fragmentShaderSrcsetupMask),this._shaderSets.at(1).shaderProgram=this.loadShaderProgram(t.vertexShaderSrc,t.fragmentShaderSrcPremultipliedAlpha),this._shaderSets.at(2).shaderProgram=this.loadShaderProgram(t.vertexShaderSrcMasked,t.fragmentShaderSrcMaskPremultipliedAlpha),this._shaderSets.at(3).shaderProgram=this.loadShaderProgram(t.vertexShaderSrcMasked,t.fragmentShaderSrcMaskInvertedPremultipliedAlpha),this._shaderSets.at(4).shaderProgram=this._shaderSets.at(1).shaderProgram,this._shaderSets.at(5).shaderProgram=this._shaderSets.at(2).shaderProgram,this._shaderSets.at(6).shaderProgram=this._shaderSets.at(3).shaderProgram,this._shaderSets.at(7).shaderProgram=this._shaderSets.at(1).shaderProgram,this._shaderSets.at(8).shaderProgram=this._shaderSets.at(2).shaderProgram,this._shaderSets.at(9).shaderProgram=this._shaderSets.at(3).shaderProgram,this._shaderSets.at(0).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(0).shaderProgram,"a_position"),this._shaderSets.at(0).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(0).shaderProgram,"a_texCoord"),this._shaderSets.at(0).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"s_texture0"),this._shaderSets.at(0).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"u_clipMatrix"),this._shaderSets.at(0).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"u_channelFlag"),this._shaderSets.at(0).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"u_baseColor"),this._shaderSets.at(1).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(1).shaderProgram,"a_position"),this._shaderSets.at(1).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(1).shaderProgram,"a_texCoord"),this._shaderSets.at(1).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(1).shaderProgram,"s_texture0"),this._shaderSets.at(1).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(1).shaderProgram,"u_matrix"),this._shaderSets.at(1).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(1).shaderProgram,"u_baseColor"),this._shaderSets.at(2).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(2).shaderProgram,"a_position"),this._shaderSets.at(2).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(2).shaderProgram,"a_texCoord"),this._shaderSets.at(2).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"s_texture0"),this._shaderSets.at(2).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"s_texture1"),this._shaderSets.at(2).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_matrix"),this._shaderSets.at(2).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_clipMatrix"),this._shaderSets.at(2).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_channelFlag"),this._shaderSets.at(2).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_baseColor"),this._shaderSets.at(3).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(3).shaderProgram,"a_position"),this._shaderSets.at(3).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(3).shaderProgram,"a_texCoord"),this._shaderSets.at(3).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"s_texture0"),this._shaderSets.at(3).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"s_texture1"),this._shaderSets.at(3).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_matrix"),this._shaderSets.at(3).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_clipMatrix"),this._shaderSets.at(3).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_channelFlag"),this._shaderSets.at(3).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_baseColor"),this._shaderSets.at(4).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(4).shaderProgram,"a_position"),this._shaderSets.at(4).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(4).shaderProgram,"a_texCoord"),this._shaderSets.at(4).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(4).shaderProgram,"s_texture0"),this._shaderSets.at(4).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(4).shaderProgram,"u_matrix"),this._shaderSets.at(4).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(4).shaderProgram,"u_baseColor"),this._shaderSets.at(5).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(5).shaderProgram,"a_position"),this._shaderSets.at(5).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(5).shaderProgram,"a_texCoord"),this._shaderSets.at(5).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"s_texture0"),this._shaderSets.at(5).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"s_texture1"),this._shaderSets.at(5).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_matrix"),this._shaderSets.at(5).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_clipMatrix"),this._shaderSets.at(5).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_channelFlag"),this._shaderSets.at(5).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_baseColor"),this._shaderSets.at(6).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(6).shaderProgram,"a_position"),this._shaderSets.at(6).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(6).shaderProgram,"a_texCoord"),this._shaderSets.at(6).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"s_texture0"),this._shaderSets.at(6).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"s_texture1"),this._shaderSets.at(6).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_matrix"),this._shaderSets.at(6).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_clipMatrix"),this._shaderSets.at(6).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_channelFlag"),this._shaderSets.at(6).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_baseColor"),this._shaderSets.at(7).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(7).shaderProgram,"a_position"),this._shaderSets.at(7).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(7).shaderProgram,"a_texCoord"),this._shaderSets.at(7).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(7).shaderProgram,"s_texture0"),this._shaderSets.at(7).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(7).shaderProgram,"u_matrix"),this._shaderSets.at(7).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(7).shaderProgram,"u_baseColor"),this._shaderSets.at(8).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(8).shaderProgram,"a_position"),this._shaderSets.at(8).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(8).shaderProgram,"a_texCoord"),this._shaderSets.at(8).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"s_texture0"),this._shaderSets.at(8).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"s_texture1"),this._shaderSets.at(8).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_matrix"),this._shaderSets.at(8).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_clipMatrix"),this._shaderSets.at(8).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_channelFlag"),this._shaderSets.at(8).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_baseColor"),this._shaderSets.at(9).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(9).shaderProgram,"a_position"),this._shaderSets.at(9).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(9).shaderProgram,"a_texCoord"),this._shaderSets.at(9).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"s_texture0"),this._shaderSets.at(9).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"s_texture1"),this._shaderSets.at(9).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_matrix"),this._shaderSets.at(9).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_clipMatrix"),this._shaderSets.at(9).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_channelFlag"),this._shaderSets.at(9).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_baseColor")}GenerateExShaders(e){for(let a=0;a<e.length;a++){this.exShaderSets.pushBack(new C);var i,r=e[a].exShaderSrc;switch(e[a].shaderType){case u.ShaderType.ShaderType_SetupMask:i=t.vertexShaderSrcSetupMask;break;case u.ShaderType.ShaderType_NormalPremultipliedAlpha||u.ShaderType.ShaderType_AddPremultipliedAlpha||u.ShaderType.ShaderType_MultPremultipliedAlpha:i=t.vertexShaderSrc;break;default:i=t.vertexShaderSrcMasked}this.exShaderSets.at(a).shaderProgram=this.loadShaderProgram(i,r);var s=this.exShaderSets.at(a);switch(e[a].shaderType){case u.ShaderType.ShaderType_SetupMask:s.attributePositionLocation=this.gl.getAttribLocation(s.shaderProgram,"a_position"),s.attributeTexCoordLocation=this.gl.getAttribLocation(s.shaderProgram,"a_texCoord"),s.samplerTexture0Location=this.gl.getUniformLocation(s.shaderProgram,"s_texture0"),s.uniformClipMatrixLocation=this.gl.getUniformLocation(s.shaderProgram,"u_clipMatrix"),s.uniformChannelFlagLocation=this.gl.getUniformLocation(s.shaderProgram,"u_channelFlag"),s.uniformBaseColorLocation=this.gl.getUniformLocation(s.shaderProgram,"u_baseColor");break;case u.ShaderType.ShaderType_NormalPremultipliedAlpha||u.ShaderType.ShaderType_AddPremultipliedAlpha||u.ShaderType.ShaderType_MultPremultipliedAlpha:i=t.vertexShaderSrcMasked,s.attributePositionLocation=this.gl.getAttribLocation(s.shaderProgram,"a_position"),s.attributeTexCoordLocation=this.gl.getAttribLocation(s.shaderProgram,"a_texCoord"),s.samplerTexture0Location=this.gl.getUniformLocation(s.shaderProgram,"s_texture0"),s.uniformMatrixLocation=this.gl.getUniformLocation(s.shaderProgram,"u_matrix"),s.uniformBaseColorLocation=this.gl.getUniformLocation(s.shaderProgram,"u_baseColor");break;default:s.attributePositionLocation=this.gl.getAttribLocation(s.shaderProgram,"a_position"),s.attributeTexCoordLocation=this.gl.getAttribLocation(s.shaderProgram,"a_texCoord"),s.samplerTexture0Location=this.gl.getUniformLocation(s.shaderProgram,"s_texture0"),s.samplerTexture1Location=this.gl.getUniformLocation(s.shaderProgram,"s_texture1"),s.uniformMatrixLocation=this.gl.getUniformLocation(s.shaderProgram,"u_matrix"),s.uniformClipMatrixLocation=this.gl.getUniformLocation(s.shaderProgram,"u_clipMatrix"),s.uniformChannelFlagLocation=this.gl.getUniformLocation(s.shaderProgram,"u_channelFlag"),s.uniformBaseColorLocation=this.gl.getUniformLocation(s.shaderProgram,"u_baseColor")}this.exShaderSets.at(a).uniformMousePosLocation=this.gl.getUniformLocation(this.exShaderSets.at(a).shaderProgram,"u_mousePos"),this.exShaderSets.at(a).uniformResoulutionLocation=this.gl.getUniformLocation(this.exShaderSets.at(a).shaderProgram,"u_resolution"),this.exShaderSets.at(a).uniformTimeLocation=this.gl.getUniformLocation(this.exShaderSets.at(a).shaderProgram,"u_time")}}loadShaderProgram(e,t){let i=this.gl.createProgram(),r=this.compileShaderSource(this.gl.VERTEX_SHADER,e);if(!r)return c.CubismLogError("Vertex shader compile error!"),0;let s=this.compileShaderSource(this.gl.FRAGMENT_SHADER,t);return s?(this.gl.attachShader(i,r),this.gl.attachShader(i,s),this.gl.linkProgram(i),this.gl.getProgramParameter(i,this.gl.LINK_STATUS)?(this.gl.deleteShader(r),this.gl.deleteShader(s),i):(c.CubismLogError("Failed to link program: {0}",i),this.gl.deleteShader(r),r=0,this.gl.deleteShader(s),s=0,i&&(this.gl.deleteProgram(i),i=0),0)):(c.CubismLogError("Vertex shader compile error!"),0)}compileShaderSource(e,t){const i=t,r=this.gl.createShader(e);if(this.gl.shaderSource(r,i),this.gl.compileShader(r),!r){const e=this.gl.getShaderInfoLog(r);c.CubismLogError("Shader compile log: {0} ",e)}return this.gl.getShaderParameter(r,this.gl.COMPILE_STATUS)?r:(this.gl.deleteShader(r),null)}setGl(e){this.gl=e}}t.CubismShader_WebGL=S;class C{}var v;t.CubismShaderSet=C,function(e){e[e.ShaderNames_SetupMask=0]="ShaderNames_SetupMask",e[e.ShaderNames_NormalPremultipliedAlpha=1]="ShaderNames_NormalPremultipliedAlpha",e[e.ShaderNames_NormalMaskedPremultipliedAlpha=2]="ShaderNames_NormalMaskedPremultipliedAlpha",e[e.ShaderNames_NomralMaskedInvertedPremultipliedAlpha=3]="ShaderNames_NomralMaskedInvertedPremultipliedAlpha",e[e.ShaderNames_AddPremultipliedAlpha=4]="ShaderNames_AddPremultipliedAlpha",e[e.ShaderNames_AddMaskedPremultipliedAlpha=5]="ShaderNames_AddMaskedPremultipliedAlpha",e[e.ShaderNames_AddMaskedPremultipliedAlphaInverted=6]="ShaderNames_AddMaskedPremultipliedAlphaInverted",e[e.ShaderNames_MultPremultipliedAlpha=7]="ShaderNames_MultPremultipliedAlpha",e[e.ShaderNames_MultMaskedPremultipliedAlpha=8]="ShaderNames_MultMaskedPremultipliedAlpha",e[e.ShaderNames_MultMaskedPremultipliedAlphaInverted=9]="ShaderNames_MultMaskedPremultipliedAlphaInverted"}(v=t.ShaderNames||(t.ShaderNames={})),t.vertexShaderSrcSetupMask="attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;varying vec4       v_myPos;uniform mat4       u_clipMatrix;void main(){   gl_Position = u_clipMatrix * a_position;   v_myPos = u_clipMatrix * a_position;   v_texCoord = a_texCoord;   v_texCoord.y = 1.0 - v_texCoord.y;}",t.fragmentShaderSrcsetupMask="precision mediump float;varying vec2       v_texCoord;varying vec4       v_myPos;uniform vec4       u_baseColor;uniform vec4       u_channelFlag;uniform sampler2D  s_texture0;void main(){   float isInside =        step(u_baseColor.x, v_myPos.x/v_myPos.w)       * step(u_baseColor.y, v_myPos.y/v_myPos.w)       * step(v_myPos.x/v_myPos.w, u_baseColor.z)       * step(v_myPos.y/v_myPos.w, u_baseColor.w);   gl_FragColor = u_channelFlag * texture2D(s_texture0, v_texCoord).a * isInside;}",t.vertexShaderSrc="attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;uniform mat4       u_matrix;void main(){   gl_Position = u_matrix * a_position;   v_texCoord = a_texCoord;   v_texCoord.y = 1.0 - v_texCoord.y;}",t.vertexShaderSrcMasked="attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;varying vec4       v_clipPos;uniform mat4       u_matrix;uniform mat4       u_clipMatrix;void main(){   gl_Position = u_matrix * a_position;   v_clipPos = u_clipMatrix * a_position;   v_texCoord = a_texCoord;   v_texCoord.y = 1.0 - v_texCoord.y;}",t.fragmentShaderSrcPremultipliedAlpha="precision mediump float;varying vec2       v_texCoord;uniform vec4       u_baseColor;uniform sampler2D  s_texture0;void main(){   gl_FragColor = texture2D(s_texture0 , v_texCoord) * u_baseColor;}",t.fragmentShaderSrcMaskPremultipliedAlpha="precision mediump float;varying vec2       v_texCoord;varying vec4       v_clipPos;uniform vec4       u_baseColor;uniform vec4       u_channelFlag;uniform sampler2D  s_texture0;uniform sampler2D  s_texture1;void main(){   vec4 col_formask = texture2D(s_texture0 , v_texCoord) * u_baseColor;   vec4 clipMask = (1.0 - texture2D(s_texture1, v_clipPos.xy / v_clipPos.w)) * u_channelFlag;   float maskVal = clipMask.r + clipMask.g + clipMask.b + clipMask.a;   col_formask = col_formask * maskVal;   gl_FragColor = col_formask;}",t.fragmentShaderSrcMaskInvertedPremultipliedAlpha="precision mediump float;varying vec2 v_texCoord;varying vec4 v_clipPos;uniform sampler2D s_texture0;uniform sampler2D s_texture1;uniform vec4 u_channelFlag;uniform vec4 u_baseColor;void main(){vec4 col_formask = texture2D(s_texture0, v_texCoord) * u_baseColor;vec4 clipMask = (1.0 - texture2D(s_texture1, v_clipPos.xy / v_clipPos.w)) * u_channelFlag;float maskVal = clipMask.r + clipMask.g + clipMask.b + clipMask.a;col_formask = col_formask * (1.0 - maskVal);gl_FragColor = col_formask;}",t.FS_ex="precision mediump float;varying vec2       v_texCoord;uniform vec4       u_baseColor;uniform vec2       u_mousePos;uniform vec2       u_resolution;uniform float      u_time;uniform sampler2D  s_texture0;void main(){   gl_FragColor =vec4(u_time,1,0,1);}";class P extends g.CubismRenderer{constructor(){super(),this._clippingContextBufferForMask=null,this._clippingContextBufferForDraw=null,this._clippingManager=new f,this.firstDraw=!0,this._textures=new l.csmMap,this._sortedDrawableIndexList=new d.csmVector,this._bufferData={vertex:WebGLBuffer=null,uv:WebGLBuffer=null,index:WebGLBuffer=null},this._textures.prepareCapacity(32,!0)}initialize(e){e.isUsingMasking()&&(this._clippingManager=new f,this._clippingManager.initialize(e,e.getDrawableCount(),e.getDrawableMasks(),e.getDrawableMaskCounts())),this._sortedDrawableIndexList.resize(e.getDrawableCount(),0),super.initialize(e)}bindTexture(e,t){this._textures.setValue(e,t)}getBindedTextures(){return this._textures}setClippingMaskBufferSize(e){this._clippingManager.release(),this._clippingManager=void 0,this._clippingManager=null,this._clippingManager=new f,this._clippingManager.setClippingMaskBufferSize(e),this._clippingManager.initialize(this.getModel(),this.getModel().getDrawableCount(),this.getModel().getDrawableMasks(),this.getModel().getDrawableMaskCounts())}getClippingMaskBufferSize(){return this._clippingManager.getClippingMaskBufferSize()}release(){this._clippingManager.release(),this._clippingManager=void 0,this._clippingManager=null,this.gl.deleteBuffer(this._bufferData.vertex),this._bufferData.vertex=null,this.gl.deleteBuffer(this._bufferData.uv),this._bufferData.uv=null,this.gl.deleteBuffer(this._bufferData.index),this._bufferData.index=null,this._bufferData=null,this._textures=null}doDrawModel(){null!=this._clippingManager&&(this.preDraw(),this._clippingManager.setupClippingContext(this.getModel(),this)),this.preDraw();const e=this.getModel().getDrawableCount(),t=this.getModel().getDrawableRenderOrders();for(let i=0;i<e;++i){const e=t[i];this._sortedDrawableIndexList.set(e,i)}for(let t=0;t<e;++t){const e=this._sortedDrawableIndexList.at(t);this.getModel().getDrawableDynamicFlagIsVisible(e)&&(this.setClippingContextBufferForDraw(null!=this._clippingManager?this._clippingManager.getClippingContextListForDraw().at(e):null),this.setIsCulling(this.getModel().getDrawableCulling(e)),this.drawMesh(this.getModel().getDrawableTextureIndices(e),this.getModel().getDrawableVertexIndexCount(e),this.getModel().getDrawableVertexCount(e),this.getModel().getDrawableVertexIndices(e),this.getModel().getDrawableVertices(e),this.getModel().getDrawableVertexUvs(e),this.getModel().getDrawableOpacity(e),this.getModel().getDrawableBlendMode(e),this.getModel().getDrawableInvertedMaskBit(e),this.getModel().GetExShaderNum(e),this.getModel().GetExShaderUni(e)))}}drawMesh(e,t,i,r,s,a,n,o,u,l,h){this.isCulling()?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this.gl.frontFace(this.gl.CCW);const d=this.getModelColor();let c;null==this.getClippingContextBufferForMask()&&(d.A*=n,this.isPremultipliedAlpha()&&(d.R*=d.A,d.G*=d.A,d.B*=d.A)),c=null!=this._textures.getValue(e)?this._textures.getValue(e):null,S.getInstance().setupShaderProgram(this,c,i,s,r,a,this._bufferData,n,o,d,this.isPremultipliedAlpha(),this.getMvpMatrix(),u,l,h),this.gl.drawElements(this.gl.TRIANGLES,t,this.gl.UNSIGNED_SHORT,0),this.gl.useProgram(null),this.setClippingContextBufferForDraw(null),this.setClippingContextBufferForMask(null)}static doStaticRelease(){S.deleteInstance()}setRenderState(e,t){p=e,_=t}preDraw(){this.firstDraw&&(this.firstDraw=!1,this._anisortopy=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")),this.gl.disable(this.gl.SCISSOR_TEST),this.gl.disable(this.gl.STENCIL_TEST),this.gl.disable(this.gl.DEPTH_TEST),this.gl.frontFace(this.gl.CW),this.gl.enable(this.gl.BLEND),this.gl.colorMask(!0,!0,!0,!0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null)}setClippingContextBufferForMask(e){this._clippingContextBufferForMask=e}getClippingContextBufferForMask(){return this._clippingContextBufferForMask}setClippingContextBufferForDraw(e){this._clippingContextBufferForDraw=e}getClippingContextBufferForDraw(){return this._clippingContextBufferForDraw}startUp(e){this.gl=e,this._clippingManager.setGL(e)}}t.CubismRenderer_WebGL=P,g.CubismRenderer.staticRelease=()=>{P.doStaticRelease()};const M=a(i(5137));var x;(x=t.Live2DCubismFramework||(t.Live2DCubismFramework={})).CubismClippingContext=M.CubismClippingContext,x.CubismClippingManager_WebGL=M.CubismClippingManager_WebGL,x.CubismRenderTextureResource=M.CubismRenderTextureResource,x.CubismRenderer_WebGL=M.CubismRenderer_WebGL,x.CubismShaderSet=M.CubismShaderSet,x.CubismShader_WebGL=M.CubismShader_WebGL,x.ShaderNames=M.ShaderNames},9045:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.iterator=t.csmMap=t.csmPair=void 0;const n=i(1201);class o{constructor(e,t){this.first=null==e?null:e,this.second=null==t?null:t}}t.csmPair=o;class u{constructor(e){null!=e?e<1?(this._keyValues=[],this._dummyValue=null,this._size=0):(this._keyValues=new Array(e),this._size=e):(this._keyValues=[],this._dummyValue=null,this._size=0)}release(){this.clear()}appendKey(e){this.prepareCapacity(this._size+1,!1),this._keyValues[this._size]=new o(e),this._size+=1}getValue(e){let t=-1;for(let i=0;i<this._size;i++)if(this._keyValues[i].first==e){t=i;break}return t>=0?this._keyValues[t].second:(this.appendKey(e),this._keyValues[this._size-1].second)}setValue(e,t){let i=-1;for(let t=0;t<this._size;t++)if(this._keyValues[t].first==e){i=t;break}i>=0?this._keyValues[i].second=t:(this.appendKey(e),this._keyValues[this._size-1].second=t)}isExist(e){for(let t=0;t<this._size;t++)if(this._keyValues[t].first==e)return!0;return!1}clear(){this._keyValues=void 0,this._keyValues=null,this._keyValues=[],this._size=0}getSize(){return this._size}prepareCapacity(e,t){e>this._keyValues.length&&(0==this._keyValues.length?(!t&&e<u.DefaultSize&&(e=u.DefaultSize),this._keyValues.length=e):(!t&&e<2*this._keyValues.length&&(e=2*this._keyValues.length),this._keyValues.length=e))}begin(){return new l(this,0)}end(){return new l(this,this._size)}erase(e){const t=e._index;return t<0||this._size<=t?e:(this._keyValues.splice(t,1),--this._size,new l(this,t))}dumpAsInt(){for(let e=0;e<this._size;e++)n.CubismLogDebug("{0} ,",this._keyValues[e]),n.CubismLogDebug("\n")}}t.csmMap=u,u.DefaultSize=10;class l{constructor(e,t){this._map=null!=e?e:new u,this._index=null!=t?t:0}set(e){return this._index=e._index,this._map=e._map,this}preIncrement(){return++this._index,this}preDecrement(){return--this._index,this}increment(){return new l(this._map,this._index++)}decrement(){const e=new l(this._map,this._index);return this._map=e._map,this._index=e._index,this}ptr(){return this._map._keyValues[this._index]}notEqual(e){return this._index!=e._index||this._map!=e._map}}t.iterator=l;const h=a(i(9045));var d;(d=t.Live2DCubismFramework||(t.Live2DCubismFramework={})).csmMap=h.csmMap,d.csmPair=h.csmPair,d.iterator=h.iterator},7686:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.csmRect=void 0,t.csmRect=class{constructor(e,t,i,r){this.x=e,this.y=t,this.width=i,this.height=r}getCenterX(){return this.x+.5*this.width}getCenterY(){return this.y+.5*this.height}getRight(){return this.x+this.width}getBottom(){return this.y+this.height}setRect(e){this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height}expand(e,t){this.x-=e,this.y-=t,this.width+=2*e,this.height+=2*t}};const n=a(i(7686));(t.Live2DCubismFramework||(t.Live2DCubismFramework={})).csmRect=n.csmRect},4020:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.csmString=void 0,t.csmString=class{constructor(e){this.s=e}append(e,t){return this.s+=void 0!==t?e.substr(0,t):e,this}expansion(e,t){for(let i=0;i<e;i++)this.append(t);return this}getBytes(){return encodeURIComponent(this.s).replace(/%../g,"x").length}getLength(){return this.s.length}isLess(e){return this.s<e.s}isGreat(e){return this.s>e.s}isEqual(e){return this.s==e}isEmpty(){return 0==this.s.length}};const n=a(i(4020));(t.Live2DCubismFramework||(t.Live2DCubismFramework={})).csmString=n.csmString},6486:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.iterator=t.csmVector=void 0;class n{constructor(e=0){e<1?(this._ptr=[],this._capacity=0,this._size=0):(this._ptr=new Array(e),this._capacity=e,this._size=0)}at(e){return this._ptr[e]}set(e,t){this._ptr[e]=t}get(e=0){const t=new Array;for(let i=e;i<this._size;i++)t.push(this._ptr[i]);return t}pushBack(e){this._size>=this._capacity&&this.prepareCapacity(0==this._capacity?n.s_defaultSize:2*this._capacity),this._ptr[this._size++]=e}clear(){this._ptr.length=0,this._size=0}getSize(){return this._size}assign(e,t){this._size<e&&this.prepareCapacity(e);for(let i=0;i<e;i++)this._ptr[i]=t;this._size=e}resize(e,t=null){this.updateSize(e,t,!0)}updateSize(e,t=null,i=!0){if(this._size<e)if(this.prepareCapacity(e),i)for(let i=this._size;i<e;i++)this._ptr[i]="function"==typeof t?JSON.parse(JSON.stringify(new t)):t;else for(let i=this._size;i<e;i++)this._ptr[i]=t;else{const t=this._size-e;this._ptr.splice(this._size-t,t)}this._size=e}insert(e,t,i){let r=e._index;const s=t._index,a=i._index,n=a-s;this.prepareCapacity(this._size+n);const o=this._size-r;if(o>0)for(let e=0;e<o;e++)this._ptr.splice(r+e,0,null);for(let e=s;e<a;e++,r++)this._ptr[r]=t._vector._ptr[e];this._size=this._size+n}remove(e){return!(e<0||this._size<=e||(this._ptr.splice(e,1),--this._size,0))}erase(e){const t=e._index;return t<0||this._size<=t?e:(this._ptr.splice(t,1),--this._size,new o(this,t))}prepareCapacity(e){e>this._capacity&&(0==this._capacity?(this._ptr=new Array(e),this._capacity=e):(this._ptr.length=e,this._capacity=e))}begin(){return 0==this._size?this.end():new o(this,0)}end(){return new o(this,this._size)}getOffset(e){const t=new n;return t._ptr=this.get(e),t._size=this.get(e).length,t._capacity=this.get(e).length,t}}t.csmVector=n,n.s_defaultSize=10;class o{constructor(e,t){this._vector=null!=e?e:null,this._index=null!=t?t:0}set(e){return this._index=e._index,this._vector=e._vector,this}preIncrement(){return++this._index,this}preDecrement(){return--this._index,this}increment(){return new o(this._vector,this._index++)}decrement(){return new o(this._vector,this._index--)}ptr(){return this._vector._ptr[this._index]}substitution(e){return this._index=e._index,this._vector=e._vector,this}notEqual(e){return this._index!=e._index||this._vector!=e._vector}}t.iterator=o;const u=a(i(6486));var l;(l=t.Live2DCubismFramework||(t.Live2DCubismFramework={})).csmVector=u.csmVector,l.iterator=u.iterator},1201:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.CubismDebug=t.CubismLogError=t.CubismLogWarning=t.CubismLogInfo=t.CubismLogDebug=t.CubismLogVerbose=t.CSM_ASSERT=t.CubismLogPrintIn=t.CubismLogPrint=void 0;const n=i(7425),o=i(8871);t.CubismLogPrint=(e,t,i)=>{u.print(e,"[CSM]"+t,i)},t.CubismLogPrintIn=(e,i,r)=>{t.CubismLogPrint(e,i+"\n",r)},t.CSM_ASSERT=e=>{console.assert(e)},n.CSM_LOG_LEVEL<=n.CSM_LOG_LEVEL_VERBOSE?(t.CubismLogVerbose=(e,...i)=>{t.CubismLogPrintIn(o.LogLevel.LogLevel_Verbose,"[V]"+e,i)},t.CubismLogDebug=(e,...i)=>{t.CubismLogPrintIn(o.LogLevel.LogLevel_Debug,"[D]"+e,i)},t.CubismLogInfo=(e,...i)=>{t.CubismLogPrintIn(o.LogLevel.LogLevel_Info,"[I]"+e,i)},t.CubismLogWarning=(e,...i)=>{t.CubismLogPrintIn(o.LogLevel.LogLevel_Warning,"[W]"+e,i)},t.CubismLogError=(e,...i)=>{t.CubismLogPrintIn(o.LogLevel.LogLevel_Error,"[E]"+e,i)}):n.CSM_LOG_LEVEL==n.CSM_LOG_LEVEL_DEBUG?(t.CubismLogDebug=(e,...i)=>{t.CubismLogPrintIn(o.LogLevel.LogLevel_Debug,"[D]"+e,i)},t.CubismLogInfo=(e,...i)=>{t.CubismLogPrintIn(o.LogLevel.LogLevel_Info,"[I]"+e,i)},t.CubismLogWarning=(e,...i)=>{t.CubismLogPrintIn(o.LogLevel.LogLevel_Warning,"[W]"+e,i)},t.CubismLogError=(e,...i)=>{t.CubismLogPrintIn(o.LogLevel.LogLevel_Error,"[E]"+e,i)}):n.CSM_LOG_LEVEL==n.CSM_LOG_LEVEL_INFO?(t.CubismLogInfo=(e,...i)=>{t.CubismLogPrintIn(o.LogLevel.LogLevel_Info,"[I]"+e,i)},t.CubismLogWarning=(e,...i)=>{t.CubismLogPrintIn(o.LogLevel.LogLevel_Warning,"[W]"+e,i)},t.CubismLogError=(e,...i)=>{t.CubismLogPrintIn(o.LogLevel.LogLevel_Error,"[E]"+e,i)}):n.CSM_LOG_LEVEL==n.CSM_LOG_LEVEL_WARNING?(t.CubismLogWarning=(e,...i)=>{t.CubismLogPrintIn(o.LogLevel.LogLevel_Warning,"[W]"+e,i)},t.CubismLogError=(e,...i)=>{t.CubismLogPrintIn(o.LogLevel.LogLevel_Error,"[E]"+e,i)}):n.CSM_LOG_LEVEL==n.CSM_LOG_LEVEL_ERROR&&(t.CubismLogError=(e,...i)=>{t.CubismLogPrintIn(o.LogLevel.LogLevel_Error,"[E]"+e,i)});class u{static print(e,t,i){if(e<o.CubismFramework.getLoggingLevel())return;const r=o.CubismFramework.coreLogFunction;r&&r(t.replace(/\{(\d+)\}/g,((e,t)=>i[t])))}static dumpBytes(e,t,i){for(let r=0;r<i;r++)r%16==0&&r>0?this.print(e,"\n"):r%8==0&&r>0&&this.print(e,"  "),this.print(e,"{0} ",[255&t[r]]);this.print(e,"\n")}constructor(){}}t.CubismDebug=u;const l=a(i(1201));(t.Live2DCubismFramework||(t.Live2DCubismFramework={})).CubismDebug=l.CubismDebug},4462:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Live2DCubismFramework=t.JsonMap=t.JsonArray=t.JsonNullvalue=t.JsonError=t.JsonString=t.JsonBoolean=t.JsonFloat=t.CubismJson=t.Value=void 0;const n=i(8871),o=i(9045),u=i(4020),l=i(6486),h=i(1201),d="Error: type mismatch";class c{constructor(){}getRawString(e,t){return this.getString(e,t)}toInt(e=0){return e}toFloat(e=0){return e}toBoolean(e=!1){return e}getSize(){return 0}getArray(e=null){return e}getVector(e){return e}getMap(e){return e}getValueByIndex(e){return c.errorValue.setErrorNotForClientCall(d)}getValueByString(e){return c.nullValue.setErrorNotForClientCall(d)}getKeys(){return c.s_dummyKeys}isError(){return!1}isNull(){return!1}isBool(){return!1}isFloat(){return!1}isString(){return!1}isArray(){return!1}isMap(){return!1}equals(e){return!1}isStatic(){return!1}setErrorNotForClientCall(e){return f.errorValue}static staticInitializeNotForClientCall(){_.trueValue=new _(!0),_.falseValue=new _(!1),f.errorValue=new f("ERROR",!0),this.nullValue=new y,c.s_dummyKeys=new l.csmVector}static staticReleaseNotForClientCall(){_.trueValue=null,_.falseValue=null,f.errorValue=null,c.nullValue=null,c.s_dummyKeys=null,_.trueValue=null,_.falseValue=null,f.errorValue=null,c.nullValue=null,c.s_dummyKeys=null}}t.Value=c;class g{constructor(e,t){this._error=null,this._lineCount=0,this._root=null,null!=e&&this.parseBytes(e,t)}static create(e,t){const i=new g;return i.parseBytes(e,t)?i:(g.delete(i),null)}static delete(e){}getRoot(){return this._root}arrayBufferToString(e){const t=new Uint8Array(e);let i="";for(let e=0,r=t.length;e<r;++e)i+="%"+this.pad(t[e].toString(16));return i=decodeURIComponent(i),i}pad(e){return e.length<2?"0"+e:e}parseBytes(e,t){const i=new Array(1),r=this.arrayBufferToString(e);if(this._root=this.parseValue(r,t,0,i),this._error){let e="\0";return e="Json parse error : @line "+(this._lineCount+1)+"\n",this._root=new p(e),h.CubismLogInfo("{0}",this._root.getRawString()),!1}return null!=this._root||(this._root=new f(new u.csmString(this._error),!1),!1)}getParseError(){return this._error}checkEndOfFile(){return this._root.getArray()[1].equals("EOF")}parseValue(e,t,i,r){if(this._error)return null;let s,a=null,o=i;for(;o<t;o++)switch(e[o]){case"-":case".":case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{const t=new Array(1);return s=n.strtod(e.slice(o),t),r[0]=e.indexOf(t[0]),new m(s)}case'"':return new p(this.parseString(e,t,o+1,r));case"[":return a=this.parseArray(e,t,o+1,r),a;case"{":return a=this.parseObject(e,t,o+1,r),a;case"n":return o+3<t?(a=new y,r[0]=o+4):this._error="parse null",a;case"t":return o+3<t?(a=_.trueValue,r[0]=o+4):this._error="parse true",a;case"f":return o+4<t?(a=_.falseValue,r[0]=o+5):this._error="illegal ',' position",a;case",":return this._error="illegal ',' position",null;case"]":return r[0]=o,null;case"\n":this._lineCount++}return this._error="illegal end of value",null}parseString(e,t,i,r){if(this._error)return null;let s,a,n=i;const o=new u.csmString("");let l=i;for(;n<t;n++)switch(s=e[n],s){case'"':return r[0]=n+1,o.append(e.slice(l),n-l),o.s;case"//":if(n++,n-1>l&&o.append(e.slice(l),n-l),l=n+1,n<t)switch(a=e[n],a){case"\\":o.expansion(1,"\\");break;case'"':o.expansion(1,'"');break;case"/":o.expansion(1,"/");break;case"b":o.expansion(1,"\b");break;case"f":o.expansion(1,"\f");break;case"n":o.expansion(1,"\n");break;case"r":o.expansion(1,"\r");break;case"t":o.expansion(1,"\t");break;case"u":this._error="parse string/unicord escape not supported"}else this._error="parse string/escape error"}return this._error="parse string/illegal end",null}parseObject(e,t,i,r){if(this._error)return null;const s=new S;let a="",n=i,o="";const u=Array(1);let l=!1;for(;n<t;n++){e:for(;n<t;n++)switch(o=e[n],o){case'"':if(a=this.parseString(e,t,n+1,u),this._error)return null;n=u[0],l=!0;break e;case"}":return r[0]=n+1,s;case":":this._error="illegal ':' position";break;case"\n":this._lineCount++}if(!l)return this._error="key not found",null;l=!1;e:for(;n<t;n++)switch(o=e[n],o){case":":l=!0,n++;break e;case"}":this._error="illegal '}' position";break;case"\n":this._lineCount++}if(!l)return this._error="':' not found",null;const i=this.parseValue(e,t,n,u);if(this._error)return null;n=u[0],s.put(a,i);e:for(;n<t;n++)switch(o=e[n],o){case",":break e;case"}":return r[0]=n+1,s;case"\n":this._lineCount++}}return this._error="illegal end of perseObject",null}parseArray(e,t,i,r){if(this._error)return null;let s,a=new b,n=i;const o=new Array(1);for(;n<t;n++){const i=this.parseValue(e,t,n,o);if(this._error)return null;n=o[0],i&&a.add(i);e:for(;n<t;n++)switch(s=e[n],s){case",":break e;case"]":return r[0]=n+1,a;case"\n":++this._lineCount}}return a=void 0,this._error="illegal end of parseObject",null}}t.CubismJson=g;class m extends c{constructor(e){super(),this._value=e}isFloat(){return!0}getString(e,t){return this._value=parseFloat("\0"),this._stringBuffer="\0",this._stringBuffer}toInt(e=0){return parseInt(this._value.toString())}toFloat(e=0){return this._value}equals(e){return"number"==typeof e&&!Math.round(e)&&e==this._value}}t.JsonFloat=m;class _ extends c{constructor(e){super(),this._boolValue=e}isBool(){return!0}toBoolean(e=!1){return this._boolValue}getString(e,t){return this._stringBuffer=this._boolValue?"true":"false",this._stringBuffer}equals(e){return"boolean"==typeof e&&e==this._boolValue}isStatic(){return!0}}t.JsonBoolean=_;class p extends c{constructor(e){super(),"string"==typeof e&&(this._stringBuffer=e),e instanceof u.csmString&&(this._stringBuffer=e.s)}isString(){return!0}getString(e,t){return this._stringBuffer}equals(e){return"string"==typeof e?this._stringBuffer==e:e instanceof u.csmString&&this._stringBuffer==e.s}}t.JsonString=p;class f extends p{constructor(e,t){super(e),this._isStatic=t}isStatic(){return this._isStatic}setErrorNotForClientCall(e){return this._stringBuffer=e,this}isError(){return!0}}t.JsonError=f;class y extends c{isNull(){return!0}getString(e,t){return this._stringBuffer}isStatic(){return!0}constructor(){super(),this._stringBuffer="NullValue"}}t.JsonNullvalue=y;class b extends c{constructor(){super(),this._array=new l.csmVector}release(){for(let e=this._array.begin();e.notEqual(this._array.end());e.preIncrement()){let t=e.ptr();t&&!t.isStatic()&&(t=void 0,t=null)}}isArray(){return!0}getValueByIndex(e){if(e<0||this._array.getSize()<=e)return c.errorValue.setErrorNotForClientCall("Error: index out of bounds");const t=this._array.at(e);return null==t?c.nullValue:t}getValueByString(e){return c.errorValue.setErrorNotForClientCall(d)}getString(e,t){const i=t+"[\n";for(let e=this._array.begin();e.notEqual(this._array.end());e.increment()){const i=e.ptr();this._stringBuffer+=t+""+i.getString(t+" ")+"\n"}return this._stringBuffer=i+t+"]\n",this._stringBuffer}add(e){this._array.pushBack(e)}getVector(e=null){return this._array}getSize(){return this._array.getSize()}}t.JsonArray=b;class S extends c{constructor(){super(),this._map=new o.csmMap}release(){const e=this._map.begin();for(;e.notEqual(this._map.end());){let t=e.ptr().second;t&&!t.isStatic()&&(t=void 0,t=null),e.preIncrement()}}isMap(){return!0}getValueByString(e){if(e instanceof u.csmString){const t=this._map.getValue(e.s);return null==t?c.nullValue:t}for(let t=this._map.begin();t.notEqual(this._map.end());t.preIncrement())if(t.ptr().first==e)return null==t.ptr().second?c.nullValue:t.ptr().second;return c.nullValue}getValueByIndex(e){return c.errorValue.setErrorNotForClientCall(d)}getString(e,t){this._stringBuffer=t+"{\n";const i=this._map.begin();for(;i.notEqual(this._map.end());){const e=i.ptr().first,r=i.ptr().second;this._stringBuffer+=t+" "+e+" : "+r.getString(t+"   ")+" \n",i.preIncrement()}return this._stringBuffer+=t+"}\n",this._stringBuffer}getMap(e){return this._map}put(e,t){this._map.setValue(e,t)}getKeys(){if(!this._keys){this._keys=new l.csmVector;const e=this._map.begin();for(;e.notEqual(this._map.end());){const t=e.ptr().first;this._keys.pushBack(t),e.preIncrement()}}return this._keys}getSize(){return this._keys.getSize()}}t.JsonMap=S;const C=a(i(4462));var v;(v=t.Live2DCubismFramework||(t.Live2DCubismFramework={})).CubismJson=C.CubismJson,v.JsonArray=C.JsonArray,v.JsonBoolean=C.JsonBoolean,v.JsonError=C.JsonError,v.JsonFloat=C.JsonFloat,v.JsonMap=C.JsonMap,v.JsonNullvalue=C.JsonNullvalue,v.JsonString=C.JsonString,v.Value=C.Value},7032:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.RenderTargetHeight=t.RenderTargetWidth=t.CubismLoggingLevel=t.DebugTouchLogEnable=t.DebugLogEnable=t.PriorityForce=t.PriorityNormal=t.PriorityIdle=t.PriorityNone=t.HitAreaNameBody=t.HitAreaNameHead=t.MotionGroupTapBody=t.MotionGroupIdle=t.ModelDirSize=t.ModelDir=t.PowerImageName=t.GearImageName=t.BackImageName=t.ResourcesPath=t.ViewLogicalMaxTop=t.ViewLogicalMaxBottom=t.ViewLogicalMaxRight=t.ViewLogicalMaxLeft=t.ViewLogicalTop=t.ViewLogicalBottom=t.ViewLogicalRight=t.ViewLogicalLeft=t.ViewMinScale=t.ViewMaxScale=t.ViewScale=t.CanvasSize=void 0;const r=i(8871);t.CanvasSize="auto",t.ViewScale=1,t.ViewMaxScale=2,t.ViewMinScale=.8,t.ViewLogicalLeft=-1,t.ViewLogicalRight=1,t.ViewLogicalBottom=-1,t.ViewLogicalTop=1,t.ViewLogicalMaxLeft=-2,t.ViewLogicalMaxRight=2,t.ViewLogicalMaxBottom=-2,t.ViewLogicalMaxTop=2,t.ResourcesPath="../../live2DResources/",t.BackImageName="../img/Find.png",t.GearImageName="icon_gear.png",t.PowerImageName="CloseNormal.png",t.ModelDir=["Haru"],t.ModelDirSize=t.ModelDir.length,t.MotionGroupIdle="Idle",t.MotionGroupTapBody="TapBody",t.HitAreaNameHead="Head",t.HitAreaNameBody="Body",t.PriorityNone=0,t.PriorityIdle=1,t.PriorityNormal=2,t.PriorityForce=3,t.DebugLogEnable=!0,t.DebugTouchLogEnable=!1,t.CubismLoggingLevel=r.LogLevel.LogLevel_Verbose,t.RenderTargetWidth=1900,t.RenderTargetHeight=1e3},3238:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.LAppDelegate=t.frameBuffer=t.gl=t.s_instance=t.canvas=void 0;const n=i(8871),o=a(i(7032)),u=i(9655),l=i(7720),h=i(1632),d=i(9705),c=i(5137);t.canvas=null,t.s_instance=null,t.gl=null,t.frameBuffer=null;class g{constructor(){this._captured=!1,this._mouseX=0,this._mouseY=0,this._isEnd=!1,this._cubismOption=new n.Option,this._view=new d.LAppView,this._textureManager=new h.LAppTextureManager}static CreateInstance(){null==t.s_instance&&(t.s_instance=new g)}static getInstance(){return null==t.s_instance&&(t.s_instance=new g),t.s_instance}static releaseInstance(){null!=t.s_instance&&t.s_instance.release(),t.s_instance=null}initialize(e){return t.canvas=document.getElementById("myCanvas"),t.canvas.width=1048,t.canvas.height=1048,t.gl=t.canvas.getContext("webgl")||t.canvas.getContext("experimental-webgl"),t.gl?(t.frameBuffer||(t.frameBuffer=t.gl.getParameter(t.gl.FRAMEBUFFER_BINDING)),t.gl.enable(t.gl.BLEND),t.gl.blendFunc(t.gl.SRC_ALPHA,t.gl.ONE_MINUS_SRC_ALPHA),"ontouchend"in t.canvas?(t.canvas.ontouchstart=f,t.canvas.ontouchmove=y,t.canvas.ontouchend=b,t.canvas.ontouchcancel=S):(t.canvas.onmousedown=m,t.canvas.onmousemove=_,t.canvas.onmouseup=p),c.CubismShader_WebGL.getInstance().setGl(t.gl),c.CubismShader_WebGL.getInstance().GenerateExShaders(e),this._view.initialize(),this.initializeCubism(),!0):(alert("Cannot initialize WebGL. This browser does not support."),t.gl=null,document.body.innerHTML="This browser does not support the <code>&lt;canvas&gt;</code> element.",!1)}onResize(){}release(){this._textureManager.release(),this._textureManager=null,this._view.release(),this._view=null,u.LAppLive2DManager.releaseInstance(),n.CubismFramework.dispose()}run(){(()=>{null!=t.s_instance&&(l.LAppPal.updateTime(),t.gl.clearColor(0,0,0,1),t.gl.enable(t.gl.DEPTH_TEST),t.gl.depthFunc(t.gl.LEQUAL),t.gl.clear(t.gl.COLOR_BUFFER_BIT|t.gl.DEPTH_BUFFER_BIT),t.gl.clearDepth(1),t.gl.enable(t.gl.BLEND),t.gl.blendFunc(t.gl.SRC_ALPHA,t.gl.ONE_MINUS_SRC_ALPHA),this._view.render())})()}createShader(){const e=t.gl.createShader(t.gl.VERTEX_SHADER);if(null==e)return l.LAppPal.printMessage("failed to create vertexShader"),null;t.gl.shaderSource(e,"precision mediump float;attribute vec3 position;attribute vec2 uv;varying vec2 vuv;void main(void){   gl_Position = vec4(position, 1.0);   vuv = uv;}"),t.gl.compileShader(e);const i=t.gl.createShader(t.gl.FRAGMENT_SHADER);if(null==i)return l.LAppPal.printMessage("failed to create fragmentShader"),null;t.gl.shaderSource(i,"precision mediump float;varying vec2 vuv;uniform sampler2D texture;void main(void){    vec4 color=texture2D(texture, vuv);   gl_FragColor =color;}"),t.gl.compileShader(i);const r=t.gl.createProgram();return t.gl.attachShader(r,e),t.gl.attachShader(r,i),t.gl.deleteShader(e),t.gl.deleteShader(i),t.gl.linkProgram(r),t.gl.useProgram(r),r}getView(){return this._view}getTextureManager(){return this._textureManager}initializeCubism(){this._cubismOption.logFunction=l.LAppPal.printMessage,this._cubismOption.loggingLevel=o.CubismLoggingLevel,n.CubismFramework.startUp(this._cubismOption),n.CubismFramework.initialize()}LoadModel(e,t){u.LAppLive2DManager.CreateInstance(e,t),l.LAppPal.updateTime(),this._view.initializeSprite()}_resizeCanvas(){}}function m(e){if(!g.getInstance()._view)return void l.LAppPal.printMessage("view notfound");g.getInstance()._captured=!0;const t=e.pageX,i=e.pageY;g.getInstance()._view.onTouchesBegan(t,i)}function _(e){if(!g.getInstance()._captured)return;if(!g.getInstance()._view)return void l.LAppPal.printMessage("view notfound");const t=e.target.getBoundingClientRect(),i=e.clientX-t.left,r=e.clientY-t.top;g.getInstance()._view.onTouchesMoved(i,r)}function p(e){if(g.getInstance()._captured=!1,!g.getInstance()._view)return void l.LAppPal.printMessage("view notfound");const t=e.target.getBoundingClientRect(),i=e.clientX-t.left,r=e.clientY-t.top;g.getInstance()._view.onTouchesEnded(i,r)}function f(e){if(!g.getInstance()._view)return void l.LAppPal.printMessage("view notfound");g.getInstance()._captured=!0;const t=e.changedTouches[0].pageX,i=e.changedTouches[0].pageY;g.getInstance()._view.onTouchesBegan(t,i)}function y(e){if(!g.getInstance()._captured)return;if(!g.getInstance()._view)return void l.LAppPal.printMessage("view notfound");const t=e.target.getBoundingClientRect(),i=e.changedTouches[0].clientX-t.left,r=e.changedTouches[0].clientY-t.top;g.getInstance()._view.onTouchesMoved(i,r)}function b(e){if(g.getInstance()._captured=!1,!g.getInstance()._view)return void l.LAppPal.printMessage("view notfound");const t=e.target.getBoundingClientRect(),i=e.changedTouches[0].clientX-t.left,r=e.changedTouches[0].clientY-t.top;g.getInstance()._view.onTouchesEnded(i,r)}function S(e){if(g.getInstance()._captured=!1,!g.getInstance()._view)return void l.LAppPal.printMessage("view notfound");const t=e.target.getBoundingClientRect(),i=e.changedTouches[0].clientX-t.left,r=e.changedTouches[0].clientY-t.top;g.getInstance()._view.onTouchesEnded(i,r)}t.LAppDelegate=g},9655:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.LAppLive2DManager=t.s_instance=void 0;const n=i(8904),o=i(6486),u=a(i(7032)),l=i(3238),h=i(6008),d=i(7720);t.s_instance=null;class c{constructor(e,t){this._finishedMotion=e=>{d.LAppPal.printMessage("Motion Finished:"),console.log(e)},this._viewMatrix=new n.CubismMatrix44,this.exShaderInfos=t,this._models=new o.csmVector,this._sceneIndex=0,this.modelNames=e,this.changeScene(this._sceneIndex)}static CreateInstance(e,i){null==t.s_instance&&(t.s_instance=new c(e,i))}static getInstance(){return null==t.s_instance&&(t.s_instance=new c(["Haru"],[])),t.s_instance}static releaseInstance(){null!=t.s_instance&&(t.s_instance=void 0),t.s_instance=null}getModel(e){return e<this._models.getSize()?this._models.at(e):null}releaseAllModel(){for(let e=0;e<this._models.getSize();e++)this._models.at(e).release(),this._models.set(e,null);this._models.clear()}onDrag(e,t){for(let i=0;i<this._models.getSize();i++){const r=this.getModel(i);r&&r.setDragging(e,t)}}onTap(e,t){for(let e=0;e<this._models.getSize();e++){const t=this.getModel(e);t&&t.startMotion("",0,100)}for(let i=0;i<this._models.getSize();i++)this._models.at(i).hitTest(u.HitAreaNameHead,e,t)?this._models.at(i).setRandomExpression():this._models.at(i).hitTest(u.HitAreaNameBody,e,t)&&this._models.at(i).startRandomMotion(u.MotionGroupTapBody,u.PriorityNormal,this._finishedMotion)}onUpdate(){const{width:e,height:t}=l.canvas,i=new n.CubismMatrix44,r=this._models.getSize();for(let s=0;s<r;++s){const r=this.getModel(s);r.getModel()&&(r.getModel().getCanvasWidth()>1&&e<t?(r.getModelMatrix().setWidth(2),i.scale(1,e/t)):i.scale(t/e,1),null!=this._viewMatrix&&i.multiplyByMatrix(this._viewMatrix)),r.update(),r.draw(i)}}nextScene(){const e=(this._sceneIndex+1)%this.modelNames.length;this.changeScene(e)}changeScene(e){this._sceneIndex=e,u.DebugLogEnable&&d.LAppPal.printMessage(`[APP]model index: ${this._sceneIndex}`);const t=this.modelNames[e],i=u.ResourcesPath+t+"/";let r=this.modelNames[e];r+=".model3.json",this.releaseAllModel(),this._models.pushBack(new h.LAppModel),this._models.at(0).loadAssets(i,r,this.exShaderInfos)}setViewMatrix(e){for(let t=0;t<16;t++)this._viewMatrix.getArray()[t]=e.getArray()[t]}}t.LAppLive2DManager=c},6008:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.LAppModel=void 0,i(7147);const n=i(5593),o=i(7938),u=i(4218),l=i(8349),h=i(8871),d=i(9460),c=i(6875),g=i(5942),m=i(9045),_=i(6486),p=i(1201),f=a(i(7032)),y=i(3238),b=i(7720);var S;!function(e){e[e.LoadAssets=0]="LoadAssets",e[e.LoadModel=1]="LoadModel",e[e.WaitLoadModel=2]="WaitLoadModel",e[e.LoadExpression=3]="LoadExpression",e[e.WaitLoadExpression=4]="WaitLoadExpression",e[e.LoadPhysics=5]="LoadPhysics",e[e.WaitLoadPhysics=6]="WaitLoadPhysics",e[e.LoadPose=7]="LoadPose",e[e.WaitLoadPose=8]="WaitLoadPose",e[e.SetupEyeBlink=9]="SetupEyeBlink",e[e.SetupBreath=10]="SetupBreath",e[e.LoadUserData=11]="LoadUserData",e[e.WaitLoadUserData=12]="WaitLoadUserData",e[e.SetupEyeBlinkIds=13]="SetupEyeBlinkIds",e[e.SetupLipSyncIds=14]="SetupLipSyncIds",e[e.SetupLayout=15]="SetupLayout",e[e.LoadMotion=16]="LoadMotion",e[e.WaitLoadMotion=17]="WaitLoadMotion",e[e.CompleteInitialize=18]="CompleteInitialize",e[e.CompleteSetupModel=19]="CompleteSetupModel",e[e.LoadTexture=20]="LoadTexture",e[e.WaitLoadTexture=21]="WaitLoadTexture",e[e.CompleteSetup=22]="CompleteSetup"}(S||(S={}));class C extends d.CubismUserModel{constructor(){super(),this._modelSetting=null,this._modelHomeDir=null,this._userTimeSeconds=0,this._eyeBlinkIds=new _.csmVector,this._lipSyncIds=new _.csmVector,this._motions=new m.csmMap,this._expressions=new m.csmMap,this._hitArea=new _.csmVector,this._userArea=new _.csmVector,this._idParamAngleX=h.CubismFramework.getIdManager().getId(n.CubismDefaultParameterId.ParamAngleX),this._idParamAngleY=h.CubismFramework.getIdManager().getId(n.CubismDefaultParameterId.ParamAngleY),this._idParamAngleZ=h.CubismFramework.getIdManager().getId(n.CubismDefaultParameterId.ParamAngleZ),this._idParamEyeBallX=h.CubismFramework.getIdManager().getId(n.CubismDefaultParameterId.ParamEyeBallX),this._idParamEyeBallY=h.CubismFramework.getIdManager().getId(n.CubismDefaultParameterId.ParamEyeBallY),this._idParamBodyAngleX=h.CubismFramework.getIdManager().getId(n.CubismDefaultParameterId.ParamBodyAngleX),this._state=S.LoadAssets,this._expressionCount=0,this._textureCount=0,this._motionCount=0,this._allMotionCount=0}loadAssets(e,t,i){this._modelHomeDir=e,fetch(`${this._modelHomeDir}/${t}`).then((e=>e.arrayBuffer())).then((e=>{const t=new o.CubismModelSettingJson(e,e.byteLength);this._state=S.LoadModel,this.setupModel(t,i)}))}setupModel(e,t){if(this._updating=!0,this._initialized=!1,this._modelSetting=e,""!=this._modelSetting.getModelFileName()){const e=this._modelSetting.getModelFileName();fetch(`${this._modelHomeDir}/${e}`).then((e=>e.arrayBuffer())).then((e=>{this.loadModel(e,t),this._state=S.LoadExpression,i()})),this._state=S.WaitLoadModel}else b.LAppPal.printMessage("Model data does not exist.");const i=()=>{if(this._modelSetting.getExpressionCount()>0){const e=this._modelSetting.getExpressionCount();for(let t=0;t<e;t++){const i=this._modelSetting.getExpressionName(t),s=this._modelSetting.getExpressionFileName(t);fetch(`${this._modelHomeDir}/${s}`).then((e=>e.arrayBuffer())).then((t=>{const s=this.loadExpression(t,t.byteLength,i);null!=this._expressions.getValue(i)&&(c.ACubismMotion.delete(this._expressions.getValue(i)),this._expressions.setValue(i,null)),this._expressions.setValue(i,s),this._expressionCount++,this._expressionCount>=e&&(this._state=S.LoadPhysics,r())}))}this._state=S.WaitLoadExpression}else this._state=S.LoadPhysics,r()},r=()=>{if(""!=this._modelSetting.getPhysicsFileName()){const e=this._modelSetting.getPhysicsFileName();fetch(`${this._modelHomeDir}/${e}`).then((e=>e.arrayBuffer())).then((e=>{this.loadPhysics(e,e.byteLength),this._state=S.LoadPose,s()})),this._state=S.WaitLoadPhysics}else this._state=S.LoadPose,s()},s=()=>{if(""!=this._modelSetting.getPoseFileName()){const e=this._modelSetting.getPoseFileName();fetch(`${this._modelHomeDir}/${e}`).then((e=>e.arrayBuffer())).then((e=>{this.loadPose(e,e.byteLength),this._state=S.SetupEyeBlink,a()})),this._state=S.WaitLoadPose}else this._state=S.SetupEyeBlink,a()},a=()=>{this._modelSetting.getEyeBlinkParameterCount()>0&&(this._eyeBlink=l.CubismEyeBlink.create(this._modelSetting),this._state=S.SetupBreath),o()},o=()=>{this._breath=u.CubismBreath.create();const e=new _.csmVector;e.pushBack(new u.BreathParameterData(this._idParamAngleX,0,15,6.5345,.5)),e.pushBack(new u.BreathParameterData(this._idParamAngleY,0,8,3.5345,.5)),e.pushBack(new u.BreathParameterData(this._idParamAngleZ,0,10,5.5345,.5)),e.pushBack(new u.BreathParameterData(this._idParamBodyAngleX,0,4,15.5345,.5)),e.pushBack(new u.BreathParameterData(h.CubismFramework.getIdManager().getId(n.CubismDefaultParameterId.ParamBreath),0,.5,3.2345,.5)),this._breath.setParameters(e),this._state=S.LoadUserData,d()},d=()=>{if(""!=this._modelSetting.getUserDataFile()){const e=this._modelSetting.getUserDataFile();fetch(`${this._modelHomeDir}/${e}`).then((e=>e.arrayBuffer())).then((e=>{this.loadUserData(e,e.byteLength),this._state=S.SetupEyeBlinkIds,g()})),this._state=S.WaitLoadUserData}else this._state=S.SetupEyeBlinkIds,g()},g=()=>{const e=this._modelSetting.getEyeBlinkParameterCount();for(let t=0;t<e;++t)this._eyeBlinkIds.pushBack(this._modelSetting.getEyeBlinkParameterId(t));this._state=S.SetupLipSyncIds,p()},p=()=>{const e=this._modelSetting.getLipSyncParameterCount();for(let t=0;t<e;++t)this._lipSyncIds.pushBack(this._modelSetting.getLipSyncParameterId(t));this._state=S.SetupLayout,f()},f=()=>{const e=new m.csmMap;this._modelSetting.getLayoutMap(e),this._modelMatrix.setupFromLayout(e),this._state=S.LoadMotion,C()},C=()=>{this._state=S.WaitLoadMotion,this._model.saveParameters(),this._allMotionCount=0,this._motionCount=0;const e=[],t=this._modelSetting.getMotionGroupCount();for(let i=0;i<t;i++)e[i]=this._modelSetting.getMotionGroupName(i),this._allMotionCount+=this._modelSetting.getMotionCount(e[i]);for(let i=0;i<t;i++)this.preLoadMotionGroup(e[i]);0==t&&(this._state=S.LoadTexture,this._motionManager.stopAllMotions(),this._updating=!1,this._initialized=!0,this.createRenderer(),this.setupTextures(),this.getRenderer().startUp(y.gl))}}setupTextures(){if(this._state==S.LoadTexture){const e=this._modelSetting.getTextureCount();for(let t=0;t<e;t++){if(""==this._modelSetting.getTextureFileName(t)){console.log("getTextureFileName null");continue}let i=this._modelSetting.getTextureFileName(t);i=this._modelHomeDir+i;const r=i=>{this.getRenderer().bindTexture(t,i.id),this._textureCount++,this._textureCount>=e&&(this._state=S.CompleteSetup)};y.LAppDelegate.getInstance().getTextureManager().createTextureFromPngFile(i,!0,r),this.getRenderer().setIsPremultipliedAlpha(!0)}this._state=S.WaitLoadTexture}}reloadRenderer(){this.deleteRenderer(),this.createRenderer(),this.setupTextures()}update(){if(this._state!=S.CompleteSetup)return;const e=b.LAppPal.getDeltaTime();this._userTimeSeconds+=e,this._dragManager.update(e),this._dragX=this._dragManager.getX(),this._dragY=this._dragManager.getY();let t=!1;if(this._model.loadParameters(),this._motionManager.isFinished()?this.startRandomMotion(f.MotionGroupIdle,f.PriorityIdle):t=this._motionManager.updateMotion(this._model,e),this._model.saveParameters(),t||null!=this._eyeBlink&&this._eyeBlink.updateParameters(this._model,e),null!=this._expressionManager&&this._expressionManager.updateMotion(this._model,e),this._model.addParameterValueById(this._idParamAngleX,30*this._dragX),this._model.addParameterValueById(this._idParamAngleY,30*this._dragY),this._model.addParameterValueById(this._idParamAngleZ,this._dragX*this._dragY*-30),this._model.addParameterValueById(this._idParamBodyAngleX,10*this._dragX),this._model.addParameterValueById(this._idParamEyeBallX,this._dragX),this._model.addParameterValueById(this._idParamEyeBallY,this._dragY),null!=this._breath&&this._breath.updateParameters(this._model,e),null!=this._physics&&this._physics.evaluate(this._model,e),this._lipsync){const e=0;for(let t=0;t<this._lipSyncIds.getSize();++t)this._model.addParameterValueById(this._lipSyncIds.at(t),e,.8)}null!=this._pose&&this._pose.updateParameters(this._model,e),this._model.update()}startMotion(e,t,i,r){if(i==f.PriorityForce)this._motionManager.setReservePriority(i);else if(!this._motionManager.reserveMotion(i))return this._debugMode&&b.LAppPal.printMessage("[APP]can't start motion."),g.InvalidMotionQueueEntryHandleValue;const s=this._modelSetting.getMotionFileName(e,t),a=`${e}_${t}`;let n=this._motions.getValue(a),o=!1;return null==n?fetch(`${this._modelHomeDir}/${s}`).then((e=>e.arrayBuffer())).then((i=>{n=this.loadMotion(i,i.byteLength,null,r);let s=this._modelSetting.getMotionFadeInTimeValue(e,t);s>=0&&n.setFadeInTime(s),s=this._modelSetting.getMotionFadeOutTimeValue(e,t),s>=0&&n.setFadeOutTime(s),n.setEffectIds(this._eyeBlinkIds,this._lipSyncIds),o=!0})):n.setFinishedMotionHandler(r),this._motionManager.startMotionPriority(n,o,i)}startRandomMotion(e,t,i){if(0==this._modelSetting.getMotionCount(e))return g.InvalidMotionQueueEntryHandleValue;const r=Math.floor(Math.random()*this._modelSetting.getMotionCount(e));return this.startMotion(e,r,t,i)}setExpression(e){const t=this._expressions.getValue(e);this._debugMode&&b.LAppPal.printMessage(`[APP]expression: [${e}]`),null!=t?this._expressionManager.startMotionPriority(t,!1,f.PriorityForce):this._debugMode&&b.LAppPal.printMessage(`[APP]expression[${e}] is null`)}setRandomExpression(){if(0==this._expressions.getSize())return;const e=Math.floor(Math.random()*this._expressions.getSize());for(let t=0;t<this._expressions.getSize();t++)if(t==e){const e=this._expressions._keyValues[t].first;return void this.setExpression(e)}}motionEventFired(e){p.CubismLogInfo("{0} is fired on LAppModel!!",e.s)}hitTest(e,t,i){if(this._opacity<1)return!1;const r=this._modelSetting.getHitAreasCount();for(let s=0;s<r;s++)if(this._modelSetting.getHitAreaName(s)==e){const e=this._modelSetting.getHitAreaId(s);return this.isHit(e,t,i)}return!1}preLoadMotionGroup(e){for(let t=0;t<this._modelSetting.getMotionCount(e);t++){const i=this._modelSetting.getMotionFileName(e,t),r=`${e}_${t}`;this._debugMode&&b.LAppPal.printMessage(`[APP]load motion: ${i} => [${r}]`),fetch(`${this._modelHomeDir}/${i}`).then((e=>e.arrayBuffer())).then((i=>{const s=this.loadMotion(i,i.byteLength,r);let a=this._modelSetting.getMotionFadeInTimeValue(e,t);a>=0&&s.setFadeInTime(a),a=this._modelSetting.getMotionFadeOutTimeValue(e,t),a>=0&&s.setFadeOutTime(a),s.setEffectIds(this._eyeBlinkIds,this._lipSyncIds),null!=this._motions.getValue(r)&&c.ACubismMotion.delete(this._motions.getValue(r)),this._motions.setValue(r,s),this._motionCount++,this._motionCount>=this._allMotionCount&&(this._state=S.LoadTexture,this._motionManager.stopAllMotions(),this._updating=!1,this._initialized=!0,this.createRenderer(),this.setupTextures(),this.getRenderer().startUp(y.gl))}))}}releaseMotions(){this._motions.clear()}releaseExpressions(){this._expressions.clear()}doDraw(){if(null==this._model)return;const e=[0,0,y.canvas.width,y.canvas.height];this.getRenderer().setRenderState(y.frameBuffer,e),this.getRenderer().drawModel()}draw(e){null!=this._model&&this._state==S.CompleteSetup&&(e.multiplyByMatrix(this._modelMatrix),this.getRenderer().setMvpMatrix(e),this.doDraw())}}t.LAppModel=C},7720:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.LAppPal=void 0;class i{static loadFileAsBytes(e,t){fetch(e).then((e=>e.arrayBuffer())).then((e=>t(e,e.byteLength)))}static getDeltaTime(){return this.s_deltaTime}static updateTime(){this.s_currentFrame=Date.now(),this.s_deltaTime=(this.s_currentFrame-this.s_lastFrame)/1e3,this.s_lastFrame=this.s_currentFrame}static printMessage(e){}}t.LAppPal=i,i.lastUpdate=Date.now(),i.s_currentFrame=0,i.s_lastFrame=0,i.s_deltaTime=0},6954:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.Rect=t.LAppSprite=void 0;const r=i(3238);t.LAppSprite=class{constructor(e,t,i,r,a){this._rect=new s,this._rect.left=e-.5*i,this._rect.right=e+.5*i,this._rect.up=t+.5*r,this._rect.down=t-.5*r,this._texture=a,this._vertexBuffer=null,this._uvBuffer=null,this._indexBuffer=null,this._positionLocation=null,this._uvLocation=null,this._textureLocation=null,this._positionArray=null,this._uvArray=null,this._indexArray=null,this._firstDraw=!0}release(){this._rect=null,r.gl.deleteTexture(this._texture),this._texture=null,r.gl.deleteBuffer(this._uvBuffer),this._uvBuffer=null,r.gl.deleteBuffer(this._vertexBuffer),this._vertexBuffer=null,r.gl.deleteBuffer(this._indexBuffer),this._indexBuffer=null}getTexture(){return this._texture}render(e){if(null!=this._texture){if(this._firstDraw){this._positionLocation=r.gl.getAttribLocation(e,"position"),r.gl.enableVertexAttribArray(this._positionLocation),this._uvLocation=r.gl.getAttribLocation(e,"uv"),r.gl.enableVertexAttribArray(this._uvLocation),this._textureLocation=r.gl.getUniformLocation(e,"texture"),r.gl.uniform1i(this._textureLocation,0),this._uvArray=new Float32Array([1,0,0,0,0,1,1,1]),this._uvBuffer=r.gl.createBuffer();{const e=r.canvas.width,t=r.canvas.height;this._positionArray=new Float32Array([(this._rect.right-.5*e)/(.5*e),(this._rect.up-.5*t)/(.5*t),(this._rect.left-.5*e)/(.5*e),(this._rect.up-.5*t)/(.5*t),(this._rect.left-.5*e)/(.5*e),(this._rect.down-.5*t)/(.5*t),(this._rect.right-.5*e)/(.5*e),(this._rect.down-.5*t)/(.5*t)]),this._vertexBuffer=r.gl.createBuffer()}this._indexArray=new Uint16Array([0,1,2,3,2,0]),this._indexBuffer=r.gl.createBuffer(),this._firstDraw=!1}r.gl.bindBuffer(r.gl.ARRAY_BUFFER,this._uvBuffer),r.gl.bufferData(r.gl.ARRAY_BUFFER,this._uvArray,r.gl.STATIC_DRAW),r.gl.vertexAttribPointer(this._uvLocation,2,r.gl.FLOAT,!1,0,0),r.gl.bindBuffer(r.gl.ARRAY_BUFFER,this._vertexBuffer),r.gl.bufferData(r.gl.ARRAY_BUFFER,this._positionArray,r.gl.STATIC_DRAW),r.gl.vertexAttribPointer(this._positionLocation,2,r.gl.FLOAT,!1,0,0),r.gl.bindBuffer(r.gl.ELEMENT_ARRAY_BUFFER,this._indexBuffer),r.gl.bufferData(r.gl.ELEMENT_ARRAY_BUFFER,this._indexArray,r.gl.DYNAMIC_DRAW),r.gl.bindTexture(r.gl.TEXTURE_2D,this._texture),r.gl.drawElements(r.gl.TRIANGLES,this._indexArray.length,r.gl.UNSIGNED_SHORT,0)}}isHit(e,t){const{height:i}=r.canvas,s=i-t;return e>=this._rect.left&&e<=this._rect.right&&s<=this._rect.up&&s>=this._rect.down}};class s{}t.Rect=s},1632:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.TextureInfo=t.LAppTextureManager=void 0;const r=i(6486),s=i(3238);t.LAppTextureManager=class{constructor(){this._textures=new r.csmVector}release(){for(let e=this._textures.begin();e.notEqual(this._textures.end());e.preIncrement())s.gl.deleteTexture(e.ptr().id);this._textures=null}createTextureFromPngFile(e,t,i){for(let r=this._textures.begin();r.notEqual(this._textures.end());r.preIncrement())if(r.ptr().fileName==e&&r.ptr().usePremultply==t)return r.ptr().img=new Image,r.ptr().img.onload=()=>i(r.ptr()),void(r.ptr().img.src=e);const r=new Image;r.onload=()=>{const n=s.gl.createTexture();s.gl.bindTexture(s.gl.TEXTURE_2D,n),s.gl.texParameteri(s.gl.TEXTURE_2D,s.gl.TEXTURE_MIN_FILTER,s.gl.LINEAR_MIPMAP_LINEAR),s.gl.texParameteri(s.gl.TEXTURE_2D,s.gl.TEXTURE_MAG_FILTER,s.gl.LINEAR),t&&s.gl.pixelStorei(s.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),s.gl.texImage2D(s.gl.TEXTURE_2D,0,s.gl.RGBA,s.gl.RGBA,s.gl.UNSIGNED_BYTE,r),s.gl.generateMipmap(s.gl.TEXTURE_2D),s.gl.bindTexture(s.gl.TEXTURE_2D,null);const o=new a;null!=o&&(o.fileName=e,o.width=r.width,o.height=r.height,o.id=n,o.img=r,o.usePremultply=t,this._textures.pushBack(o)),i(o)},r.src=e}releaseTextures(){for(let e=0;e<this._textures.getSize();e++)this._textures.set(e,null);this._textures.clear()}releaseTextureByTexture(e){for(let t=0;t<this._textures.getSize();t++)if(this._textures.at(t).id==e){this._textures.set(t,null),this._textures.remove(t);break}}releaseTextureByFilePath(e){for(let t=0;t<this._textures.getSize();t++)if(this._textures.at(t).fileName==e){this._textures.set(t,null),this._textures.remove(t);break}}};class a{constructor(){this.id=null,this.width=0,this.height=0}}t.TextureInfo=a},9705:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.LAppView=void 0;const n=i(8904),o=i(1357),u=a(i(7032)),l=i(3238),h=i(9655),d=i(7720),c=i(6954),g=i(5624);t.LAppView=class{constructor(){this._programId=null,this._back=null,this._gear=null,this._touchManager=new g.TouchManager,this._deviceToScreen=new n.CubismMatrix44,this._viewMatrix=new o.CubismViewMatrix}initialize(){const{width:e,height:t}=l.canvas,i=e/t,r=-i,s=i,a=u.ViewLogicalLeft,n=u.ViewLogicalRight;if(this._viewMatrix.setScreenRect(r,s,a,n),this._viewMatrix.scale(u.ViewScale,u.ViewScale),this._deviceToScreen.loadIdentity(),e>t){const t=Math.abs(s-r);this._deviceToScreen.scaleRelative(t/e,-t/e)}else{const e=Math.abs(n-a);this._deviceToScreen.scaleRelative(e/t,-e/t)}this._deviceToScreen.translateRelative(.5*-e,.5*-t),this._viewMatrix.setMaxScale(u.ViewMaxScale),this._viewMatrix.setMinScale(u.ViewMinScale),this._viewMatrix.setMaxScreenRect(u.ViewLogicalMaxLeft,u.ViewLogicalMaxRight,u.ViewLogicalMaxBottom,u.ViewLogicalMaxTop)}release(){this._viewMatrix=null,this._touchManager=null,this._deviceToScreen=null,this._gear.release(),this._gear=null,this._back.release(),this._back=null,l.gl.deleteProgram(this._programId),this._programId=null}render(){l.gl.useProgram(this._programId),l.gl.flush();const e=h.LAppLive2DManager.getInstance();e.setViewMatrix(this._viewMatrix),e.onUpdate()}initializeSprite(){const e=l.canvas.width,t=l.canvas.height,i=l.LAppDelegate.getInstance().getTextureManager(),r=u.ResourcesPath;let s="";s=u.BackImageName,i.createTextureFromPngFile(r+s,!1,(i=>{const r=.5*e,s=.5*t,a=2*i.width,n=.95*t;this._back=new c.LAppSprite(r,s,a,n,i.id)})),s=u.GearImageName,i.createTextureFromPngFile(r+s,!1,(i=>{const r=e-.5*i.width,s=t-.5*i.height,a=i.width,n=i.height;this._gear=new c.LAppSprite(r,s,a,n,i.id)})),null==this._programId&&(this._programId=l.LAppDelegate.getInstance().createShader())}onTouchesBegan(e,t){this._touchManager.touchesBegan(e,t)}onTouchesMoved(e,t){const i=this.transformViewX(this._touchManager.getX()),r=this.transformViewY(this._touchManager.getY());this._touchManager.touchesMoved(e,t),h.LAppLive2DManager.getInstance().onDrag(i,r)}onTouchesEnded(e,t){const i=h.LAppLive2DManager.getInstance();i.onDrag(0,0);{const r=this._deviceToScreen.transformX(this._touchManager.getX()),s=this._deviceToScreen.transformY(this._touchManager.getY());u.DebugTouchLogEnable&&d.LAppPal.printMessage(`[APP]touchesEnded x: ${r} y: ${s}`),i.onTap(r,s),this._gear.isHit(e,t)&&i.nextScene()}}transformViewX(e){const t=this._deviceToScreen.transformX(e);return this._viewMatrix.invertTransformX(t)}transformViewY(e){const t=this._deviceToScreen.transformY(e);return this._viewMatrix.invertTransformY(t)}transformScreenX(e){return this._deviceToScreen.transformX(e)}transformScreenY(e){return this._deviceToScreen.transformY(e)}}},3798:function(e,t,i){var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const n=i(3238),o=a(i(7032)),u=i(1349);window.onload=()=>{n.LAppDelegate.CreateInstance();var e=new u.ExShaderLoadInfo(document.getElementById("fs_block").text),t=new u.ExShaderLoadInfo(document.getElementById("fs_rainbow").text);if(0!=n.LAppDelegate.getInstance().initialize([e,t])){var i=document.getElementById("modelName").text,r=new u.ExShaderInfo("ArtMesh80",0),s=new u.ExShaderInfo("ArtMesh81",0),a=new u.ExShaderInfo("ArtMesh79",1),o=new u.ExShaderInfo("ArtMesh85",1);r.exUniform.resolution_x=1024,s.exUniform.resolution_x=1024,r.exUniform.resolution_y=1024,s.exUniform.resolution_y=1024,a.exUniform.resolution_y=1024,a.exUniform.resolution_y=1024,o.exUniform.resolution_y=1024,o.exUniform.resolution_y=1024,n.LAppDelegate.getInstance().LoadModel([i],[r,s]),function e(){r.exUniform.time+=.001,s.exUniform.time+=.001,a.exUniform.time+=.1,o.exUniform.time+=.1,n.LAppDelegate.getInstance().run(),requestAnimationFrame(e)}()}},window.onbeforeunload=()=>n.LAppDelegate.releaseInstance(),window.onresize=()=>{"auto"===o.CanvasSize&&n.LAppDelegate.getInstance().onResize()}},5624:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.TouchManager=void 0,t.TouchManager=class{constructor(){this._startX=0,this._startY=0,this._lastX=0,this._lastY=0,this._lastX1=0,this._lastY1=0,this._lastX2=0,this._lastY2=0,this._lastTouchDistance=0,this._deltaX=0,this._deltaY=0,this._scale=1,this._touchSingle=!1,this._flipAvailable=!1}getCenterX(){return this._lastX}getCenterY(){return this._lastY}getDeltaX(){return this._deltaX}getDeltaY(){return this._deltaY}getStartX(){return this._startX}getStartY(){return this._startY}getScale(){return this._scale}getX(){return this._lastX}getY(){return this._lastY}getX1(){return this._lastX1}getY1(){return this._lastY1}getX2(){return this._lastX2}getY2(){return this._lastY2}isSingleTouch(){return this._touchSingle}isFlickAvailable(){return this._flipAvailable}disableFlick(){this._flipAvailable=!1}touchesBegan(e,t){this._lastX=e,this._lastY=t,this._startX=e,this._startY=t,this._lastTouchDistance=-1,this._flipAvailable=!0,this._touchSingle=!0}touchesMoved(e,t){this._lastX=e,this._lastY=t,this._lastTouchDistance=-1,this._touchSingle=!0}getFlickDistance(){return this.calculateDistance(this._startX,this._startY,this._lastX,this._lastY)}calculateDistance(e,t,i,r){return Math.sqrt((e-i)*(e-i)+(t-r)*(t-r))}calculateMovingAmount(e,t){if(e>0!=t>0)return 0;const i=e>0?1:-1,r=Math.abs(e),s=Math.abs(t);return i*(r<s?r:s)}}},7147:function(e,t,i){i.r(t),i.d(t,{Headers:function(){return m},Request:function(){return C},Response:function(){return P},DOMException:function(){return x},fetch:function(){return B}});var r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==r&&r,s="URLSearchParams"in r,a="Symbol"in r&&"iterator"in Symbol,n="FileReader"in r&&"Blob"in r&&function(){try{return new Blob,!0}catch(e){return!1}}(),o="FormData"in r,u="ArrayBuffer"in r;if(u)var l=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],h=ArrayBuffer.isView||function(e){return e&&l.indexOf(Object.prototype.toString.call(e))>-1};function d(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function c(e){return"string"!=typeof e&&(e=String(e)),e}function g(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return a&&(t[Symbol.iterator]=function(){return t}),t}function m(e){this.map={},e instanceof m?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function _(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function p(e){return new Promise((function(t,i){e.onload=function(){t(e.result)},e.onerror=function(){i(e.error)}}))}function f(e){var t=new FileReader,i=p(t);return t.readAsArrayBuffer(e),i}function y(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function b(){return this.bodyUsed=!1,this._initBody=function(e){var t;this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:n&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:o&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:s&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():u&&n&&(t=e)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=y(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):u&&(ArrayBuffer.prototype.isPrototypeOf(e)||h(e))?this._bodyArrayBuffer=y(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):s&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},n&&(this.blob=function(){var e=_(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?_(this)||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer)):this.blob().then(f)}),this.text=function(){var e,t,i,r=_(this);if(r)return r;if(this._bodyBlob)return e=this._bodyBlob,i=p(t=new FileReader),t.readAsText(e),i;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),i=new Array(t.length),r=0;r<t.length;r++)i[r]=String.fromCharCode(t[r]);return i.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o&&(this.formData=function(){return this.text().then(v)}),this.json=function(){return this.text().then(JSON.parse)},this}m.prototype.append=function(e,t){e=d(e),t=c(t);var i=this.map[e];this.map[e]=i?i+", "+t:t},m.prototype.delete=function(e){delete this.map[d(e)]},m.prototype.get=function(e){return e=d(e),this.has(e)?this.map[e]:null},m.prototype.has=function(e){return this.map.hasOwnProperty(d(e))},m.prototype.set=function(e,t){this.map[d(e)]=c(t)},m.prototype.forEach=function(e,t){for(var i in this.map)this.map.hasOwnProperty(i)&&e.call(t,this.map[i],i,this)},m.prototype.keys=function(){var e=[];return this.forEach((function(t,i){e.push(i)})),g(e)},m.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),g(e)},m.prototype.entries=function(){var e=[];return this.forEach((function(t,i){e.push([i,t])})),g(e)},a&&(m.prototype[Symbol.iterator]=m.prototype.entries);var S=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function C(e,t){if(!(this instanceof C))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var i,r,s=(t=t||{}).body;if(e instanceof C){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new m(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,s||null==e._bodyInit||(s=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new m(t.headers)),this.method=(r=(i=t.method||this.method||"GET").toUpperCase(),S.indexOf(r)>-1?r:i),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&s)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(s),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==t.cache&&"no-cache"!==t.cache)){var a=/([?&])_=[^&]*/;a.test(this.url)?this.url=this.url.replace(a,"$1_="+(new Date).getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}function v(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var i=e.split("="),r=i.shift().replace(/\+/g," "),s=i.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(s))}})),t}function P(e,t){if(!(this instanceof P))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText=void 0===t.statusText?"":""+t.statusText,this.headers=new m(t.headers),this.url=t.url||"",this._initBody(e)}C.prototype.clone=function(){return new C(this,{body:this._bodyInit})},b.call(C.prototype),b.call(P.prototype),P.prototype.clone=function(){return new P(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new m(this.headers),url:this.url})},P.error=function(){var e=new P(null,{status:0,statusText:""});return e.type="error",e};var M=[301,302,303,307,308];P.redirect=function(e,t){if(-1===M.indexOf(t))throw new RangeError("Invalid status code");return new P(null,{status:t,headers:{location:e}})};var x=r.DOMException;try{new x}catch(e){(x=function(e,t){this.message=e,this.name=t;var i=Error(e);this.stack=i.stack}).prototype=Object.create(Error.prototype),x.prototype.constructor=x}function B(e,t){return new Promise((function(i,s){var a=new C(e,t);if(a.signal&&a.signal.aborted)return s(new x("Aborted","AbortError"));var o=new XMLHttpRequest;function l(){o.abort()}o.onload=function(){var e,t,r={status:o.status,statusText:o.statusText,headers:(e=o.getAllResponseHeaders()||"",t=new m,e.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e})).forEach((function(e){var i=e.split(":"),r=i.shift().trim();if(r){var s=i.join(":").trim();t.append(r,s)}})),t)};r.url="responseURL"in o?o.responseURL:r.headers.get("X-Request-URL");var s="response"in o?o.response:o.responseText;setTimeout((function(){i(new P(s,r))}),0)},o.onerror=function(){setTimeout((function(){s(new TypeError("Network request failed"))}),0)},o.ontimeout=function(){setTimeout((function(){s(new TypeError("Network request failed"))}),0)},o.onabort=function(){setTimeout((function(){s(new x("Aborted","AbortError"))}),0)},o.open(a.method,function(e){try{return""===e&&r.location.href?r.location.href:e}catch(t){return e}}(a.url),!0),"include"===a.credentials?o.withCredentials=!0:"omit"===a.credentials&&(o.withCredentials=!1),"responseType"in o&&(n?o.responseType="blob":u&&a.headers.get("Content-Type")&&-1!==a.headers.get("Content-Type").indexOf("application/octet-stream")&&(o.responseType="arraybuffer")),!t||"object"!=typeof t.headers||t.headers instanceof m?a.headers.forEach((function(e,t){o.setRequestHeader(t,e)})):Object.getOwnPropertyNames(t.headers).forEach((function(e){o.setRequestHeader(e,c(t.headers[e]))})),a.signal&&(a.signal.addEventListener("abort",l),o.onreadystatechange=function(){4===o.readyState&&a.signal.removeEventListener("abort",l)}),o.send(void 0===a._bodyInit?null:a._bodyInit)}))}B.polyfill=!0,r.fetch||(r.fetch=B,r.Headers=m,r.Request=C,r.Response=P)}},t={};function i(r){if(t[r])return t[r].exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,i),s.exports}i.d=function(e,t){for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i(3798)}();